<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>TLS Prober: What is tls-testing.opera.com and what does it do?</title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="/static/css/main.min.css" type="text/css" media="all">
        <!--[if lte IE 8]>
            <link rel="stylesheet" href="/static/css/ie-fixes.css" type="text/css" media="all">
            <script src="/static/js/html5shiv.js"></script>
        <![endif]-->

        <meta http-equiv="last-modified" content="Wed, 27 Jul 2011 23:13:21 GMT">
        <link rel="alternate" type="application/atom+xml" title="All Posts (Atom)" href="/feeds/all.atom">
        <link rel="alternate" type="application/rss+xml" title="All Posts (RSS)" href="/feeds/all.rss">
        <link rel="icon" type="image/jpeg" sizes="287x287" href="/static/img/favicon-287x287.jpg">
        <link rel="icon" type="image/jpeg" sizes="128x128" href="/static/img/favicon-128x128.jpg">
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-2097834-1', 'auto');
            ga('send', 'pageview');
        </script>
    </head>
    <body class="blog post_detail" itemscope itemtype="http://schema.org/BlogPosting">
        <nav id="site-nav">
            <header id="about">
                <h1><a href="/about/">Chris Adams</a></h1>
                <h2>Programmer, cyclist, photographer</h2>
            </header>
            <ul class="links">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li>
                    <a href="/feeds/all.atom" title="Site Feed">Site Feed</a>
                </li>
            </ul>
            <ul class="social-networks">
                <li>
                    <a href="https://github.com/acdha" rel="me">Github</a>
                </li>
                <li>
                    <a href="https://bitbucket.org/acdha" rel="me">Bitbucket</a>
                </li>
                <li>
                    <a href="https://pinboard.in/u:acdha/" rel="me">Pinboard</a>
                </li>
                <li>
                    <a href="https://twitter.com/acdha" rel="me">Twitter</a>
                </li>
                <li>
                    <a href="https://www.flickr.com/photos/acdha" rel="me">Flickr</a>
                </li>
                <li>
                    <a href="https://www.linkedin.com/in/acdha" rel="me">LinkedIn</a>
                </li>
            </ul>
            <div id="site-search"></div>
        </nav>
        <section id="main">
            <article class="post">
                <header>
                    <meta itemprop="dateCreated" content="2011-07-27T19:13:21-04:00">
                    <meta itemprop="dateModified" content="2011-07-27T19:13:21-04:00">
                    <time class="date" itemprop="datePublished" datetime="2011-07-27T23:13:21+00:00">Jul 27</time>
                    <h2 class="" itemprop="title">TLS Prober: What is tls-testing.opera.com and what does it do?</h2>
                </header>

                <div class="body" itemprop="articleBody"><div class="googlereader description" data-google-id="tag:google.com,2005:reader/item/e9cbde4f326b15d2">
                        <blockquote>
                            We have written several articles<sup><a href="http://my.opera.com/securitygroup/blog/2010/11/04/a-few-results-from-the-tls-prober">1</a>,<a href="http://my.opera.com/securitygroup/blog/2011/03/17/secure-browsing-like-its-1995">2</a>,<a href="http://my.opera.com/securitygroup/blog/2011/05/19/renego-popular-unpatched-and-vulnerable-sites">3</a>,<a href="http://my.opera.com/securitygroup/blog/2011/07/27/tls-prober-what-is-tls-testing-opera-com-and-what-does-it-do">4</a></sup> about the results provided by the TLS Prober, and occasionally provided information about specific tests it performs. In this article we will provide more details about what tests are performed.<br>
                            <br>
                            For new readers, the TLS Prober was created to <a href="http://my.opera.com/securitygroup/blog/2010/04/06/how-secure-is-the-secure-web-ssl-tls-server-stats-part-1">monitor</a> the patching of the <a href="http://my.opera.com/securitygroup/blog/2010/01/23/alpha-testing-tls-renego-fix">TLS Renego Security Vulnerability</a>, <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3555">CVE-2009-3555</a>, possibly the most severe vulnerability to affect the SSL/TLS protocol. It allows a Man In the Middle attacker to, for example, inject HTTP requests into the beginning of a user's connection with a vulnerable server and have them performed with the user's credentials (A Proof of Concept <a href="http://it.slashdot.org/story/09/11/16/2327230/SSL-Renegotiation-Attack-Becomes-Real">demonstration</a> in November 2009 posted the victim's Twitter username and password to their Twitter stream).<br>
                            <br>
                            To fix this problem, all SSL/TLS clients and servers must be updated to support a new TLS Extension, the Renegotiation Information Extension, documented in <a href="http://www.ietf.org/rfc/rfc5746.txt">RFC 5746</a>. However, before clients can start to become strict about this extension, and thus protect our mutual users against this attack, as many servers as possible need to be patched.<br>
                            <br>
                            The TLS Prober is one of the projects that is used to monitor this situation. Another project is <a href="http://blog.ivanristic.com/">Ivan Ristic</a>'s <a href="https://www.ssllabs.com/ssldb/index.html">SSLLabs project</a>, and it is possible that <a href="http://news.netcraft.com/ssl-survey/">Netcraft</a> has added such testing to their survey.<br>
                            <br>
                            In addition to monitoring the "Renego" issue, the Prober also tests servers for a number of other capabilities and problems, which can aid the SSL/TLS client vendors in deciding which functionality to support, or which problems to be aware of when maintaining their implementations.<br>
                            <br>
                            The TLS Prober consists of a group of computers that connect to the Internet via the hostname "tls-testing.opera.opera.com" (213.236.208.19, formerly known as "probes.opera.com").<br>
                            <br>
                            When running a test these computers run many scripts in parallel, each testing a different secure server, then registering the results in a database.<br>
                            <br>
                            As mentioned <a href="http://my.opera.com/securitygroup/blog/2010/11/04/a-few-results-from-the-tls-prober">previously</a>, the TLS Prober is based on <a href="http://trevp.net/tlslite/">TLSLite</a>, a Python-based TLS implementation, which has been updated with extra TLS functionality and instrumented to test a number of variants that we have observed in clients and servers.<br>
                            <br>
                            The weekly run of the TLS Prober is normally performed Monday and Tuesday each week, although the TLS Prober might be configured to run special tests at other times as well.<br>
                            <br>
                            When probing a server (a single IP address and port is only tested once, even if it has several names), the following tests are performed:<br>
                            <br>
                            <strong>Capability checks</strong>:<br>
                            <br>
                            <ul>
                                <li>SSL v2
                                </li>
                                <li>SSL v3
                                </li>
                                <li>TLS 1.0
                                </li>
                                <li>TLS 1.1
                                </li>
                                <li>TLS 1.2
                                </li>
                                <li>General support for TLS Extensions (such as Server Name Indication,<br>
                                    Certificate Status)
                                </li>
                                <li>Support for the TLS Renegotiation Indication Extension
                                </li>
                                <li>Support for the TLS Session Ticket Extensions
                                </li>
                                <li>TLS Session Resumption? (Not having this enabled can cause <a href="http://my.opera.com/securitygroup/blog/2011/06/09/title-renego-popular-unpatched-and-vulnerable-an-update">performance issues</a> for the server)
                                </li>
                                <li>Trigger TLS connection renegotiation? (Might indicate a <a href="http://my.opera.com/securitygroup/blog/2011/05/19/renego-popular-unpatched-and-vulnerable-sites">security vulnerability</a>)
                                </li>
                                <li>Accept TLS connection renegotiation triggered by the client? (Might indicate a <a href="http://my.opera.com/securitygroup/blog/2011/05/19/renego-popular-unpatched-and-vulnerable-sites">security vulnerability</a>)
                                </li>
                                <li>Support of various encryption methods, some of which are <a href="http://my.opera.com/securitygroup/blog/2011/03/17/secure-browsing-like-its-1995">weak</a>, and<br>
                                    therefore could be a security problem.
                                </li>
                            </ul><br>
                            <br>
                            <strong>Checks for correct handling</strong><br>
                            <br>
                            <ul>
                                <li>Tolerates TLS 1.3? (This is a, currently, non-existent version of TLS, version code 3.4, but next on the list. Not accepting this is a<a href="http://my.opera.com/yngve/blog/2010/06/02/renego-patched-servers-a-long-term-interoperability-time-bomb-brewing">standards violation</a>)
                                </li>
                                <li>Tolerates TLS NG.1? (non-existent version, with version code 4.1, not accepting this is a <a href="http://my.opera.com/yngve/blog/2010/06/02/renego-patched-servers-a-long-term-interoperability-time-bomb-brewing">standards violation</a>)
                                </li>
                                <li>Uses correct version field in the Client Hello message (some servers<br>
                                    use the wrong field)
                                </li>
                                <li>Does not require one version field in the Client Hello to contain<br>
                                    specific values before accepting the other.
                                </li>
                                <li>Does the server handle the version field in the RSA Client Key exchange correctly?
                                </li>
                                <li>Does the server accept that the client sends extra long padding<br>
                                    in the block cipher modes? The encrypted record must be a multiple of 8 or 16 (depending on encryption method), so it must be padded with anything from 0 to 255 bytes, as long as the total length is a multiple of the block length (8 or 16 bytes).
                                </li>
                                <li>Correct handling of bad data in the Renego extension?
                                </li>
                            </ul><br>
                            <br>
                            A number of these are tested in various combinations, some enabled, others not.<br>
                            <br>
                            In most cases, once the TLS connection has been successfully established, the Prober will shut it down; only in a few tests will it send a limited request to the server. Some tests use functionality that is not supported by TLSLite, such as the large number of encryption methods it tests for, and in such cases the Prober will shut down the connection as soon as it has all the necessary information, since it cannot complete the full handshake.<br>
                            <br>
                            The number of tests can range from about 60 to upwards of a couple of hundred, performed one at a time, depending on the capabilities of the server, and how many problems are encountered. If a connection fails, the Prober will retry a couple of times to make sure it was a test failure,<br>
                            and not something unrelated that caused the connection to be closed. The whole process can take a few minutes depending on network speed and response times.<br>
                            <br>
                            Additionally the Prober collects data about:<br>
                            <br>
                            <ul>
                                <li>Name and version of server software, if provided. For a HTTPS site<br>
                                    this is done by sending a HTTP HEAD request for <a href="https://www.example.com/">https://www.example.com/</a>, an action that limits the load on the server, and avoids sending unnecessary data to the Prober since the response is only the HTTP headers, not content. For mail servers the first "hello" line from the server is registered, although it is not a reliable indication of vendor and version.
                                </li>
                                <li>Certificates presented by the server
                                </li>
                                <li>OCSP Certificate status from extension
                                </li>
                                <li>Length of temporary Diffie-Hellman key (DHE-key)
                                </li>
                            </ul><br>
                            <br>
                            At present the TLS Prober supports the following application protocols:<br>
                            <br>
                            <ul>
                                <li>HTTPS
                                </li>
                                <li>IMAP
                                </li>
                                <li>POP
                                </li>
                                <li>SMTP
                                </li>
                            </ul><br>
                            <br>
                            In addition to the Prober, the system also has a scanning functionality that can check various domains (either by name or IP address range) for servers on specific hostnames and ports. This scanner will only do a quick test to see if there is something that looks like a SSL/TLS server on the tested port, and if so, registers it for a full test with the Prober once the scanner has completed its run.<br>
                            <br>
                            A few system administrators have asked about what tls-testing.opera.com/probes.opera.com does, and we hope the above description satisfies those who wonder about what goes on, and that they have been assured that the Prober is only testing legitimate, or almost legitimate, variations of the TLS protocol, and is not trying to break into, or damage, their servers.<br>
                            <br>
                            If your server is among those being tested, thank you for your participation (and another thank you if you have patched the Renego issue).
                        </blockquote>
                    </div>
                    <p class="bookmark-source">
                        Source: <a href="http://my.opera.com/securitygroup/blog/show.dml/33045192">http://my.opera.com/securitygroup/blog/show.dml/33045192</a>
                    </p>
                </div>
            </article>

            <nav id="post-nav">


            </nav>

            <script id="discus-javascript">
                var disqus_shortname = 'improbable';

                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
                    document.getElementsByTagName('body')[0].appendChild(dsq);
                })();
            </script>

            <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            <div id="disqus_thread"></div>
        </section>

        <footer id="site-footer" class="nocontent">
            <p>
                This site is purely my personal work and does not reflect the views of my employer.
            </p>
            <p class="license">
                <a class="icon" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a>
                This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
            </p>
        </footer>

        <script async src="/static/js/common.js"></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js" integrity="sha256-hj+5FRlAuvAFANiefn0PpJYCkV1X4QT9EgiPd+6QnCw=" crossorigin="anonymous"></script>
    </body>
</html>
