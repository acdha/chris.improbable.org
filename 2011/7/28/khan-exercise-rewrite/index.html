<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Khan Exercise Rewrite</title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="/static/css/main.min.css" type="text/css" media="all">
        <!--[if lte IE 8]>
            <link
                rel="stylesheet"
                href="/static/css/ie-fixes.css"
                type="text/css"
                media="all"
            />
            <script src="/static/js/html5shiv.js"></script>
        <![endif]-->

        <meta http-equiv="last-modified" content="Thu, 28 Jul 2011 19:33:22 GMT">
        <link rel="alternate" type="application/atom+xml" title="All Posts (Atom)" href="/feeds/all.atom">
        <link rel="alternate" type="application/rss+xml" title="All Posts (RSS)" href="/feeds/all.rss">
        <link rel="icon" type="image/jpeg" sizes="287x287" href="/static/img/favicon-287x287.jpg">
        <link rel="icon" type="image/jpeg" sizes="128x128" href="/static/img/favicon-128x128.jpg">
    </head>
    <body class="blog post_detail" itemscope itemtype="http://schema.org/BlogPosting">
        <nav id="site-nav">
            <header id="about">
                <h1><a href="/about/">Chris Adams</a></h1>
                <h2>Programmer, cyclist, photographer</h2>
            </header>
            <ul class="links">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li>
                    <a href="/feeds/all.atom" title="Site Feed">Site Feed</a>
                </li>
            </ul>
            <ul class="social-networks">
                <li>
                    <a rel="me" href="https://code4lib.social/@acdha">Mastodon</a>
                </li>
                <li>
                    <a href="https://github.com/acdha" rel="me">Github</a>
                </li>
                <li>
                    <a href="https://bitbucket.org/acdha" rel="me">Bitbucket</a>
                </li>
                <li>
                    <a href="https://pinboard.in/u:acdha/" rel="me">Pinboard</a>
                </li>
                <li>
                    <a href="https://www.flickr.com/photos/acdha" rel="me">Flickr</a>
                </li>
                <li>
                    <a href="https://www.linkedin.com/in/acdha" rel="me">LinkedIn</a>
                </li>
            </ul>
            <div id="site-search"></div>
        </nav>
        <section id="main">
            <article class="post">
                <header>
                    <meta itemprop="dateCreated" content="2011-07-28T15:33:22-04:00">
                    <meta itemprop="dateModified" content="2011-07-28T15:33:22-04:00">
                    <time class="date" itemprop="datePublished" datetime="2011-07-28T19:33:22+00:00">Jul 28</time>
                    <h2 class="" itemprop="title">Khan Exercise Rewrite</h2>
                </header>

                <div class="body" itemprop="articleBody"><div class="googlereader description" data-google-id="tag:google.com,2005:reader/item/7402fda1a5dabd15">
                        <blockquote>
                            <p>
                                <a href="http://www.flickr.com/photos/jeresig/5984905975/" title="Khan Exercise Framework Deployed by John Resig, on Flickr"><img src="http://farm7.static.flickr.com/6144/5984905975_1f9b68ff98_m.jpg" width="240" height="150" alt="Khan Exercise Framework Deployed" style="float:right;margin:0 0 10px 10px"></a>
                            </p>
                            <p>
                                Today we’re pushing live a complete rewrite of the <a href="https://github.com/Khan/khan-exercises">Khan Academy Exercise framework</a> (<a href="http://khanacademy.org/exercisedashboard">live demo</a>).
                            </p>
                            <p>
                                A big push at <a href="http://khanacademy.org/">Khan Academy</a> has been to write more-and-more exercises for students to practice with. Naturally, to increase the number of exercises that we have, we needed to make it easier for team members, and casual committers, to write them.
                            </p>
                            <p>
                                When I was first looking in to Khan Academy I did a bunch of digging through their code base (<a href="https://khanacademy.kilnhg.com/Repo/Website/Group/stable/Files">which is Open Source</a>) and noticed that a lot of effort was going in to writing exercises. Interestingly all the exercises were being written in pure JavaScript and were dependent upon the server component in order to run properly. To me this seemed like a massive barrier to entry.
                            </p>
                            <h2>
                                Brand New Framework
                            </h2>
                            <p>
                                When I started just over two months ago I immediately went about rewriting the framework to use semantic HTML and not rely upon any server-side components whatsoever. To provide an example of the change that was made here is one particular exercise, Significant Figures 1, <a href="https://khanacademy.kilnhg.com/Repo/Website/Group/stable/File/javascript/exercises/significant_figures_1.js?rev=tip">written for the old framework</a> and <a href="https://github.com/Khan/khan-exercises/blob/master/exercises/significant_figures_1.html">written for the new framework</a>. You can view <a href="http://khanacademy.org/exercises?exid=significant_figures_1">the live version</a> of the exercise, as well.
                            </p>
                            <center>
                                <a href="http://www.flickr.com/photos/jeresig/5985482092/" title="Khan Exercise Code Comparison by John Resig, on Flickr"><img src="http://farm7.static.flickr.com/6012/5985482092_58971521ca.jpg" width="206" height="500" alt="Khan Exercise Code Comparison"></a><br>
                                Significant Figures 1 went from 191 lines of code down to 58.
                            </center>
                            <p>
                                Note the dramatic lack of “code” – most logic is encapsulated and reduced to a series of variable declarations (some with minimal logic). Additionally utility functions were made significantly more useful, and generic, shared across exercises (some of this was done in the old framework but a complete rewrite allowed us to find areas of obvious overlap).
                            </p>
                            <p>
                                The result of the new framework is an interesting mix of semantic markup and logic – wrapped in a form of highly specialized templating. Tons of details regarding the specifics of the framework can be found in the <a href="https://github.com/Khan/khan-exercises/wiki/Writing-Exercises:-Home">Writing Exercises tutorial</a>.
                            </p>
                            <p>
                                In short, some of the cool new features of this framework include:
                            </p>
                            <ul>
                                <li>A full module system for dynamically loading specific utilities (such as graphing).
                                </li>
                                <li>A <a href="https://github.com/Khan/khan-exercises/blob/master/utils/tmpl.js">brand new templating framework</a>, including templating inheritance, that makes it easy to reduce repeated code in exercises (<a href="https://github.com/Khan/khan-exercises/wiki/Writing-Exercises:-Formatting">some examples</a>).
                                </li>
                                <li>A <a href="https://github.com/Khan/khan-exercises/blob/master/utils/graphie.js">brand new graphing framework</a> (written by Ben Alpert, named ‘Graphie’) that’s built on top of Raphael. This framework provides a simple API for creating all sorts of graphs and charts, it’s used extensively throughout the exercises.
                                </li>
                                <li>An extensible plugin system for creating new <a href="https://github.com/Khan/khan-exercises/wiki/Writing-Exercises:-Answer-Types">answer types</a> (to expand beyond basic multiple choice or fill in the blank).
                                </li>
                            </ul>
                            <p>
                                Of course, that’s saying nothing of the actual user interaction as well. Most of the new framework’s logic is contained on the client-side and is generated directly off of <a href="https://github.com/Khan/khan-api">Khan Academy’s REST API</a>.
                            </p>
                            <p>
                                By moving logic to the client-side we’re able to have a much more interactive experience (doing all problem generation on the client-side, doing Ajax-y background submissions, things of that sort).
                            </p>
                            <h2>
                                Testing
                            </h2>
                            <p>
                                A big concern for us, with this rewrite, was to ensure that the quality and integrity of exercises was maintained well into the future. We wanted to make sure that the content of the exercises were correct and that regressions do not occur over time.
                            </p>
                            <p>
                                In fact we have three levels of testing:
                            </p>
                            <ol>
                                <li>We have <a href="https://github.com/Khan/khan-exercises/tree/master/utils/test">unit tests for our modules and utility functions</a> (ensures that stuff like the templating will continue to work correctly).
                                </li>
                                <li>We have an interactive interface for generating <a href="https://github.com/Khan/khan-exercises/tree/master/test/exercises">unit tests</a> for any given exercise (details below).
                                </li>
                                <li>We have a “Report a Problem” interface for sending post-deployment issues directly to our bug tracker.
                                </li>
                            </ol>
                            <p>
                                The second stage is particularly interesting. On a fundamental level it’s hard to unit test something as complex as an exercise. While we can ensure that they still work at a functional level we can’t verify if the problems make sense, or if graphs look correct, or if it’s even possible to pick the right answer.
                            </p>
                            <p>
                                For these reasons we’ve introduced a new testing interface in which we use human developers as unit testers. When in test mode an additional panel is displayed asking the user to provide additional details regarding wether the problem is working correctly, or not. <a href="https://github.com/Khan/khan-exercises/wiki/Testing-Exercises">We ask them</a> to really dig into the exercises and make sure that they’re working correctly, hints are being displayed properly, and other things of that nature.
                            </p>
                            <center>
                                <a href="http://www.flickr.com/photos/jeresig/5985481938/" title="Khan Exercise Testing by John Resig, on Flickr"><img src="http://farm7.static.flickr.com/6003/5985481938_ab834e3c42.jpg" width="500" height="351" alt="Khan Exercise Testing"></a>
                            </center>
                            <p>
                                All of this information is collected and distilled into a piece of JavaScript code that is dropped into our <a href="https://github.com/Khan/khan-exercises/tree/master/test/exercises">test suite</a>, all pushed into QUnit. At the moment we have around 2414 unit test collections with over 10,000 assertions.
                            </p>
                            <center>
                                <a href="http://www.flickr.com/photos/jeresig/5984923703/" title="Khan Exercise Test Dump by John Resig, on Flickr"><img src="http://farm7.static.flickr.com/6017/5984923703_2496715189_m.jpg" width="240" height="215" alt="Khan Exercise Test Dump"></a>
                            </center>
                            <p>
                                At the moment we’re working on ways of having better reporting and integration with our development process, for all those unit tests.
                            </p>
                            <h2>
                                Development Process
                            </h2>
                            <p>
                                I’m rather pleased with how the overall development process worked out. We actively kept both the code open (it’s up on Github and it’s MIT licensed) and the process open as well. We’ve had contributions from over twice as many outside contributors than members of the Khan Academy team (although the vast majority of the development was done by members of the team).
                            </p>
                            <p>
                                We have a <a href="https://github.com/Khan/khan-exercises/wiki/Getting-Involved">detailed Getting Involved guide</a> that explains how exactly anyone can participate in the development of the framework (or in the authoring of new exercises).
                            </p>
                            <p>
                                Predominantly we’ve been coordinating through <a href="http://www.hipchat.com/g2m3UVDtY">a public HipChat room</a>, using the <a href="https://github.com/Khan/khan-exercises/issues">Github Issue Tracker</a>, and managing all the exercise work through a series of Google Spreadsheets.
                            </p>
                            <p>
                                We’re going to be transitioning now into creating a ton more exercises and we’d love to have even more help from the community. There is a ton of information on <a href="https://github.com/Khan/khan-exercises/wiki/Getting-Involved">how to get involved</a> in the <a href="https://github.com/Khan/khan-exercises/wiki">wiki</a>.
                            </p>
                            <h2>
                                Next Steps and Thanks
                            </h2>
                            <p>
                                There are a few things that we’re looking to do in the near future: Bring offline support to the exercises (for those with spotty internet connections or those using the upcoming iPad/Android application), client-side translation of content into other languages, and exercise answer checking using Node.js and JSDOM.
                            </p>
                            <p>
                                I also want to take this opportunity to thank everyone at Khan Academy, and all the community contributors, for helping to make this project happen. I especially want to thank Marcia Lee, Ben Alpert, Jeff Ruberg, Igor Terzic, Omar Rizwan, and Ben Kamens for their help in getting this out the door.
                            </p>
                            <p>
                                I should also mention that <a href="http://hire.jobvite.com/CompanyJobs/Careers.aspx?k=JobListing&amp;c=qd69Vfw7">Khan Academy is hiring devs</a>. We’re looking for both server/client devs (Python/JavaScript) and also mobile devs (iOS and Android).
                            </p><img src="http://feeds.feedburner.com/~r/JohnResig/~4/ogLAcLijUBw" height="1" width="1">
                        </blockquote>
                    </div>
                    <p class="bookmark-source">
                        Source: <a href="http://ejohn.org/blog/khan-exercise-rewrite/">http://ejohn.org/blog/khan-exercise-rewrite/</a>
                    </p>
                </div>
            </article>

            <nav id="post-nav">


            </nav>
        </section>

        <footer id="site-footer" class="nocontent">
            <p>
                This site is purely my personal work and does not reflect the
                views of my employer.
            </p>
            <p class="license">
                <a class="icon" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width: 0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a>
                This work is licensed under a
                <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported
                    License</a>.
            </p>
        </footer>

        <script async src="/static/js/common.js"></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js" integrity="sha256-hj+5FRlAuvAFANiefn0PpJYCkV1X4QT9EgiPd+6QnCw=" crossorigin="anonymous"></script>
    </body>
</html>
