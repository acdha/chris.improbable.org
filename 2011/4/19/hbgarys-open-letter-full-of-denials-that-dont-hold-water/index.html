<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>
            HBGary's open letter: full of denials that don't hold water
        </title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="/static/css/main.min.css" type="text/css" media="all"><!--[if lte IE 8]>
            <link rel="stylesheet" href="/static/css/ie-fixes.css" type="text/css" media="all">
            <script src="/static/js/html5shiv.js"></script>
        <![endif]-->
        <meta http-equiv="last-modified" content="Wed, 20 Apr 2011 00:49:00 GMT">
        <link rel="alternate" type="application/atom+xml" title="All Posts (Atom)" href="/feeds/all.atom">
        <link rel="alternate" type="application/rss+xml" title="All Posts (RSS)" href="/feeds/all.rss">
        <link rel="icon" type="image/jpeg" sizes="287x287" href="/static/img/favicon-287x287.jpg">
        <link rel="icon" type="image/jpeg" sizes="128x128" href="/static/img/favicon-128x128.jpg">
        <script type="application/javascript">
var _prum={id:"5166be01e6e53d1007000001"};var PRUM_EPISODES=PRUM_EPISODES||{};PRUM_EPISODES.q=[];PRUM_EPISODES.mark=function(b,a){PRUM_EPISODES.q.push(["mark",b,a||new Date().getTime()])};PRUM_EPISODES.measure=function(b,a,b){PRUM_EPISODES.q.push(["measure",b,a,b||new Date().getTime()])};PRUM_EPISODES.done=function(a){PRUM_EPISODES.q.push(["done",a])};PRUM_EPISODES.mark("firstbyte");(function(){var b=document.getElementsByTagName("script")[0];var a=document.createElement("script");a.type="text/javascript";a.async=true;a.charset="UTF-8";a.src="//rum-static.pingdom.net/prum.min.js";b.parentNode.insertBefore(a,b)})();
        </script>
    </head>
    <body class="blog post_detail" itemscope itemtype="http://schema.org/BlogPosting">
        <nav id="site-nav">
            <header id="about">
                <h1>
                    <a href="/about/">Chris Adams</a>
                </h1>
                <h2>
                    Programmer, cyclist, photographer
                </h2>
            </header>
            <ul class="links">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li>
                    <a href="/feeds/all.atom" title="Site Feed">Site Feed</a>
                </li>
            </ul>
            <ul class="social-networks">
                <li>
                    <a href="https://github.com/acdha" rel="me">Github</a>
                </li>
                <li>
                    <a href="http://bitbucket.org/acdha" rel="me">Bitbucket</a>
                </li>
                <li>
                    <a href="http://delicious.com/acdha" rel="me">del.icio.us</a>
                </li>
                <li>
                    <a href="http://twitter.com/acdha" rel="me">Twitter</a>
                </li>
                <li>
                    <a href="https://plus.google.com/116562742092842686896?rel=author" rel="me">Google+</a>
                </li>
                <li>
                    <a href="http://www.flickr.com/photos/acdha" rel="me">Flickr</a>
                </li>
                <li>
                    <a href="http://www.linkedin.com/in/acdha" rel="me">LinkedIn</a>
                </li>
                <li>
                    <a href="http://connect.garmin.com/explore?owner=acdha" rel="me">Garmin Connect</a>
                </li>
            </ul>
            <div id="site-search"></div>
        </nav>
        <section id="main">
            <article class="post">
                <header>
                    <meta itemprop="dateCreated" content="2011-04-19T20:49:00-04:00">
                    <meta itemprop="dateModified" content="2011-04-19T20:49:00-04:00"><time class="date" itemprop="datePublished" datetime="2011-04-20T00:49:00+00:00">Apr 20</time>
                    <h2 itemprop="title">
                        HBGary's open letter: full of denials that don't hold water
                    </h2>
                </header>
                <div class="body" itemprop="articleBody">
                    <div class="googlereader description" data-google-id="tag:google.com,2005:reader/item/0a34d37e79f55980">
                        <blockquote>
                            <a href="http://arstechnica.com/tech-policy/news/2011/04/hbgary-issues-denials-snipes-at-the-blog-o-sphere-in-open-letter.ars?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=rss"><img vspace="4" hspace="4" border="0" align="right" width="230" height="129" src="http://static.arstechnica.net/assets/2011/04/hbgary-open-letter-ars-thumb-230x130-21152-f.jpg"></a>
                            <p>
                                HBGary, the security firm that saw its servers hacked and its e-mails released after its HBGary Federal offshoot angered the Anonymous hive, <a href="http://www.hbgary.com/open-letter-from-hbgary">published</a> a rather peculiar open letter this past Friday in an effort to address the "large amount of misinformation reported in the press." But the letter makes some questionable claims of its own.
                            </p>
                            <p>
                                The unsigned letter outlines the basics of the attack and asserts that HBGary's internal systems remained safe and uncompromised. To ward off future attacks, the letter also claimed that HBGary's website, which was <a href="http://arstechnica.com/tech-policy/news/2011/02/anonymous-speaks-the-inside-story-of-the-hbgary-hack.ars">hacked using a basic security flaw</a>, and its e-mail system, which fell victim to <a href="http://arstechnica.com/tech-policy/news/2011/02/anonymous-speaks-the-inside-story-of-the-hbgary-hack.ars/2">weak, re-used passwords</a>, were now back in operation with "even stronger cyber defense mechanisms."
                            </p>
                            <p>
                                HBGary says that the company's concern in the immediate aftermath was to determine if customers had been affected by the intrusion. On receipt of legal advice, the company's policy was to refrain from commenting on the e-mails, though it acknowledges that this may have led to the amount of "misinformation" floating around.
                            </p>
                            <h3>
                                Deny everything
                            </h3>
                            <p>
                                The main thrust of the letter is an effort to distance HBGary from the entire hack and its subsequent aftermath. Five specific claims are made: that HBGary and HBGary Federal are distinct, with separate "management, employees, and missions"; that HBGary was not involved in the research performed by then-HBGary Federal CEO Aaron Barr and was merely caught in the crossfire; that HBGary did not develop Stuxnet; that HBGary does indeed sell software to the US government and is proud of that fact; and finally, that HBGary's rootkit research is solely to help improve its own security products.
                            </p>
                            <p>
                                While the claims about Stuxnet and software sales to the US government are uncontentious, the others are more than a little surprising. For a start, some of the claims appear to be contradicted by the extensive e-mail dumps. Though HBGary representatives have implied that some of the e-mails may have been tampered with, the prodigious quantity of mail precludes any substantial effort to create fraudulent mail (and the company never responded to our request to identify any instances of such fraud).
                            </p>
                            <p>
                                While HBGary Federal was legally a distinct company (albeit one with some overlap in ownership), both the hacking methodology and e-mails subsequently published make clear that this distinction was far less clear in practice.
                            </p>
                            <p>
                                The hack itself revealed that HBGary and HBGary Federal used a single Google Apps account for its e-mail. Former HBGary Federal CEO Aaron Barr, whose actions <a href="http://arstechnica.com/tech-policy/news/2011/02/how-one-security-firm-tracked-anonymousand-paid-a-heavy-price.ars">provoked the hack in the first place</a> and whose password was cracked, had administrative access to both HBGary and HBGary Federal mails. The e-mail accounts of HBGary Federal employees used the hbgary.com domain, not hbgaryfederal.com. HBGary Federal COO Ted Vera had access to a Linux server used by HBGary for providing support to its customers. And the e-mails themselves show that Aaron Barr was in regular correspondence with HBGary CEO Greg Hoglund. The two also worked together to decide how best to word press releases to promote HBGary Federal's work to uncover Anonymous.
                            </p>
                            <blockquote>
                                <pre>
From: Aaron Barr &lt;aaron@hbgary.com&gt;
To: Karen Burke &lt;karen@hbgary.com&gt;, Greg Hoglund &lt;greg@hbgary.com&gt;,
    Penny Leavy &lt;penny@hbgary.com&gt;, Ted Vera &lt;ted@hbgary.com&gt;
Subject: Story is really taking shape
Date: 2011-02-05

http://www.ft.com/cms/s/0/87dc140e-3099-11e0-9de3-00144feabdc0.html
#axzz1D3oZIcTk

--------------------------------------

From: Greg Hoglund &lt;greg@hbgary.com&gt;
To: Aaron Barr &lt;aaron@hbgary.com&gt;
Cc: Karen Burke &lt;karen@hbgary.com&gt;, Penny Leavy &lt;penny@hbgary.com&gt;,
    Ted Vera &lt;ted@hbgary.com&gt;
Subject: Re: Story is really taking shape

We should post this on front page, throw out some tweets.  "HBGary
Federal sets a new bar as private intelligence agency." - the pun on
bar is intended lol.

-G
</pre>
                            </blockquote>
                            <p>
                                Indeed, from day one, the lack of separation between the companies was clear. Greg Hoglund's e-mail introducing new hires Aaron Barr and Ted Vera had the subject "Welcome Aaron Barr and Ted Very to the HBGary management team!"—hardly supporting the open letter's claim of "completely different management."
                            </p>
                            <blockquote>
                                <pre>
From: Greg Hoglund &lt;greg@hbgary.com&gt;
To: all@hbgary.com
Subject: Welcome Aaron Barr and Ted Vera to the HBGary management team!
Date: 2009-11-23

I am extremely excited to announce that Aaron Barr and Ted Vera have joined 
the HBGary team!  Ted and Aaron will operate and lead HBGary Federal, a 
wholly owned subsidiary of HBGary, with a focus on contracting in the 
government space.  They are very experienced and most recently built a 
$10 million/year business at Northrop Grumman.  Both have won and lead 
multi-million dollar development projects and managed substantial teams.  
We have known Aaron and Ted for more than 5 years.  These two are A+ players 
in the DoD contracting space and are able to “walk the halls” in customer 
spaces. Some very big players made offers to Ted and Aaron last week, and 
instead they chose HBGary.  This reflects extremely well on our company.  
"A" players attract "A" players.  Aaron will take position as CEO of HBGary 
Federal, and will be operating out of the DC area. Ted will take position as 
President and COO of HBGary Federal, and will be operating out of Colorado 
Springs.  Welcome aboard!
 
-Greg Hoglund
CEO, HBGary, Inc.
</pre>
                            </blockquote>
                            <p>
                                So while the companies were legally distinct, their management and employees plainly, in practice, were not "completely different." At the very least, HBGary senior management oversaw and were involved with HBGary Federal's operations, and HBGary Federal employees had access to HBGary systems.
                            </p>
                            <p>
                                Next, the letter specifically distanced HBGary from Aaron Barr's research. The investigation into Anonymous was entirely HBGary Federal's doing, it says, and HBGary was an innocent bystander, caught in the crossfire when Anonymous sought retribution. Prior to the entire issue blowing up spectacularly in their faces, however, nobody from HBGary wanted to be distanced from the research.
                            </p>
                            <blockquote>
                                <pre>
From: Aaron Barr &lt;aaron@hbgary.com&gt;
To: Penny Leavy &lt;penny@hbgary.com&gt;, Greg Hoglund &lt;greg@hbgary.com&gt;
cc: Ted Vera &lt;ted@hbgary.com&gt;
Subject: BSides Talk
Date: 2011-01-22

Hey Guys,

I wanted to inform you of my research and content for the talk at Bsides.  
I have focused some of my research and talk around the anonymous group, a 
supposed loose collection of freedom of speech enthusiasts, anarchists, etc.  
They used to target the RIAA with DDOS attacks now they have taken up the 
cause of wikileaks, tunisia, venezuela, algeria, etc.  They have received 
a decent amount of press about this.

I am enumerating their communications infrastructure and plan to brief this 
as well as outing many of the major players within the group.  This will 
likely make HBGary Federal, and likely HBGary a target.

I have developed a persona that is well accepted within their groups and want 
to use this and my real persona against eachother to build up press for the 
talk.  Pre-talk plan.

I am going to tell a few key leaders under my persona, that I have been given 
information that a so called cyber security expert named Aaron Barr will be 
briefing the power of social media analysis and as part of the talk with be 
dissecting the Anonymous group as well as some critical infrastructure and 
government organizations

I will prepare a press sheet for Karen to give to Darkreading a few days 
after I tell these folks under persona to legitimize the accusation.  This 
will generate a big discussion in Anonymous chat channels, which are attended 
by the press.  This will then generate press about the talk, hopefully 
driving more people and more business to us.

But it will also make us a target.

Thoughts?

Aaron

--------------------------------------

From: Greg Hoglund &lt;greg@hbgary.com&gt;
To: Aaron Barr &lt;aaron@hbgary.com&gt;
Subject: Re: BSides Talk
Date: 2011-01-23

Well,

I don't really want to get DDOS'd, so assuming we do get DDOS'd then
what?  How do we make lemonade from that?

-Greg
</pre>
                            </blockquote>
                            <p>
                                HBGary may not have been aware of the full extent of Aaron Barr's investigation, but completely in the dark they were not; Aaron Barr outlined his research to Greg Hoglund and Penny Leavy, Hoglund's wife and co-owner, on January 22nd, two weeks before the eventual hack. Though Hoglund expressed concern that the research might result in a denial-of-service attack against the company, he showed no qualms about either the subject matter of the research or Barr's investigative methods. When Barr's research started to get some publicity—notably, a story in the <em>Financial Times</em>—Hoglund was quick to praise Barr and leverage the media coverage to promote the companies.
                            </p>
                            <p>
                                HBGary may not have known everything that Aaron Barr did, but HBGary Federal was plainly operating with the backing of the parent corporation.
                            </p>
                            <h3>
                                Ethical concerns
                            </h3>
                            <p>
                                Perhaps more significantly, however, the open letter <em>doesn't</em> really distance the company from some of the more alarming or damaging revelations. The letter admits that HBGary sells software to the US government, and performs some amount of in-house rootkit development, but leaves the more substantial claims unaddressed. The e-mail trail showed that HBGary was <a href="http://arstechnica.com/tech-policy/news/2011/02/black-ops-how-hbgary-wrote-backdoors-and-rootkits-for-the-government.ars">pitching its rootkits to defense contractors</a>, and writing what can only be described as malware; hostile programs that would exploit security flaws and install rootkits.
                            </p>
                            <div style="width:640px">
                                <img src="http://static.arstechnica.com/04-18-2011/12_monkeys.png">
                                <div style="background-color:#eee;color:#333;padding:10px">
                                    <div>
                                        The 12 Monkeys rootkit
                                    </div>
                                </div>
                            </div>
                            <p>
                                The letter claimed that this malware had never been used to attack "foreign countries," and that HBGary knew of no instance of production deployment. Instead, these novel rootkits were intended merely to "understand the offensive nature of our foes." Unfortunately, that doesn't really make much sense as an excuse. The company boasted to potential buyers of its rootkits how they went undetected by standard anti-malware software, a feature only useful if the software is going to be used in the wild. Greg Hoglund, in describing the plans for the HBGary Magenta rootkit, made clear that, in his view, nothing like it existed; this was no mere copycat of existing in-the-wild rootkits, but something new and unique. If Hoglund's assessment is accurate, the insight such a rootkit would give into HBGary's "foes" is negligible—it was technology that those foes hadn't invented and weren't using. This would be useful for attacking, but much less useful for defending.
                            </p>
                            <div style="width:640px">
                                <img src="http://static.arstechnica.com/04-18-2011/magenta.png">
                                <div style="background-color:#eee;color:#333;padding:10px">
                                    <div>
                                        HBGary's Magenta project
                                    </div>
                                </div>
                            </div>
                            <p>
                                HBGary may very well not actually <em>know</em> about real deployments, but that's missing the point. The concern over its actions were not that the company had explicit, detailed knowledge of actual hacks using its tools—of <em>course</em> the government wouldn't tell HBGary if this were the case. Rather, they concerns were that the company was developing these undetectable rootkits, selling (or at least, attempting to sell) them to defense contractors, at which point they could be sold to essentially any agency for any purpose—they could just as well be used to spy on domestic dissidents as they could on foreign powers.
                            </p>
                            <blockquote>
                                <pre>
From: Bob Slapnik &lt;bob@hbgary.com&gt;
To: Greg Hoglund &lt;greg@hbgary.com&gt;, Penny C. Hoglund &lt;penny@hbgary.com&gt;
Subject: Need 12 Monkeys price
Date: 2009-04-14

Greg,
 
Ben [redacted]'s customer may have $200k to spend.  Ben wants us to give him 
a *price* to sell the software as a license where we retain the IP.  The work 
would be firm fixed price (not hourly).  This will not be viewed as contract 
work -- it will be viewed as our selling a product.
 
We should only take the work if we believe we can succeed and do it in 2 
months.  It looks like, if awarded, our work will start in about 2 months.
 
12 Monkeys Details.  Ben needs price quote for a complete tool that
- finds MS Office files using the XRK technique to exfiltrate files
- uses the 12 Monkey technique to exist and hide.
- Runs on MS Windows XP sp2 and Office 2003.
- both Client and Server side.
 
Ben wants us to retain the IP so he can sell it to more customers.
</pre>
                            </blockquote>
                            <p>
                                Concluding the letter, HBGary bemoans the state of the press, complaining of low standards of fact-checking and a failure to verify information—something that it blames on the "blog-o-sphere." This comes after admitting earlier in the letter that the company's own refusal to communicate with the press (something that Ars Technica experienced firsthand) was likely to blame in part for that incorrect information. Though some of the speculation surrounding the case was indeed wild (see: Stuxnet), there was little reason to make things up; the facts alone were remarkable enough.
                            </p>
                            <p>
                                The open letter is a strange thing indeed. If HBGary's aim is to rehabilitate its image, flat denials of the facts revealed in the airing of its dirty laundry are unlikely to be effective. Claiming total ignorance and blaming Aaron Barr and HBGary Federal for everything—in contradiction of the e-mail evidence—is unconvincing, and failing to even acknowledge the serious ethical concerns about the way the business operated means that question marks over the company's conduct remain. But perhaps the letter simply reflects a corporate mindset that ethical constraints are irrelevant so long as one doesn't get caught. On that front, the letter is quite reassuring.
                            </p>
                            <p>
                                <a href="http://arstechnica.com/tech-policy/news/2011/04/hbgary-issues-denials-snipes-at-the-blog-o-sphere-in-open-letter.ars?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=rss&amp;comments=1#comments-bar">Read the comments on this post</a>
                            </p>
                        </blockquote>
                    </div>
                    <p class="bookmark-source">
                        Source: <a href="http://arstechnica.com/tech-policy/news/2011/04/hbgary-issues-denials-snipes-at-the-blog-o-sphere-in-open-letter.ars?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=rss">http://arstechnica.com/tech-policy/news/2011/04/hbgary-issues-denials-snipes-at-the-blog-o-sphere-in-open-letter.ars?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=rss</a>
                    </p>
                </div>
            </article>
            <nav id="post-nav"></nav><script id="discus-javascript">
    var disqus_shortname = 'improbable';

                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    document.getElementsByTagName('body')[0].appendChild(dsq);
                })();
            </script><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            <div id="disqus_thread"></div>
        </section>
        <footer id="site-footer">
            <p>
                This site is purely my personal work and does not reflect the views of my employer.
            </p>
            <p class="license">
                <a class="icon" rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a> This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
            </p>
        </footer><script async="" defer src="/static/js/common.js">
</script><script id="google-analytics">
    var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-2097834-1']);
            _gaq.push(['_setDomainName', 'improbable.org']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
    </body>
</html>
