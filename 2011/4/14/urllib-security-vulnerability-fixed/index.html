<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>
            urllib Security Vulnerability Fixed
        </title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="/static/css/main.min.css" type="text/css" media="all"><!--[if lte IE 8]>
            <link rel="stylesheet" href="/static/css/ie-fixes.css" type="text/css" media="all">
            <script src="/static/js/html5shiv.js"></script>
        <![endif]-->
        <meta http-equiv="last-modified" content="Thu, 14 Apr 2011 14:55:16 GMT">
        <link rel="alternate" type="application/atom+xml" title="All Posts (Atom)" href="/feeds/all.atom">
        <link rel="alternate" type="application/rss+xml" title="All Posts (RSS)" href="/feeds/all.rss">
        <link rel="icon" type="image/jpeg" sizes="287x287" href="/static/img/favicon-287x287.jpg">
        <link rel="icon" type="image/jpeg" sizes="128x128" href="/static/img/favicon-128x128.jpg">
        <script type="application/javascript">
var _prum={id:"5166be01e6e53d1007000001"};var PRUM_EPISODES=PRUM_EPISODES||{};PRUM_EPISODES.q=[];PRUM_EPISODES.mark=function(b,a){PRUM_EPISODES.q.push(["mark",b,a||new Date().getTime()])};PRUM_EPISODES.measure=function(b,a,b){PRUM_EPISODES.q.push(["measure",b,a,b||new Date().getTime()])};PRUM_EPISODES.done=function(a){PRUM_EPISODES.q.push(["done",a])};PRUM_EPISODES.mark("firstbyte");(function(){var b=document.getElementsByTagName("script")[0];var a=document.createElement("script");a.type="text/javascript";a.async=true;a.charset="UTF-8";a.src="//rum-static.pingdom.net/prum.min.js";b.parentNode.insertBefore(a,b)})();
        </script>
    </head>
    <body class="blog post_detail" itemscope itemtype="http://schema.org/BlogPosting">
        <nav id="site-nav">
            <header id="about">
                <h1>
                    <a href="/about/">Chris Adams</a>
                </h1>
                <h2>
                    Programmer, cyclist, photographer
                </h2>
            </header>
            <ul class="links">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li>
                    <a href="/feeds/all.atom" title="Site Feed">Site Feed</a>
                </li>
            </ul>
            <ul class="social-networks">
                <li>
                    <a href="https://github.com/acdha" rel="me">Github</a>
                </li>
                <li>
                    <a href="http://bitbucket.org/acdha" rel="me">Bitbucket</a>
                </li>
                <li>
                    <a href="http://delicious.com/acdha" rel="me">del.icio.us</a>
                </li>
                <li>
                    <a href="http://twitter.com/acdha" rel="me">Twitter</a>
                </li>
                <li>
                    <a href="https://plus.google.com/116562742092842686896?rel=author" rel="me">Google+</a>
                </li>
                <li>
                    <a href="http://www.flickr.com/photos/acdha" rel="me">Flickr</a>
                </li>
                <li>
                    <a href="http://www.linkedin.com/in/acdha" rel="me">LinkedIn</a>
                </li>
                <li>
                    <a href="http://connect.garmin.com/explore?owner=acdha" rel="me">Garmin Connect</a>
                </li>
            </ul>
            <div id="site-search"></div>
        </nav>
        <section id="main">
            <article class="post">
                <header>
                    <meta itemprop="dateCreated" content="2011-04-14T10:44:00-04:00">
                    <meta itemprop="dateModified" content="2011-04-14T10:44:00-04:00"><time class="date" itemprop="datePublished" datetime="2011-04-14T14:44:00+00:00">Apr 14</time>
                    <h2 itemprop="title">
                        urllib Security Vulnerability Fixed
                    </h2>
                </header>
                <div class="body" itemprop="articleBody">
                    <div class="googlereader description" data-google-id="tag:google.com,2005:reader/item/8055736b464a2255">
                        <blockquote>
                            <div>
                                <p>
                                    Guido van Rossum <a href="http://hg.python.org/cpython/rev/a778b963eae3">recently pushed a fix</a> for CVE-2011-1521, a security issue in Python's URL libraries. While security issues are rare, it's a good opportunity to let the community in on the process behind reporting, handling, and fixing these issues as they arise.
                                </p>
                                <div>
                                    <h4>
                                        Reporting an Issue
                                    </h4>
                                    <p>
                                        If you've found a security issue within CPython, the first thing we ask is that you keep the details of the issue private. After determining that you have found a legitimate security issue, generating a succinct but detailed report is key to transferring your knowledge to the core developers.
                                    </p>
                                    <p>
                                        A good report clearly explains how the relevant parts of the system are affected by the issue. If the issue occurs on a specific platform or due to a dependency, that's helpful to know as well. The affected versions are useful to know, and it's likely that the vulernability will be tested for all active versions as well. Lastly, if you have a test case that shows the issue, be sure to include it. Your report should be sent to the <a href="mailto:security@python.org">security@python.org</a> group.
                                    </p>
                                    <p>
                                        Niels Heinen of the Google Security Team recently <a href="http://bugs.python.org/issue11662#msg131981">submitted a good report</a>. He discovered an issue with HTTP 302 redirection handling in the standard library <a href="http://docs.python.org/library/urllib">urllib</a> and <a href="http://docs.python.org/library/urllib2">urllib2</a> modules. What he found was that a server could redirect requests to inappropriate schemes, leading to situations which could compromise data or systems. In his initial report, Neils explains two scenarios where these redirections could expose problems.
                                    </p>
                                    <p>
                                        First, since <tt>urllib</tt>/<tt>urllib2</tt> supplies a handler for the <tt><span>file://</span></tt> URL scheme, a redirection to <tt><span>file:///etc/passwd</span></tt> could expose password data. Neils also explained that redirection to a system device like <tt><span>file:///dev/zero</span></tt> could lead to exhaustion of resources leading to a denial of service.
                                    </p>
                                </div>
                                <div>
                                    <h4>
                                        Handling a Report
                                    </h4>
                                    <p>
                                        Due to the sensitive nature of security reports, the <a href="mailto:security@python.org">security@python.org</a> list is maintained by a small group of trusted developers who analyze and act on reports as soon as possible. If you wish to keep your transmissions to the list encrypted, see the <a href="http://www.python.org/news/security/">security news</a> page for OpenPGP details.
                                    </p>
                                    <p>
                                        If the group determines that there is in fact a security issue, a public bug report may be made with an accompanying patch. In this case, Guido van Rossum made the issue public in <a href="http://bugs.python.org/issue11662">issue #11662</a>, complete with an initial patch.
                                    </p>
                                </div>
                                <div>
                                    <h4>
                                        Fixing the Issue
                                    </h4>
                                    <p>
                                        What Guido's patch does is restrict redirection to <tt><span>http://</span></tt>, <tt><span>https://</span></tt>, and <tt><span>ftp://</span></tt> URL schemes. FTP redirection was deemed acceptable, and it's actually a common redirection: download mirroring systems sometimes redirect requests to geographically convenient FTP servers.
                                    </p>
                                    <p>
                                        For Python 2.x, <a href="http://docs.python.org/library/urllib#urllib.FancyURLopener">FancyURLopener</a>'s <tt>redirect_internal</tt> method now raises an <tt>IOError</tt> when redirection to an inappropriate scheme is requested. <a href="http://docs.python.org/library/urllib2#httpredirecthandler-objects">HTTPRedirectHandler</a>'s <tt>http_error_302</tt> does the same, only raising <tt>HTTPError</tt>. In Python 3, <a href="http://docs.python.org/dev/library/urllib.request">urllib.request</a> received the same fixes. Included with the patch are two tests which exercise redirection to both valid and invalid schemes.
                                    </p>
                                    <p>
                                        As for users receiving the fix, the final security release of Python 2.5 will be occurring soon. While there are no scheduled dates for the next patch releases of the maintenance branches - 2.6, 2.7, 3.1, and 3.2 - all received the code to fix the vulnerability.
                                    </p>
                                </div>
                            </div>
                            <div>
                                <img width="1" height="1" src="https://blogger.googleusercontent.com/tracker/3941553907430899163-7504707121491029670?l=blog.python.org" alt="">
                            </div>
                            <div>
                                <a href="http://feeds.feedburner.com/~ff/PythonInsider?a=9Z_E5ra50vU:szpd5gF1ucU:yIl2AUoC8zA"><img src="http://feeds.feedburner.com/~ff/PythonInsider?d=yIl2AUoC8zA" border="0"></a> <a href="http://feeds.feedburner.com/~ff/PythonInsider?a=9Z_E5ra50vU:szpd5gF1ucU:-BTjWOF_DHI"><img src="http://feeds.feedburner.com/~ff/PythonInsider?i=9Z_E5ra50vU:szpd5gF1ucU:-BTjWOF_DHI" border="0"></a> <a href="http://feeds.feedburner.com/~ff/PythonInsider?a=9Z_E5ra50vU:szpd5gF1ucU:F7zBnMyn0Lo"><img src="http://feeds.feedburner.com/~ff/PythonInsider?i=9Z_E5ra50vU:szpd5gF1ucU:F7zBnMyn0Lo" border="0"></a> <a href="http://feeds.feedburner.com/~ff/PythonInsider?a=9Z_E5ra50vU:szpd5gF1ucU:V_sGLiPBpWU"><img src="http://feeds.feedburner.com/~ff/PythonInsider?i=9Z_E5ra50vU:szpd5gF1ucU:V_sGLiPBpWU" border="0"></a> <a href="http://feeds.feedburner.com/~ff/PythonInsider?a=9Z_E5ra50vU:szpd5gF1ucU:qj6IDK7rITs"><img src="http://feeds.feedburner.com/~ff/PythonInsider?d=qj6IDK7rITs" border="0"></a>
                            </div>
                        </blockquote>
                    </div>
                    <p class="bookmark-source">
                        Source: <a href="http://blog.python.org/2011/04/urllib-security-vulnerability-fixed.html?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed%3A+PythonInsider+%28Python+Insider%29">http://blog.python.org/2011/04/urllib-security-vulnerability-fixed.html?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed%3A+PythonInsider+%28Python+Insider%29</a>
                    </p>
                </div>
            </article>
            <nav id="post-nav"></nav><script id="discus-javascript">
    var disqus_shortname = 'improbable';

                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    document.getElementsByTagName('body')[0].appendChild(dsq);
                })();
            </script><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            <div id="disqus_thread"></div>
        </section>
        <footer id="site-footer" class="nocontent">
            <p>
                This site is purely my personal work and does not reflect the views of my employer.
            </p>
            <p class="license">
                <a class="icon" rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a> This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
            </p>
        </footer><script async="" defer src="/static/js/common.js">
</script><script id="google-analytics">
    var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-2097834-1']);
            _gaq.push(['_setDomainName', 'improbable.org']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
    </body>
</html>
