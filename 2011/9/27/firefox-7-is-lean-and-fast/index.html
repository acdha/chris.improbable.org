<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>
            Firefox 7 is lean and fast
        </title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="/static/css/main.min.css" type="text/css" media="all"><!--[if lte IE 8]>
            <link rel="stylesheet" href="/static/css/ie-fixes.css" type="text/css" media="all">
            <script src="/static/js/html5shiv.js"></script>
        <![endif]-->
        <meta http-equiv="last-modified" content="Tue, 27 Sep 2011 14:08:53 GMT">
        <link rel="alternate" type="application/atom+xml" title="All Posts (Atom)" href="/feeds/all.atom">
        <link rel="alternate" type="application/rss+xml" title="All Posts (RSS)" href="/feeds/all.rss">
        <link rel="icon" type="image/jpeg" sizes="287x287" href="/static/img/favicon-287x287.jpg">
        <link rel="icon" type="image/jpeg" sizes="128x128" href="/static/img/favicon-128x128.jpg">
        <script type="application/javascript">
var _prum={id:"5166be01e6e53d1007000001"};var PRUM_EPISODES=PRUM_EPISODES||{};PRUM_EPISODES.q=[];PRUM_EPISODES.mark=function(b,a){PRUM_EPISODES.q.push(["mark",b,a||new Date().getTime()])};PRUM_EPISODES.measure=function(b,a,b){PRUM_EPISODES.q.push(["measure",b,a,b||new Date().getTime()])};PRUM_EPISODES.done=function(a){PRUM_EPISODES.q.push(["done",a])};PRUM_EPISODES.mark("firstbyte");(function(){var b=document.getElementsByTagName("script")[0];var a=document.createElement("script");a.type="text/javascript";a.async=true;a.charset="UTF-8";a.src="//rum-static.pingdom.net/prum.min.js";b.parentNode.insertBefore(a,b)})();
        </script>
    </head>
    <body class="blog post_detail" itemscope itemtype="http://schema.org/BlogPosting">
        <nav id="site-nav">
            <header id="about">
                <h1>
                    <a href="/about/">Chris Adams</a>
                </h1>
                <h2>
                    Programmer, cyclist, photographer
                </h2>
            </header>
            <ul class="links">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li>
                    <a href="/feeds/all.atom" title="Site Feed">Site Feed</a>
                </li>
            </ul>
            <ul class="social-networks">
                <li>
                    <a href="https://github.com/acdha" rel="me">Github</a>
                </li>
                <li>
                    <a href="http://bitbucket.org/acdha" rel="me">Bitbucket</a>
                </li>
                <li>
                    <a href="http://delicious.com/acdha" rel="me">del.icio.us</a>
                </li>
                <li>
                    <a href="http://twitter.com/acdha" rel="me">Twitter</a>
                </li>
                <li>
                    <a href="https://plus.google.com/116562742092842686896?rel=author" rel="me">Google+</a>
                </li>
                <li>
                    <a href="http://www.flickr.com/photos/acdha" rel="me">Flickr</a>
                </li>
                <li>
                    <a href="http://www.linkedin.com/in/acdha" rel="me">LinkedIn</a>
                </li>
                <li>
                    <a href="http://connect.garmin.com/explore?owner=acdha" rel="me">Garmin Connect</a>
                </li>
            </ul>
            <div id="site-search"></div>
        </nav>
        <section id="main">
            <article class="post">
                <header>
                    <meta itemprop="dateCreated" content="2011-09-27T10:08:53-04:00">
                    <meta itemprop="dateModified" content="2011-09-27T10:08:53-04:00"><time class="date" itemprop="datePublished" datetime="2011-09-27T14:08:53+00:00">Sep 27</time>
                    <h2 itemprop="title">
                        Firefox 7 is lean and fast
                    </h2>
                </header>
                <div class="body" itemprop="articleBody">
                    <div class="googlereader description" data-google-id="tag:google.com,2005:reader/item/cd30c3ecf275dfac">
                        <blockquote>
                            <p>
                                <em>Based on a blog post originally posted <a href="http://blog.mozilla.com/nnethercote/2011/08/09/firefox-7-is-lean-and-fast-2/" title="Firefox is Lean and Fast">here</a> by Nicholas Nethercote, Firefox Developer.</em>
                            </p>
                            <p>
                                <strong>tl;dr</strong><br>
                                Firefox 7 now uses much less memory than previous versions: often 20% to 30% less, and sometimes as much as 50% less. This means that Firefox and the websites you use will be snappier, more responsive, and suffer fewer pauses. It also means that Firefox is less likely to crash or abort due to running out of memory.
                            </p>
                            <p>
                                These benefits are most noticeable if you do any of the following:<br>
                                - keep Firefox open for a long time;<br>
                                - have many tabs open at once, particularly tabs with many images;<br>
                                - view web pages with large amounts of text;<br>
                                - use Firefox on Windows<br>
                                - use Firefox at the same time as other programs that use lots of memory.<br>
                                <strong><br>
                                Background</strong><br>
                                Mozilla engineers started an effort called <a href="https://wiki.mozilla.org/Performance/MemShrink">MemShrink</a>, the aim of which is to improve Firefox’s speed and stability by reducing its memory usage. A great deal of <a href="http://blog.mozilla.com/nnethercote/category/memshrink/">progress</a> has been made, and thanks to Firefox’s <a href="https://wiki.mozilla.org/RapidRelease/Calendar">faster development cycle</a>, each improvement made will make its way into a final release in only 12–18 weeks. The newest update to Firefox is the first general release to benefit from MemShrink’s successes, and the benefits are significant.
                            </p>
                            <p>
                                <strong>Quantifying the improvements</strong><br>
                                Measuring memory usage is difficult: there are no standard benchmarks, there are several different metrics you can use, and memory usage varies enormously depending on what the browser is doing. Someone who usually has only a handful of tabs open will have an entirely different experience from someone who usually has hundreds of tabs open. (This latter case is not uncommon, by the way, even though the idea of anyone having that many tabs open triggers astonishment and disbelief in many people. E.g. see the comment threads <a href="http://news.ycombinator.com/item?id=2840440">here</a> and <a href="http://www.reddit.com/r/programming/comments/j7m7k/scalability/">here</a>.)
                            </p>
                            <p>
                                <strong>Endurance tests</strong><br>
                                Dave Hunt and others have been using the MozMill add-on to perform “<a href="https://wiki.mozilla.org/QA/Mozmill_Test_Automation/Endurance_Tests">endurance tests</a>“, where they open and close large numbers of websites and track memory usage in great detail. Dave recently performed an <a href="http://blargon7.com/2011/07/endurance-tests-demonstrate-firefoxs-memory-usage-improvements/">endurance test comparison of development versions of Firefox</a>, repeatedly opening and closing pages from 100 widely used websites in 30 tabs.
                            </p>
                            <p>
                                <em>[The following numbers were run while the most current version of Firefox was in Beta and capture the average and peak “resident” memory usage for each browser version over five runs of the tests. “Resident” memory usage is the amount of physical RAM that is being used by Firefox, and is thus arguably the best measure of real machine resources being used.]</em>
                            </p>
                            <p>
                                <img src="http://blog.mozilla.com/nnethercote/files/2011/08/average2.png" alt="2"><br>
                                <img src="http://blog.mozilla.com/nnethercote/files/2011/08/peak.png" alt="3">
                            </p>
                            <p>
                                The measurements varied significantly between runs. If we do a pair-wise comparison of runs, we see the following relative reductions in memory usage:
                            </p>
                            <p>
                                Minimum resident: 1.1% — 23.5% (median 6.6%)<br>
                                Maximum resident: -3.5% — 17.9% (median 9.6%)<br>
                                Average resident: 4.4% — 27.3% (median 20.0%)
                            </p>
                            <p>
                                The following two graphs showing how memory usage varied over time during Run 1 for each version. Firefox 6′s graph is first, with the latest version second. (Note: Compare only to the purple “resident” lines; the meaning of the green “explicit” line changed between the versions and so the two green lines cannot be sensibly compared.)<br>
                                Firefox 7 is clearly much better; its graph is both lower and has less variation.
                            </p>
                            <p>
                                <img src="http://blog.mozilla.com/nnethercote/files/2011/08/ff6.png" alt="ff6"><br>
                                <img src="http://blog.mozilla.com/nnethercote/files/2011/08/ff7.png" alt="ff7">
                            </p>
                            <p>
                                <strong><br>
                                MemBench</strong><br>
                                Gregor Wagner has a memory stress test called <a href="http://gregor-wagner.com/tmp/mem">MemBench</a>. It opens 150 websites in succession, one per tab, with a 1.5 second gap between each site. The sites are mostly drawn from <a href="http://www.alexa.com/topsites/category">Alexa’s Top sites</a> list. I ran this test on 64-bit builds of Firefox 6 and 7 on my Ubuntu Linux machine, which has 16GB of RAM. Each time, I let the stress test complete and then opened about:memory to get measurements for the peak resident usage. Then I hit the “Minimize memory usage” button in about:memory several times until the numbers stabilized again, and then re-measured the resident usage. (Hitting this button is not something normal users do, but it’s useful for testing purposes because causes Firefox to immediately free up memory that would be eventually freed when garbage collection runs.)
                            </p>
                            <p>
                                For Firefox 6, the peak resident usage was 2,028 MB and the final resident usage was 669 MB. For Firefox 7, the peak usage was 1,851 MB (a 8.7% reduction) and the final usage was 321 MB (a 52.0% reduction). This latter number clearly shows that <a href="http://en.wikipedia.org/wiki/Fragmentation_%28computer%29">fragmentation</a> is a much smaller problem in Firefox 7.<br>
                                (On a related note, Gregor recently <a href="http://gregor-wagner.com/?p=79">measured</a> cutting-edge development versions of Firefox and Google Chrome on MemBench.)
                            </p>
                            <p>
                                <strong><br>
                                Conclusion</strong><br>
                                Obviously, these tests are synthetic and do not match exactly how users actually use Firefox. (Improved benchmarking is one thing we’re working on as part of MemShrink, but we’ve got a long way to go. ) Nonetheless, the basic operations (opening and closing web pages in tabs) are the same, and we expect the improvements in real usage will mirror improvements in the tests.
                            </p>
                            <p>
                                This means that users should see Firefox 7 using less memory than earlier versions — often 20% to 30% less, and sometimes as much as 50% less — though the improvements will depend on the exact workload. Indeed, we have had lots of feedback from early users that the latest Firefox update feels faster, is more responsive, has fewer pauses, and is generally more pleasant to use than previous versions.
                            </p>
                            <p>
                                Mozilla’s MemShrink efforts are continuing. The endurance test results above show that the Beta version of Firefox already has even better memory usage, and I expect we’ll continue to make further improvements as time goes on.
                            </p>
                        </blockquote>
                    </div>
                    <p class="bookmark-source">
                        Source: <a href="http://hacks.mozilla.org/2011/09/firefox-7-is-lean-and-fast/">http://hacks.mozilla.org/2011/09/firefox-7-is-lean-and-fast/</a>
                    </p>
                </div>
            </article>
            <nav id="post-nav"></nav><script id="discus-javascript">
    var disqus_shortname = 'improbable';

                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    document.getElementsByTagName('body')[0].appendChild(dsq);
                })();
            </script><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            <div id="disqus_thread"></div>
        </section>
        <footer id="site-footer">
            <p>
                This site is purely my personal work and does not reflect the views of my employer.
            </p>
            <p class="license">
                <a class="icon" rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a> This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
            </p>
        </footer><script async="" defer src="/static/js/common.js">
</script><script id="google-analytics">
    var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-2097834-1']);
            _gaq.push(['_setDomainName', 'improbable.org']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
    </body>
</html>
