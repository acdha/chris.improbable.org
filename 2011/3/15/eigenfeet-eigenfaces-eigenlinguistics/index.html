<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Eigenfeet, eigenfaces, eigenlinguistics, …</title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="/static/css/main.min.css" type="text/css" media="all">
        <!--[if lte IE 8]>
            <link rel="stylesheet" href="/static/css/ie-fixes.css" type="text/css" media="all">
            <script src="/static/js/html5shiv.js"></script>
        <![endif]-->

        <meta http-equiv="last-modified" content="Tue, 15 Mar 2011 12:38:03 GMT">
        <link rel="alternate" type="application/atom+xml" title="All Posts (Atom)" href="/feeds/all.atom">
        <link rel="alternate" type="application/rss+xml" title="All Posts (RSS)" href="/feeds/all.rss">
        <link rel="icon" type="image/jpeg" sizes="287x287" href="/static/img/favicon-287x287.jpg">
        <link rel="icon" type="image/jpeg" sizes="128x128" href="/static/img/favicon-128x128.jpg">
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-2097834-1', 'auto');
            ga('send', 'pageview');
        </script>
    </head>
    <body class="blog post_detail" itemscope itemtype="http://schema.org/BlogPosting">
        <nav id="site-nav">
            <header id="about">
                <h1><a href="/about/">Chris Adams</a></h1>
                <h2>Programmer, cyclist, photographer</h2>
            </header>
            <ul class="links">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li>
                    <a href="/feeds/all.atom" title="Site Feed">Site Feed</a>
                </li>
            </ul>
            <ul class="social-networks">
                <li>
                    <a href="https://github.com/acdha" rel="me">Github</a>
                </li>
                <li>
                    <a href="https://bitbucket.org/acdha" rel="me">Bitbucket</a>
                </li>
                <li>
                    <a href="https://pinboard.in/u:acdha/" rel="me">Pinboard</a>
                </li>
                <li>
                    <a href="https://twitter.com/acdha" rel="me">Twitter</a>
                </li>
                <li>
                    <a href="https://www.flickr.com/photos/acdha" rel="me">Flickr</a>
                </li>
                <li>
                    <a href="https://www.linkedin.com/in/acdha" rel="me">LinkedIn</a>
                </li>
            </ul>
            <div id="site-search"></div>
        </nav>
        <section id="main">
            <article class="post">
                <header>
                    <meta itemprop="dateCreated" content="2011-03-15T08:38:03-04:00">
                    <meta itemprop="dateModified" content="2011-03-15T08:38:03-04:00">
                    <time class="date" itemprop="datePublished" datetime="2011-03-15T12:38:03+00:00">Mar 15</time>
                    <h2 class="" itemprop="title">Eigenfeet, eigenfaces, eigenlinguistics, …</h2>
                </header>

                <div class="body" itemprop="articleBody"><div class="googlereader description" data-google-id="tag:google.com,2005:reader/item/38669fc9772d17b8">
                        <blockquote>
                            <p>
                                The <a href="http://xkcd.com/872/">latest xkcd</a>:
                            </p>
                            <p>
                                <a href="http://languagelog.ldc.upenn.edu/myl/fairy_tales.png"><img title="Goldilocks' discovery of Newton's method for approximation required surprisingly few changes." src="http://languagelog.ldc.upenn.edu/myl/fairy_tales.png" alt="" width="475"></a>
                            </p>
                            <p>
                                (As usual, click on the image for a larger version.)<br>
                            </p>
                            <p>
                                I think that this is the first reference to eigenanalysis in a widely-read comic strip. (It's not a first for popular culture: Dudley Eigenvalue, DDS, was an important secondary character in <a href="http://en.wikipedia.org/wiki/V.">Thomas Pynchon's novel V.</a> But that's another story.)
                            </p>
                            <p>
                                As the <a href="http://en.wikipedia.org/wiki/Eigenvector">wikipedia page on Eigenvalues and Eigenvectors</a> explains,
                            </p>
                            <p style="padding-left:30px">
                                <span style="color:#000080">The eigenvectors of a square matrix are the non-zero vectors which, after being multiplied by the matrix, remain proportional to the original vector (i.e. change only in magnitude, not in direction). For each eigenvector, the corresponding eigenvalue is the factor by which the eigenvector changes when multiplied by the matrix. The prefix eigen- is adopted from the German word "eigen" for "innate", "own". The eigenvectors are sometimes also called proper vectors, or characteristic vectors. Similarly, the eigenvalues are also known as proper values, or characteristic values.</span>
                            </p>
                            <p>
                                So why might the prince use eigenvectors to match shoes to their owners?  This is a reference, I think, to a well-known pattern-recognition technique, in which eigenanalysis is used to create a lower-dimensional representation of the members of a set of high-dimensional objects like pictures of faces.
                            </p>
                            <p>
                                In the <a href="http://en.wikipedia.org/wiki/Eigenface">eigenface</a> technique, we start with relatively high-resolution pictures of faces — say 320×240 = 76,800 pixels.  We accumulate a collection of such pictures. If these are grey-scale pictures, we can think of each picture as a weighted sum of 76,800 "basis pictures", each of which has a zero value everywhere except at one of the pixel locations. The coefficients of this weighted sum are then just the picture's original pixel values, and the sequence of coefficients for a given picture is, by trivial definition, a vector in a 76,800-dimensional space. (This seems like a lot of work for no purpose, but the general approach turns out to be extraordinarily useful.)
                            </p>
                            <p>
                                We'd like to find a way to project these vectors into a much lower-dimensional subspace, such that as much as possible of the differences among the faces in our collection is preserved. With a bit of linear algebra, we can show that we can do this by choosing, as our new "basis pictures", the first few eigenvectors of the covariance matrix of our picture collection. Each of these new basis vectors will be a 76,800-dimensional vector, i.e. in this application a sort of a picture, and one of the pictures in our collection (or more important, a new picture) can now be represented as a linear combination (a weighted sum) of these basis vectors.
                            </p>
                            <p>
                                But these new basis vectors, instead of being blank everywhere but at one pixel location, as our original basis vectors were, have some distribution of non-zero values over the whole picture area, in some cases looking somewhat like fuzzy faces — hence the term "eigenfaces".
                            </p>
                            <p>
                                Furthermore, if we order the eigenvectors by the magnitude of the associated eigenvalues, and keep just the first few of them, we can get a perhaps-surprisingly good approximation to the original pictures by adding up a weighted combination of a surprisingly small number of these "eigenfaces" — here say something like 32 or 64 or 128. The weights involved are then a radically smaller representation of each picture — a vector with 128 elements rather than 76,800 elements.
                            </p>
                            <p>
                                In this new space, it seems that simple measures of similarity between vectors — perhaps as simple as euclidean distance, i.e. the square root of the sum of squared element-wise differences — give us a metric that does a rather good job of identifying faces. We take a new picture, calculate its representation in the "eigenface" space, and then compare it (in that space) to each of the pictures in our collection.
                            </p>
                            <p>
                                So the idea behind the first xkcd panel is that the prince would create, or have access to, some sort of biometric database of foot representations, and would use it to create a space of "eigenfeet" in which newly-encountered foot shapes could be compared against existing entries, as a suitably dream-nerdy translation of trying the abandoned slipper on every female foot in the kingdom.
                            </p>
                            <p>
                                What does this have to do with linguistics?
                            </p>
                            <p>
                                Well, the number of connections may be surprising to those who are not used to the <a href="http://www.dartmouth.edu/~matc/MathDrama/reading/Wigner.html">unreasonable effectiveness of mathematics</a>. I'll mention just three of the many ways that people have applied eigenanalysis (or closely related ideas) to speech and language.
                            </p>
                            <p>
                                The first one goes under the name of "<a href="http://en.wikipedia.org/wiki/Latent_semantic_indexing">latent semantic indexing</a>" or "<a href="http://en.wikipedia.org/wiki/Latent_semantic_analysis">latent semantic analysis</a>". In this approach, rather than finding a useful low-dimensional approximation to pictures, we find a useful low-dimensional approximation to documents (and also to words, which are, after all, just one-word documents). The details are somewhat different, involving <a href="http://en.wikipedia.org/wiki/Singular_value_decomposition">singular value decomposition</a>, which is a generalization of eigendecomposition to non-square matrices, but the basic idea is the same. You can follow the links to learn more.
                            </p>
                            <p>
                                The second one is the application of "functional principal components analysis" to tonal analysis.  A number of people have tried a number of different ways to approach this in recent years. One interesting example is John A. D. Aston et al., "<a href="http://www2.warwick.ac.uk/fac/sci/statistics/staff/academic/aston/papers/astonchiouevans.pdf">Linguistic pitch analysis using functional principal component mixed effect models</a>", <em>J.  Royal Stat. Soc.: C</em>, 59 (2): 297–317, 2010.
                            </p>
                            <p>
                                I've given some examples of how to apply these ideas to a database of Chinese sentences (taken from Jiahong Yuan's thesis data),  in the background of a problem set found <a href="http://ling.upenn.edu/courses/cogs501/FDA_HW2.html">here</a>. You can access the details — include data and code — in the linked page, but I'll give a taste of the results here, in the form of some fragments of Octave (or Matlab) code and a couple of graphs.
                            </p>
                            <p>
                                Despite enormous variation by speaker, by phrasal position, by tonal context, and by stress or focus status, the mean contours by tone-class are surprisingly well behaved. (In the code below, the variable f0data1 has 7101 rows (different syllables) and 30 columns (the time-normalized pitch values in each syllable); the variable f0inds1 has the same 7101 rows and its columns give the values of various features of each syllable, with the 10th column being the tone class.)
                            </p>
                            <pre>
tonemeans=zeros(4, 30);
for tone=1:4
tonemeans(tone,:) = mean(f0data1(f0inds1(:,10)==tone,:));
end
plot(tonemeans')
legend(' 1',' 2',' 3',' 4','location','northwest')
</pre>
                            <p>
                                <a href="http://ling.upenn.edu/courses/Fall_2010/cogs501/FDA_HW2b.png"><img title="Click to embiggen" src="http://ling.upenn.edu/courses/Fall_2010/cogs501/FDA_HW2b.png" alt="" width="475"></a>
                            </p>
                            <p>
                                The first few eigenvectors of the covariance matrix look very much like orthogonal polynomials:
                            </p>
                            <pre>
[V L] = eig(cov(f0data1));
% Note that eigenvectors are in columns of V
%  with eigenvalues ordered from smallest to largest
basis5 = V(:,30:-1:26)';
figure(1); plot(basis5'); title('Five eigenvectors')
</pre>
                            <p>
                                <a href="http://ling.upenn.edu/courses/Fall_2010/cogs501/FDA_HW2d.png"><img title="Click to embiggen" src="http://ling.upenn.edu/courses/Fall_2010/cogs501/FDA_HW2d.png" alt="" width="475"></a>
                            </p>
                            <p>
                                We will find that these five eigenvectors do quite a good job of approximating (a sample of) the original contours:
                            </p>
                            <pre>
for n=1:6
coeffs = basis5'\f0sample(n,:)';
synth = basis5'*coeffs;
subplot(2,3,n);
plot(1:30,f0sample(n,:),'b',1:30,synth,'r');
end
</pre>
                            <p>
                                <a href="http://ling.upenn.edu/courses/Fall_2010/cogs501/FDA_HW2e.png"><img title="Click to embiggen" src="http://ling.upenn.edu/courses/Fall_2010/cogs501/FDA_HW2e.png" alt="" width="475"></a>
                            </p>
                            <p>
                                Four components do nearly as good a job; three is still OK, and a two-eigentone representation is marginal. A representation in terms of the just the first eigentone would be just a slightly bent line (the first eigenvector, which is the roughly horizonal blue line in the <a href="http://ling.upenn.edu/courses/Fall_2010/cogs501/FDA_HW2d.png">picture</a> above) moved up and down according to its coefficient. Adding the second eigentone (the falling dark-green line in that picture) lets us represent different degrees of overall rise fall; and so on.
                            </p>
                            <p>
                                The last of my three samples of eigenlinguistics takes us into the area of <a href="http://en.wikipedia.org/wiki/Spectral_graph_theory">spectral graph theory</a>, which as wikipedia tells us is not the latest development from Ghostbusters' Laboratories, but rather
                            </p>
                            <p style="padding-left:30px">
                                <span style="color:#800000">… is the study of properties of a graph in relationship to the characteristic polynomial, eigenvalues, and eigenvectors of matrices associated to the graph, such as its adjacency matrix or Laplacian matrix.</span>
                            </p>
                            <p>
                                Most of what little I know about this area I learned from <a href="http://languagelog.ldc.upenn.edu/nll/?p=2703">Partha Niyogi</a>, who <a href="http://scholar.google.com/scholar?&amp;q=Partha%20niyogi%20spectral%20graph">used such ideas extensively in various areas of machine learning</a>, including in an <a href="http://www.mit.edu/~har/pnastmpl.pdf">effort</a> to add some mathematical substance to an idea of mine about the development of lexical consensus in a speech community.  But the particular case that I'm going to cite here comes from Cleve Moler and Donald Morrison, "<a href="http://languagelog.ldc.upenn.edu/myl/Moler1983.pdf">Singular Value Decomposition of Cryptograms</a>", <em>American Mathematical Monthly</em>, 1983.
                            </p>
                            <p>
                                In this case, we're using singular value decomposition to find some simple approximations to the bigram statistics of the letters in (a collection of) documents, with the goal of figuring out which letters are vowels and which are consonants. The first singular vectors tell us something about the overall frequency of individual letters, in somewhat the same way as the first eigenvector of the syllabic pitch contours told us something about the overall pitch level. Because vowels and consonants tend to alternate, in a statistical sense, Moler and Morrison explain that
                            </p>
                            <p>
                                <a href="http://languagelog.ldc.upenn.edu/myl/MolerText1.png"><img title="Click to embiggen" src="http://languagelog.ldc.upenn.edu/myl/MolerText1.png" alt="" width="475"></a><br>
                                <a href="http://languagelog.ldc.upenn.edu/myl/MolerText2.png"><img title="Click to embiggen" src="http://languagelog.ldc.upenn.edu/myl/MolerText2.png" alt="" width="475"></a>
                            </p>
                            <p>
                                where "the cryptanalyst's problem" here is just to distinguish vowels from consonants in a simple substitution cipher (a really easy problem for a cryptanalyst to have, but still…).
                            </p>
                            <p>
                                A sample application of this idea to the <a href="http://languagelog.ldc.upenn.edu/myl/constitution.txt">text of the U.S. constitution</a> works reasonably well. For simplicity, we <a href="http://languagelog.ldc.upenn.edu/myl/cbigram27.c">map</a> all alphabetic characters to uppercase, and all punctuation and white-space characters to space, yielding <a href="http://languagelog.ldc.upenn.edu/myl/constitution27.out">this 27×27 bigram frequency table</a>. Then <a href="http://languagelog.ldc.upenn.edu/myl/Moler27.R">a few lines of R</a> are sufficient to yield this diagnosis, which does indeed separate vowels from consonants:
                            </p>
                            <p>
                                <a href="http://languagelog.ldc.upenn.edu/myl/Moler1.png"><img title="Click to embiggen" src="http://languagelog.ldc.upenn.edu/myl/Moler1.png" alt="" width="475"></a>
                            </p>
                            <p>
                                Vowels:<br>
                                [1,] "-0.27″ "0.161″ "A"<br>
                                [2,] "-0.304″ "0.624″ "E"<br>
                                [3,] "-0.201″ "0.207″ "I"<br>
                                [4,] "-0.263″ "0.07″ "O"<br>
                                [5,] "-0.09″ "0.013″ "U"
                            </p>
                            <p>
                                Consonants:<br>
                                [1,] "0.129″ "-0.053″ "B"<br>
                                [2,] "0.143″ "-0.124″ "C"<br>
                                [3,] "0.071″ "-0.103″ "D"<br>
                                [4,] "0.011″ "-0.126″ "F"<br>
                                [5,] "0.018″ "-0.03″ "G"<br>
                                [6,] "0.007″ "-0.005″ "J"<br>
                                [7,] "0.014″ "-0.005″ "K"<br>
                                [8,] "0.046″ "-0.1″ "L"<br>
                                [9,] "0.099″ "-0.057″ "M"<br>
                                [10,] "0.02″ "-0.056″ "P"<br>
                                [11,] "0″ "-0.006″ "Q"<br>
                                [12,] "0.183″ "-0.194″ "R"<br>
                                [13,] "0.188″ "-0.195″ "S"<br>
                                [14,] "0.603″ "-0.216″ "T"<br>
                                [15,] "0.116″ "-0.05″ "V"<br>
                                [16,] "0.061″ "-0.018″ "W"<br>
                                [17,] "0.008″ "-0.019″ "X"<br>
                                [18,] "0.008″ "-0.003″ "Z"
                            </p>
                            <p>
                                Neutrals:<br>
                                [1,] "0.432″ "0.466″ "H"<br>
                                [2,] "-0.032″ "-0.36″ "N"<br>
                                [3,] "0.002″ "0.014″ "Y"<br>
                                [4,] "-0.155″ "-0.052″ "_"
                            </p>
                            <p>
                                For a more extensive, more accessible (and more linguistic) discussion of graph partioning and spectral graph theory as applied to quasi-phonological analysis, see John Goldsmith and Aris Xanthos, "<a href="http://www.cs.uchicago.edu/research/publications/techreports/TR-2008-08">Three methods for learning phonological categories</a>", University of Chicago Department of Computer Science TR-2008-08.
                            </p>
                        </blockquote>
                    </div>
                    <p class="bookmark-source">
                        Source: <a href="http://languagelog.ldc.upenn.edu/nll/?p=3030">http://languagelog.ldc.upenn.edu/nll/?p=3030</a>
                    </p>
                </div>
            </article>

            <nav id="post-nav">


            </nav>

            <script id="discus-javascript">
                var disqus_shortname = 'improbable';

                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
                    document.getElementsByTagName('body')[0].appendChild(dsq);
                })();
            </script>

            <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            <div id="disqus_thread"></div>
        </section>

        <footer id="site-footer" class="nocontent">
            <p>
                This site is purely my personal work and does not reflect the views of my employer.
            </p>
            <p class="license">
                <a class="icon" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a>
                This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
            </p>
        </footer>

        <script async src="/static/js/common.js"></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js" integrity="sha256-hj+5FRlAuvAFANiefn0PpJYCkV1X4QT9EgiPd+6QnCw=" crossorigin="anonymous"></script>
    </body>
</html>
