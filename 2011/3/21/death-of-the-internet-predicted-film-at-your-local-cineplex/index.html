<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Death of the Internet predicted, film at your local cineplex</title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="/static/css/main.min.css" type="text/css" media="all">
        <!--[if lte IE 8]>
            <link rel="stylesheet" href="/static/css/ie-fixes.css" type="text/css" media="all">
            <script src="/static/js/html5shiv.js"></script>
        <![endif]-->

        <meta http-equiv="last-modified" content="Mon, 21 Mar 2011 13:51:37 GMT">
        <link rel="alternate" type="application/atom+xml" title="All Posts (Atom)" href="/feeds/all.atom">
        <link rel="alternate" type="application/rss+xml" title="All Posts (RSS)" href="/feeds/all.rss">
        <link rel="icon" type="image/jpeg" sizes="287x287" href="/static/img/favicon-287x287.jpg">
        <link rel="icon" type="image/jpeg" sizes="128x128" href="/static/img/favicon-128x128.jpg">
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-2097834-1', 'auto');
            ga('send', 'pageview');
        </script>
    </head>
    <body class="blog post_detail" itemscope itemtype="http://schema.org/BlogPosting">
        <nav id="site-nav">
            <header id="about">
                <h1><a href="/about/">Chris Adams</a></h1>
                <h2>Programmer, cyclist, photographer</h2>
            </header>
            <ul class="links">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li>
                    <a href="/feeds/all.atom" title="Site Feed">Site Feed</a>
                </li>
            </ul>
            <ul class="social-networks">
                <li>
                    <a href="https://github.com/acdha" rel="me">Github</a>
                </li>
                <li>
                    <a href="https://bitbucket.org/acdha" rel="me">Bitbucket</a>
                </li>
                <li>
                    <a href="https://pinboard.in/u:acdha/" rel="me">Pinboard</a>
                </li>
                <li>
                    <a href="https://twitter.com/acdha" rel="me">Twitter</a>
                </li>
                <li>
                    <a href="https://www.flickr.com/photos/acdha" rel="me">Flickr</a>
                </li>
                <li>
                    <a href="https://www.linkedin.com/in/acdha" rel="me">LinkedIn</a>
                </li>
            </ul>
            <div id="site-search"></div>
        </nav>
        <section id="main">
            <article class="post">
                <header>
                    <meta itemprop="dateCreated" content="2011-03-21T09:51:37-04:00">
                    <meta itemprop="dateModified" content="2011-03-21T09:51:37-04:00">
                    <time class="date" itemprop="datePublished" datetime="2011-03-21T13:51:37+00:00">Mar 21</time>
                    <h2 class="" itemprop="title">Death of the Internet predicted, film at your local cineplex</h2>
                </header>

                <div class="body" itemprop="articleBody"><div class="googlereader description" data-google-id="tag:google.com,2005:reader/item/52b011f47af56244">
                        <p class="annotation">
                            Not horrible coverage of a research paper but it overstates the bell-head understanding of separation of control by about 90 years (they only got religion in the late 80s-early 90s) and it's not clear that carriers have no traffic prioritization or separation - I've gotten the opposite impression over the years based on comments from the security community. Still, it wouldn't be the first time an obvious problem was ignored.
                        </p>
                        <blockquote>
                            <a href="http://arstechnica.com/tech-policy/news/2011/03/death-of-the-internet-predicted-film-at-your-local-cineplex.ars?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=rss"><img vspace="4" hspace="4" border="0" align="right" width="230" height="129" src="http://static.arstechnica.net/assets/2011/03/death-of-internet-ars-thumb-230x130-20447-f.jpg"></a>
                            <p>
                                A scary story about the demise of the Internet has been making the rounds through the social networking echo chamber lately. It's a paper by five researchers from the University of Michigan and one from Kansas State University (actually only a poster was published). The title is ominous: "Losing Control of the Internet: Using the Data Plane to Attack the Control Plane." Like any good thriller, it has an iconic villain but plot holes large enough to drive a <a href="http://www.flickr.com/photos/ciscosp360/5333452207/">Cisco Carrier Routing System</a> through—if the CRS had wheels. But despite that, it may very well be based on a true story.
                            </p>
                            <p>
                                The backstory is <a href="http://www.wired.com/wired/archive/4.10/atm.html">the epic war</a> between bellheads and netheads. The bellheads have been running telephone networks for 125 years, and are well-aware that you must always keep your data and control planes separate. The data plane is the network that we users get to send our packets over. The control plane makes sure the data plane works, by running routing protocols and doing management. Of course, these functions also need to exchange data.
                            </p>
                            <p>
                                Bellhead standard operating procedure is to exchange this control plane data to its own connections that are completely separate from regular (data) network links. The netheads, on the other hand, firmly believe in "fate sharing," where the control messages and the data packets flow over the same connections, so if one works, the other does too, and vice versa.
                            </p>
                            <p>
                                There's just one little problem with that: if the data plane gets overloaded to the point that packets start to get "dropped," control plane packets, which share the same connections, also get lost. Earlier work shows that it's possible to disrupt the <a href="http://arstechnica.com/tech-policy/news/2010/11/understanding-the-internets-insecure-routing-infrastructure.ars">BGP routing protocol</a> that ISPs depend on to make traffic find its way across the Internet, just by sending regular traffic. Granted, it takes a lot of regular traffic, but not quite so much that the traffic levels immediately look suspicious. The authors of this this original paper write: "Fortunately, major peering links with significant available bandwidth are difficult to attack due to required resources." Famous last words.
                            </p>
                            <p>
                                But our intrepid security researchers from Michigan and Kansas follow up this little indie release with a bigger and badder sequel that's aimed squarely at the blockbuster summer audience. They start by adding a botnet that analyzes the Internet's structure, and then relentlessly aim an amplified attack at the most vulnerable parts of the Internet's core infrastructure.
                            </p>
                            <p>
                                I have to give them credit for not skimping on the bandwidth—you wouldn't believe how much research <em>still</em> looks at 11Mbps 802.11<strong>b</strong>. "[W]e use OC-768 size links, the largest link size currently in the SONET standard." For those who failed (or avoided) optical networking 101, an OC is worth almost 52Mb per second. So an OC-768 connection weighs in at 40Gb per second. The bots that make up the botnet are assumed to have 1Mbps upload capacity.
                            </p>
                            <p>
                                The researchers have the botnets perform traceroutes and then use a couple of simple equations to find the links in the core of the Internet that are used between the largest number of source-destination combinations. They then send traffic from one bot to another in such a way that it passes through the target link. Because the destination of the packets is a valid and willing recipient, and each bot only sends a megabit or so, this doesn't look suspicious at first—or even second—glance. But when some 40,000 bots all do this at the same time, it overloads the link in question, which then begins to drop packets. Including BGP packets.
                            </p>
                            <p>
                                And BGP normally wants to make sure that its fellow routers are still there, so it expects to see a packet every 90 to 180 seconds. Without such "keepalive" packets, BGP terminates its connection and throws away all the routing information from the now-disconnected neighbor. It then has to go through a list of up to 350,000 different "prefixes" (address ranges) in its routing tables and find alternate paths for the affected ones, updating its other BGP neighbors where appropriate. These in turn have to adjust <em>their</em> routing decisions and update <em>their</em> neighbors. This can go on for a while.
                            </p>
                            <p>
                                The authors claim that with a botnet of 250,000 bots they can pretty much stop the Internet dead in its tracks by building up more than an hour of backlogged route calculations for routers in the core of the network. I think they're right that it's possible to disrupt BGP sessions on a relatively large scale in this way, and that would be bad.
                            </p>
                            <p>
                                But now the plot holes. All of this work is done through simulations, but how these are performed is not explained. I'm especially interested in the model of BGP update propagation these researchers used. It seems they think every update is propagated everywhere, and updates are queued in unlimited quantities. I'm very sure the former is not true: although routers sometimes propagate updates that don't contain new information, they usually suppress those. And I'm confident that the latter isn't, either, if only because routers do all their processing in RAM, which isn't infinite.
                            </p>
                            <p>
                                Also, it takes 40,000 bots to saturate one 40Gbps link. Even assuming a good deal of background traffic, that still means no more than a dozen or so links can be targeted at the same time. And once the attack starts being successful, what happens to the botnet? Remember that this attack requires a high degree of coordination. An attack like this would seem to have significant self-limiting properties.
                            </p>
                            <p>
                                Still, it would be good if we could remove the vulnerabilities that make such attacks theoretically possible in the first place. The best solution is to give control messages such as BGP updates a higher priority than normal traffic. To some degree, current routers can already do this, but it would be good if they did so out of the box under all circumstances. 
                            </p>
                            <p>
                                A pragmatic solution that the authors suggest is to disable BGP's keepalive mechanism. That way, the BGP session stays up no matter what. Of course there is a reason this mechanism exists: you really don't want to send your packets into a dead link or toward a dead router. But in many cases (certainly not always) it's possible to see when a link goes down without keepalives. In these cases, it would be possible to disable keepalives or at least make the time before a session is disconnected for lack of them a good deal longer. If only 10 percent of all ISPs disable keepalives, the attack no longer works. And we'd have a happy ending, in good Hollywood tradition.
                            </p>
                            <p>
                                <em>ACM CCS '10</em>, 2010. DOI: <a href="http://dx.doi.org/10.1145/1866307.1866411">10.1145/1866307.1866411</a> (<a href="http://arstechnica.com/science/news/2010/03/dois-and-their-discontents-1.ars">About DOIs</a>).
                            </p>
                            <p>
                                <a href="http://arstechnica.com/tech-policy/news/2011/03/death-of-the-internet-predicted-film-at-your-local-cineplex.ars?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=rss&amp;comments=1#comments-bar">Read the comments on this post</a>
                            </p>
                        </blockquote>
                    </div>
                    <p class="bookmark-source">
                        Source: <a href="http://arstechnica.com/tech-policy/news/2011/03/death-of-the-internet-predicted-film-at-your-local-cineplex.ars?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=rss">http://arstechnica.com/tech-policy/news/2011/03/death-of-the-internet-predicted-film-at-your-local-cineplex.ars?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=rss</a>
                    </p>
                </div>
            </article>

            <nav id="post-nav">


            </nav>

            <script id="discus-javascript">
                var disqus_shortname = 'improbable';

                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
                    document.getElementsByTagName('body')[0].appendChild(dsq);
                })();
            </script>

            <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            <div id="disqus_thread"></div>
        </section>

        <footer id="site-footer" class="nocontent">
            <p>
                This site is purely my personal work and does not reflect the views of my employer.
            </p>
            <p class="license">
                <a class="icon" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a>
                This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
            </p>
        </footer>

        <script async src="/static/js/common.js"></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js" integrity="sha256-hj+5FRlAuvAFANiefn0PpJYCkV1X4QT9EgiPd+6QnCw=" crossorigin="anonymous"></script>
    </body>
</html>
