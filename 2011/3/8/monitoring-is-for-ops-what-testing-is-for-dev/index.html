<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>
            Monitoring is for ops what testing is for dev
        </title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="/static/css/main.min.css" type="text/css" media="all"><!--[if lte IE 8]>
            <link rel="stylesheet" href="/static/css/ie-fixes.css" type="text/css" media="all">
            <script src="/static/js/html5shiv.js"></script>
        <![endif]-->
        <meta http-equiv="last-modified" content="Wed, 09 Mar 2011 00:34:49 GMT">
        <link rel="alternate" type="application/atom+xml" title="All Posts (Atom)" href="/feeds/all.atom">
        <link rel="alternate" type="application/rss+xml" title="All Posts (RSS)" href="/feeds/all.rss">
        <link rel="icon" type="image/jpeg" sizes="287x287" href="/static/img/favicon-287x287.jpg">
        <link rel="icon" type="image/jpeg" sizes="128x128" href="/static/img/favicon-128x128.jpg">
        <script type="application/javascript">
var _prum={id:"5166be01e6e53d1007000001"};var PRUM_EPISODES=PRUM_EPISODES||{};PRUM_EPISODES.q=[];PRUM_EPISODES.mark=function(b,a){PRUM_EPISODES.q.push(["mark",b,a||new Date().getTime()])};PRUM_EPISODES.measure=function(b,a,b){PRUM_EPISODES.q.push(["measure",b,a,b||new Date().getTime()])};PRUM_EPISODES.done=function(a){PRUM_EPISODES.q.push(["done",a])};PRUM_EPISODES.mark("firstbyte");(function(){var b=document.getElementsByTagName("script")[0];var a=document.createElement("script");a.type="text/javascript";a.async=true;a.charset="UTF-8";a.src="//rum-static.pingdom.net/prum.min.js";b.parentNode.insertBefore(a,b)})();
        </script>
    </head>
    <body class="blog post_detail" itemscope itemtype="http://schema.org/BlogPosting">
        <nav id="site-nav">
            <header id="about">
                <h1>
                    <a href="/about/">Chris Adams</a>
                </h1>
                <h2>
                    Programmer, cyclist, photographer
                </h2>
            </header>
            <ul class="links">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li>
                    <a href="/feeds/all.atom" title="Site Feed">Site Feed</a>
                </li>
            </ul>
            <ul class="social-networks">
                <li>
                    <a href="https://github.com/acdha" rel="me">Github</a>
                </li>
                <li>
                    <a href="http://bitbucket.org/acdha" rel="me">Bitbucket</a>
                </li>
                <li>
                    <a href="http://delicious.com/acdha" rel="me">del.icio.us</a>
                </li>
                <li>
                    <a href="http://twitter.com/acdha" rel="me">Twitter</a>
                </li>
                <li>
                    <a href="https://plus.google.com/116562742092842686896?rel=author" rel="me">Google+</a>
                </li>
                <li>
                    <a href="http://www.flickr.com/photos/acdha" rel="me">Flickr</a>
                </li>
                <li>
                    <a href="http://www.linkedin.com/in/acdha" rel="me">LinkedIn</a>
                </li>
                <li>
                    <a href="http://connect.garmin.com/explore?owner=acdha" rel="me">Garmin Connect</a>
                </li>
            </ul>
            <div id="site-search"></div>
        </nav>
        <section id="main">
            <article class="post">
                <header>
                    <meta itemprop="dateCreated" content="2011-03-08T19:34:00-04:00">
                    <meta itemprop="dateModified" content="2011-03-08T19:34:00-04:00"><time class="date" itemprop="datePublished" datetime="2011-03-08T23:34:00+00:00">Mar 08</time>
                    <h2 itemprop="title">
                        Monitoring is for ops what testing is for dev
                    </h2>
                </header>
                <div class="body" itemprop="articleBody">
                    <div class="googlereader description" data-google-id="tag:google.com,2005:reader/item/d867b728fd708b42">
                        <blockquote>
                            Devops. It's the new buzzword. Go to any tech conference these days and you're sure to find an expert panel on the 'what' and 'why' of devops. These panels tend to be light on the 'how', because that's where the rubber meets the road. I tried to give a step-by-step description of how you can become a Ninja Rockstar Internet Samurai devops in my blog post on '<a href="http://agiletesting.blogspot.com/2010/11/how-to-whip-your-infrastructure-into.html">How to whip your infrastructure into shape</a>'.<br>
                            <br>
                            Here I just want to say that I am struck by the parallels that exist between the activities of developer testing and operations monitoring. It's not a new idea by any means, but it's been growing on me recently.<br>
                            <br>
                            <b>Test-infected vs. monitoring-infected</b><br>
                            <br>
                            Good developers are test-infected. It doesn't matter too much whether they write tests before or after writing their code -- what matters is that they do write those tests as soon as possible, and that they don't consider their code 'done' until it has a comprehensive suite of tests. And of course test-infected developers are addicted to watching those dots in the output of their favorite test runner.<br>
                            <br>
                            Good ops engineers are monitoring-infected. They don't consider their infrastructure build-out 'done' until it has a comprehensive suite of monitoring checks, notifications and alerting rules, and also one or more dashboard-type systems that help them visualize the status of the resources in the infrastructure.<br>
                            <br>
                            <b>Adding tests vs. adding monitoring checks</b><br>
                            <br>
                            Whenever a bug is found, a good developer will add a unit test for it. It serves as a proof that the bug is now fixed, and also as a regression test for that bug.<br>
                            <br>
                            Whenever something unexpectedly breaks within the systems infrastructure, a good ops engineer will add a monitoring check for it, and if possible a graph showing metrics related to the resource that broke. This ensures that alerts will go out in a timely manner next time things break, and that correlations can be made by looking at the metrics graphs for the various resources involved.<br>
                            <br>
                            <b>Ignoring broken tests vs. ignoring monitoring alerts</b><br>
                            <br>
                            When a test starts failing, you can either fix it so that the bar goes green, or you can ignore it. Similarly, if a monitoring alert goes off, you can either fix the underlying issue, or you can ignore it by telling yourself it's not really critical.<br>
                            <br>
                            The problem with ignoring broken tests and monitoring alerts is that this attitude leads slowly but surely to the&nbsp;<a href="http://en.wikipedia.org/wiki/Broken_windows_theory">Broken Window Syndrome</a>. You train yourself to ignore issues that sooner or later will become critical (it's a matter of when, not if).<br>
                            <br>
                            A good developer will make sure there are no broken tests in their Continuous Integration system, and a good ops engineer will make sure all alerts are accounted for and the underlying issues fixed.<br>
                            <br>
                            <b>Improving test coverage vs. improving monitoring coverage</b><br>
                            <br>
                            Although 100% test coverage is not sufficient for your code to be bug-free, still, having something around 80-90% code coverage is a good measure that you as a developer are disciplined in writing those tests. This makes you sleep better at night and gives you pride in producing quality code.<br>
                            <br>
                            For ops engineers, sleeping better at night is definitely directly proportional to the quantity and quality of the monitors that are in place for their infrastructure. The more monitors, the better the chances that issues are caught early and fixed before they escalate into the dreaded 2 AM pager alert.<br>
                            <br>
                            <b>Measure and graph everything</b><br>
                            <br>
                            The more dashboards you have as a devops, the better insight you have into how your infrastructure behaves, from both a code and an operational point of view. I am inspired in this area by the work that's done at Etsy, where they are graphing every interesting metric they can think of (see their '<a href="http://codeascraft.etsy.com/2011/02/15/measure-anything-measure-everything/">Measure Anything, Measure Everything</a>' blog post).<br>
                            <br>
                            As a developer, you want to see your code coverage graphs showing decent values, close to that mythical 100%. As an ops engineer, you want to see uptime graphs that are close to the mythical 5 9's.<br>
                            <br>
                            But maybe even more importantly, you want insight into metrics that tie directly into your business. At Evite, processing messages and sending email reliably is our bread and butter, so we track those processes closely and we have dashboards for metrics related to them. Spikes, either up or down, are investigated quickly.<br>
                            <br>
                            Here are some examples of the dashboards we have. For now these use homegrown data collection tools and the <a href="http://code.google.com/apis/charttools/index.html">Google Visualization API</a>, but we're looking into using <a href="http://graphite.wikidot.com/">Graphite</a> soon.<br>
                            <br>
                            Outgoing email messages in the last hour (spiking at close to 100 messages/second):<br>
                            <br>
                            <br>
                            <div style="clear:both;text-align:center">
                                <a href="https://lh6.googleusercontent.com/-5AgRNYEl0_Q/TXbHjMh_jSI/AAAAAAAAACM/kwvoqlNe1Io/s1600/outgoing_email.png" style="margin-left:1em;margin-right:1em"><img border="0" height="246" src="https://lh6.googleusercontent.com/-5AgRNYEl0_Q/TXbHjMh_jSI/AAAAAAAAACM/kwvoqlNe1Io/s400/outgoing_email.png" width="400"></a>
                            </div>Size of various queues we use to process messages (using a homegrown queuing mechanism):<br>
                            <div style="clear:both;text-align:center">
                                <a href="https://lh3.googleusercontent.com/-vpZ2Ey1v5fY/TXbIJ3WBapI/AAAAAAAAACQ/CTCIoCHO3HA/s1600/queue_size.png" style="margin-left:1em;margin-right:1em"><img border="0" height="252" src="https://lh3.googleusercontent.com/-vpZ2Ey1v5fY/TXbIJ3WBapI/AAAAAAAAACQ/CTCIoCHO3HA/s400/queue_size.png" width="400"></a>
                            </div><br>
                            Percentage of errors across some of our servers:<br>
                            <br>
                            <div style="clear:both;text-align:center">
                                <a href="https://lh6.googleusercontent.com/-HfLeUCaT1c4/TXbJC9-U3GI/AAAAAAAAACU/CbSzuUHkRD0/s1600/prod_errors.png" style="margin-left:1em;margin-right:1em"><img border="0" height="286" src="https://lh6.googleusercontent.com/-HfLeUCaT1c4/TXbJC9-U3GI/AAAAAAAAACU/CbSzuUHkRD0/s400/prod_errors.png" width="400"></a>
                            </div><br>
                            <br>
                            Associated with these metrics we have Nagios alerts that fire when certain thresholds are being met. This combination allows our devops team to sleep better at night.
                            <div>
                                <img width="1" height="1" src="https://blogger.googleusercontent.com/tracker/9238405-3949762548813469757?l=agiletesting.blogspot.com" alt="">
                            </div>
                        </blockquote>
                    </div>
                    <p class="bookmark-source">
                        Source: <a href="http://agiletesting.blogspot.com/2011/03/monitoring-is-for-ops-what-testing-is.html">http://agiletesting.blogspot.com/2011/03/monitoring-is-for-ops-what-testing-is.html</a>
                    </p>
                </div>
            </article>
            <nav id="post-nav"></nav><script id="discus-javascript">
    var disqus_shortname = 'improbable';

                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    document.getElementsByTagName('body')[0].appendChild(dsq);
                })();
            </script><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            <div id="disqus_thread"></div>
        </section>
        <footer id="site-footer">
            <p>
                This site is purely my personal work and does not reflect the views of my employer.
            </p>
            <p class="license">
                <a class="icon" rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a> This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
            </p>
        </footer><script async="" defer src="/static/js/common.js">
</script><script id="google-analytics">
    var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-2097834-1']);
            _gaq.push(['_setDomainName', 'improbable.org']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
    </body>
</html>
