<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Unsmart Investments in Smartcards</title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="/static/css/main.min.css" type="text/css" media="all">
        <!--[if lte IE 8]>
            <link rel="stylesheet" href="/static/css/ie-fixes.css" type="text/css" media="all">
            <script src="/static/js/html5shiv.js"></script>
        <![endif]-->

        <meta http-equiv="last-modified" content="Wed, 29 Dec 2010 22:55:34 GMT">
        <link rel="alternate" type="application/atom+xml" title="All Posts (Atom)" href="/feeds/all.atom">
        <link rel="alternate" type="application/rss+xml" title="All Posts (RSS)" href="/feeds/all.rss">
        <link rel="icon" type="image/jpeg" sizes="287x287" href="/static/img/favicon-287x287.jpg">
        <link rel="icon" type="image/jpeg" sizes="128x128" href="/static/img/favicon-128x128.jpg">
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-2097834-1', 'auto');
            ga('send', 'pageview');
        </script>
    </head>
    <body class="blog post_detail" itemscope itemtype="http://schema.org/BlogPosting">
        <nav id="site-nav">
            <header id="about">
                <h1><a href="/about/">Chris Adams</a></h1>
                <h2>Programmer, cyclist, photographer</h2>
            </header>
            <ul class="links">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li>
                    <a href="/feeds/all.atom" title="Site Feed">Site Feed</a>
                </li>
            </ul>
            <ul class="social-networks">
                <li>
                    <a href="https://github.com/acdha" rel="me">Github</a>
                </li>
                <li>
                    <a href="https://bitbucket.org/acdha" rel="me">Bitbucket</a>
                </li>
                <li>
                    <a href="https://pinboard.in/u:acdha/" rel="me">Pinboard</a>
                </li>
                <li>
                    <a href="https://twitter.com/acdha" rel="me">Twitter</a>
                </li>
                <li>
                    <a href="https://www.flickr.com/photos/acdha" rel="me">Flickr</a>
                </li>
                <li>
                    <a href="https://www.linkedin.com/in/acdha" rel="me">LinkedIn</a>
                </li>
            </ul>
            <div id="site-search"></div>
        </nav>
        <section id="main">
            <article class="post">
                <header>
                    <meta itemprop="dateCreated" content="2010-12-29T17:55:34-04:00">
                    <meta itemprop="dateModified" content="2010-12-29T17:55:34-04:00">
                    <time class="date" itemprop="datePublished" datetime="2010-12-29T21:55:34+00:00">Dec 29</time>
                    <h2 class="" itemprop="title">Unsmart Investments in Smartcards</h2>
                </header>

                <div class="body" itemprop="articleBody"><div class="googlereader description" data-google-id="tag:google.com,2005:reader/item/cf649362efbcb82e">
                        <blockquote>
                            <p>
                                BERLIN — Let this be a lesson for companies implementing smartcard systems: If you don’t want people creating money from nothing, pay attention to the security research before investing.
                            </p>
                            <div style="width:310px">
                                <a rel="attachment wp-att-22400" href="http://www.wired.com/threatlevel/2010/12/unsmart-investments-in-smart-cards/800px-taipeieasycard/"><img title="800px-TaipeiEasyCard" src="http://www.wired.com/images_blogs/threatlevel/2010/12/800px-TaipeiEasyCard-300x214.jpg" alt="" width="300" height="214"></a>
                                <p>
                                    It wasn't supposed to be an ATM card. <em>Photo credit: sjschen</em>
                                </p>
                            </div>
                            <p>
                                Security consultant Harald Welte would be glad to say the same thing. Speaking at the annual <a href="http://events.ccc.de/congress/2010">Chaos Computer Club (CCC) Congress</a> here Wednesday, he explained how he was able to break Taiwan’s smartcard-based transportation-payment system, which was expanded this year to be a larger citywide payment system, using a $40 smartcard reader and a few hours of time.
                            </p>
                            <p>
                                “Using this in the year 2010 as a payment system is ignorant, clueless, and a sign of gross negligence,” he told the audience here.
                            </p>
                            <p>
                                Taipei’s EasyCard system has been in place since 2001, largely as a means of paying for the subway, bus, taxis and parking. It has also been widely known to use a smartcard system called MIFARE Classic, produced by <a href="http://www.mifare.net/technology/security/">NXP Semiconductors</a>, the security of which was publicly demonstrated to be broken by CCC members at their annual congress three years ago.
                            </p>
                            <p>
                                This break is no secret. It was publicized at the time, is noted on Wikipedia, and the issue was <a href="http://www.mifare.net/technology/security/mifare-classic/nxp-position-paper/">noted by NXP itself</a> on its Web site, which today says the MIFARE Classic offers “basic levels of data security.”
                            </p>
                            <p>
                                “We are actively cooperating with various universities to learn and to improve our products,” the company’s statement reads. “This fits into our mission to provide world-class products that contribute to optimal security and privacy.”
                            </p>
                            <p>
                                The problem, Welte said, was when the city government decided to adopt a broader card-based payment system for stores and other functions, and EasyCard stepped in with its old, now-broken technology.
                            </p>
                            <p>
                                According to Welte, researchers from the University of Taiwan wrote a letter protesting the decision, noting the security problems. But early in 2010, the EasyCard system was rolled out on a widespread basis, now upgraded to store the equivalent of nearly $350 in Taiwanese New Dollars, which was spendable at major department stores, 7-11s, Starbucks and other shops.
                            </p>
                            <p>
                                That’s where Welte got interested, He’s worked on RFID issues in the mid-2000s, and worked often enough in Taiwan to be familiar with the system, .
                            </p>
                            <p>
                                Welte knew the MIFARE system was weak. That isn’t necessarily a problem — if, say, someone tries to hack a $50 dollar card to read $500, but there’s a backend server verification check that says this card is only supposed to have $50, the problem is more or less solved.
                            </p>
                            <p>
                                He decided to test the system. The cards are encrypted with a 48-bit proprietary cipher called CRYPTO1. Many security professionals don’t think much of proprietary encryption, because it can’t go through the acid test of public testing — and indeed, this is part of what was broken several years ago.
                            </p>
                            <p>
                                With a $40 card reader and an open source program designed to break the encryption, Welte extracted a test card’s encryption keys in about three hours, he said. That allowed him to read the raw data in each sector of the card. This was initially incomprehensible, but after adding and spending money with the card, and watching what changed, he was able to understand how the card stored purchases, dates, points of sale and other information.
                            </p>
                            <p>
                                So he ran it through its paces. He bought a Starbucks drink, looked at the changes on the card, and manipulated it to look as though the drink had cost more than it had. Inserting the card into the main machines showed that he had successfully subtracted money, and that the card still functioned.
                            </p>
                            <p>
                                That meant no backend verification. A bad sign.
                            </p>
                            <p>
                                He tried <em>creating</em> money the same way, buying something and then reducing the purchase price, and boosting the stored value. Again, no problem with the official machine readers. Welte was careful to note that he afterward added real money to the card in the same amount, and then manipulated the value downward again. Thus, the correct amount of real money had actually been spent, and he wasn’t cheating the system, merely demonstrating how easy it would be to cheat.
                            </p>
                            <p>
                                A few more tests convinced him. The cards were easily manipulable, susceptible to a hack that could create money that could be spent in relatively large amounts all over town.
                            </p>
                            <p>
                                The city government and EasyCard know about the problem, he said. Taiwanese researchers have tried to warn them, and the research is publicly available online. The problem is companies trying to rely on “security through obscurity” — using proprietary but unsafe encryption — and trying to save money by not investing in solid security.
                            </p>
                            <p>
                                “It reminds me of 15 or 20 years ago, of manipulating saved game points on a PC,” he said. “It’s really not that different in this case, aside from the three-hour key crack.”
                            </p>
                            <p>
                                His advice to companies and other organizations investing in card technology in the future? Spend a bit more money, and use a stronger security algorithm. Implement verification procedures that will prevent cards from being manipulated so simply. And when designing systems that are to last many years, build in room for software updates, once the inevitable flaws have been found.
                            </p>
                            <p>
                                Otherwise there is risk of creating another accidental ATM card.
                            </p>
                            <div>
                                <a href="http://feeds.wired.com/~ff/wired27b?a=_JFPXYxhE7k:YmryzvPkP-I:cGdyc7Q-1BI"><img src="http://feeds.feedburner.com/~ff/wired27b?d=cGdyc7Q-1BI" border="0"></a> <a href="http://feeds.wired.com/~ff/wired27b?a=_JFPXYxhE7k:YmryzvPkP-I:V_sGLiPBpWU"><img src="http://feeds.feedburner.com/~ff/wired27b?i=_JFPXYxhE7k:YmryzvPkP-I:V_sGLiPBpWU" border="0"></a> <a href="http://feeds.wired.com/~ff/wired27b?a=_JFPXYxhE7k:YmryzvPkP-I:gIN9vFwOqvQ"><img src="http://feeds.feedburner.com/~ff/wired27b?i=_JFPXYxhE7k:YmryzvPkP-I:gIN9vFwOqvQ" border="0"></a> <a href="http://feeds.wired.com/~ff/wired27b?a=_JFPXYxhE7k:YmryzvPkP-I:yIl2AUoC8zA"><img src="http://feeds.feedburner.com/~ff/wired27b?d=yIl2AUoC8zA" border="0"></a>
                            </div>
                        </blockquote>
                    </div>
                    <p class="bookmark-source">
                        Source: <a href="http://feeds.wired.com/~r/wired27b/~3/_JFPXYxhE7k/">http://feeds.wired.com/~r/wired27b/~3/_JFPXYxhE7k/</a>
                    </p>
                </div>
            </article>

            <nav id="post-nav">


            </nav>

            <script id="discus-javascript">
                var disqus_shortname = 'improbable';

                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
                    document.getElementsByTagName('body')[0].appendChild(dsq);
                })();
            </script>

            <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            <div id="disqus_thread"></div>
        </section>

        <footer id="site-footer" class="nocontent">
            <p>
                This site is purely my personal work and does not reflect the views of my employer.
            </p>
            <p class="license">
                <a class="icon" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a>
                This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
            </p>
        </footer>

        <script async src="/static/js/common.js"></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js" integrity="sha256-hj+5FRlAuvAFANiefn0PpJYCkV1X4QT9EgiPd+6QnCw=" crossorigin="anonymous"></script>
    </body>
</html>
