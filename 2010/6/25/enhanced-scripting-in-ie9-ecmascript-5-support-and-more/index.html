<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Enhanced Scripting in IE9: ECMAScript 5 Support and More</title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="/static/css/main.min.css" type="text/css" media="all">
        <!--[if lte IE 8]>
            <link rel="stylesheet" href="/static/css/ie-fixes.css" type="text/css" media="all">
            <script src="/static/js/html5shiv.js"></script>
        <![endif]-->

        <meta http-equiv="last-modified" content="Fri, 25 Jun 2010 21:50:00 GMT">
        <link rel="alternate" type="application/atom+xml" title="All Posts (Atom)" href="/feeds/all.atom">
        <link rel="alternate" type="application/rss+xml" title="All Posts (RSS)" href="/feeds/all.rss">
        <link rel="icon" type="image/jpeg" sizes="287x287" href="/static/img/favicon-287x287.jpg">
        <link rel="icon" type="image/jpeg" sizes="128x128" href="/static/img/favicon-128x128.jpg">
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-2097834-1', 'auto');
            ga('send', 'pageview');
        </script>
    </head>
    <body class="blog post_detail" itemscope itemtype="http://schema.org/BlogPosting">
        <nav id="site-nav">
            <header id="about">
                <h1><a href="/about/">Chris Adams</a></h1>
                <h2>Programmer, cyclist, photographer</h2>
            </header>
            <ul class="links">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li>
                    <a href="/feeds/all.atom" title="Site Feed">Site Feed</a>
                </li>
            </ul>
            <ul class="social-networks">
                <li>
                    <a href="https://github.com/acdha" rel="me">Github</a>
                </li>
                <li>
                    <a href="https://bitbucket.org/acdha" rel="me">Bitbucket</a>
                </li>
                <li>
                    <a href="https://pinboard.in/u:acdha/" rel="me">Pinboard</a>
                </li>
                <li>
                    <a href="https://twitter.com/acdha" rel="me">Twitter</a>
                </li>
                <li>
                    <a href="https://www.flickr.com/photos/acdha" rel="me">Flickr</a>
                </li>
                <li>
                    <a href="https://www.linkedin.com/in/acdha" rel="me">LinkedIn</a>
                </li>
            </ul>
            <div id="site-search"></div>
        </nav>
        <section id="main">
            <article class="post">
                <header>
                    <meta itemprop="dateCreated" content="2010-06-25T17:50:00-04:00">
                    <meta itemprop="dateModified" content="2010-06-25T17:50:00-04:00">
                    <time class="date" itemprop="datePublished" datetime="2010-06-25T21:50:00+00:00">Jun 25</time>
                    <h2 class="" itemprop="title">Enhanced Scripting in IE9: ECMAScript 5 Support and More</h2>
                </header>

                <div class="body" itemprop="articleBody"><div class="googlereader description" data-google-id="tag:google.com,2005:reader/item/a653e0f860917abc">
                        <blockquote>
                            <p>
                                Up to this point we have mostly talked about <a href="http://blogs.msdn.com/b/ie/archive/2010/03/18/the-new-javascript-engine-in-internet-explorer-9.aspx">improved JavaScript performance</a> in Internet Explorer 9 but we haven’t said much about any new or changed language features in the <a href="http://blogs.msdn.com/b/ie/archive/2010/03/18/the-new-javascript-engine-in-internet-explorer-9.aspx">“Chakra”</a> engine. Now, with the third Platform Preview, we can tell you about JavaScript feature enhancements which you can <a href="http://ie.microsoft.com/testdrive/HTML5/ECMAScript5Array/Default.html">try for yourself</a>.
                            </p>
                            <p>
                                As context, the industry standard that defines the JavaScript language is <a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">ECMA-262: ECMAScript Language Specification</a> developed and published by <a href="http://www.ecma-international.org/">Ecma International</a>. Prior to last year, it had been a decade since the introduction of the <a href="http://www.ecma-international.org/publications/files/ECMA-ST-ARCH/ECMA-262,%203rd%20edition,%20December%201999.pdf">Third Edition of ECMA-262</a> in December 1999. In December 2009 Ecma approved the <a href="http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-262.pdf">Fifth Edition of ECMA-262</a> as the successor to the Third Edition (a Fourth Edition was never published), and last year we debuted elements of ECMAscript 5 (ES5) support when we added native <a href="http://blogs.msdn.com/ie/archive/2008/09/10/native-json-in-ie8.aspx">JSON support in IE8</a>. Beyond JSON, though, ES5 standardizes many significant enhancements to the JavaScript language.
                            </p>
                            <h4>
                                New ES5 Features in the IE9 Platform Preview
                            </h4>
                            <p>
                                There are many important ES5 features implemented in IE9 <a href="http://blogs.msdn.com/b/ie/archive/2010/06/16/ie-s-compatibility-features-for-site-developers.aspx">Standards Document mode</a>:
                            </p>
                            <p>
                                <b>New Array Methods.</b> There are nine new methods that operate upon arrays. Two of them, <code>indexOf</code> and <code>lastIndexOf</code>, support searching an array for a particular value. They are similar in concept to the functions with the same names that operate upon strings. The other seven new Array methods allow arrays to be manipulated using a functional programming style. For example, the following snippet uses the new <code>filter</code> method to collect the elements of an array that meet a specific condition:
                            </p>
                            <blockquote>
                                <p>
                                    <code>//a function that tests whether menu item object is enabled or disabled<br>
                                    function enabled(menuItem) {return menuItem.status==="enabled"};</code>
                                </p>
                                <p>
                                    <code>//Assume that individual menu items have a status property and<br>
                                    //that a menu object has a items property which is an array.<br>
                                    //Create an new array containing just the enabled menu items<br>
                                    var enabledItems=myMenu.items.filter(enabled);</code>
                                </p>
                            </blockquote>
                            <p>
                                These methods support various forms of array processing without having to explicitly code <code>for</code> loops. In addition, they are all generic, which means that they can be applied to any object with numerically indexed properties and not just objects created using the Array constructor. You can <a href="http://ie.microsoft.com/testdrive/HTML5/ECMAScript5Array/Default.html">explore demos</a> using these methods on the <a href="http://ie.microsoft.com/testdrive/">IE9 Test Drive</a> site and they are summarized in the following table:
                            </p>
                            <table>
                                <tbody>
                                    <tr>
                                        <td width="156" valign="top">
                                            <p>
                                                <b>Array method</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                <b>Description</b>
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="156" valign="top">
                                            <p>
                                                <b>indexOf</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Search an array for the first occurrence of some value
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="156" valign="top">
                                            <p>
                                                <b>lastIndexOf</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Search an array for the last occurrence of some value
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="156" valign="top">
                                            <p>
                                                <b>forEach</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Apply a function to each element of an array
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="156" valign="top">
                                            <p>
                                                <b>every</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Determine if some condition is true for every element of an array
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="156" valign="top">
                                            <p>
                                                <b>some</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Determine if some condition is true for at least one element of an array
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="156" valign="top">
                                            <p>
                                                <b>map</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Apply a function to each element of an array and produce a new array containing the results
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="156" valign="top">
                                            <p>
                                                <b>filter</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Collect into a new array all the elements of an array for which some condition is true.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="156" valign="top">
                                            <p>
                                                <b>reduce</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Accumulate a single value based upon all elements of an array.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="156" valign="top">
                                            <p>
                                                <b>reduceRight</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Accumulate a single value based upon all elements of an array, processing them in reverse order.
                                            </p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <p>
                                <b>Enhanced Object Model</b>. The most important new feature in this area is accessor properties. These are also sometimes called “getter/setter” properties because they allow JavaScript programmers to control what happens when the program gets or sets the property value. ES5’s enhanced object model also allows programmers to control whether individual properties can have their value changed, are enumerated by for-in statements, and whether or not the property can be deleted or redefined. It also allows the programmer to control whether new properties can be added to an object. ES5 also enables JavaScript programmers to more easily create objects that inherit from specific prototype object and to inspect and manipulate the property definitions of object. All of these enhanced object model capabilities are accessible via new function properties of the Object constructor. However, note that the current release of the IE9 platform preview does not yet fully support use of these methods with DOM objects.
                            </p>
                            <table>
                                <tbody>
                                    <tr>
                                        <td width="225" valign="top">
                                            <p>
                                                <b>Object function</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                <b>Description</b>
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="225" valign="top">
                                            <p>
                                                <b>Object.defineProperty</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Create or modify a property definition. The property can be defined as either a data or an accessor property and its <code>writable</code>, <code>enumerable</code>, and configurable property attributes can be set.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="225" valign="top">
                                            <p>
                                                <b>Object.defineProperties</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Create or modify multiple property definitions in a single operation.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="225" valign="top">
                                            <p>
                                                <b>Object.create</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Create a new object with a specified prototype and optionally a set of specified properties.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="225" valign="top">
                                            <p>
                                                <b>Object.getPrototypeOf</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Retrieve the prototype object of the argument object.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="225" valign="top">
                                            <p>
                                                <b>Object.getOwnPropertyDescriptor</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Return a complete description of the attributes of a property of an object.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="225" valign="top">
                                            <p>
                                                <b>Object.getOwnPropertyDescriptor</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Return an array containing the names of all of an object’s non-inherited properties.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="225" valign="top">
                                            <p>
                                                <b>Object.keys</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Return an array containing the names of all of an object’s non-inherited properties that would be iterated by the for-in statement.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="225" valign="top">
                                            <p>
                                                <b>Object.seal</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Disallow adding any additional properties to the argument object and disallow deletion or redefinition of any existing properties. Individual property values may still be modified if their <code>writable</code> attribute have the value <b>true</b>.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="225" valign="top">
                                            <p>
                                                <b>Object.freeze</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Disallow adding any additional properties to the argument object and disallow deletion or redefinition of any existing properties. In addition the values of existing property may not be modified.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="225" valign="top">
                                            <p>
                                                <b>Object.isSealed</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Test whether an object is has been sealed using Object.seal.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="225" valign="top">
                                            <p>
                                                <b>Object.isFrozen</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Test whether an object is has been frozen using Object.freeze.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="225" valign="top">
                                            <p>
                                                <b>Object.preventExtensions</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Disallow adding any additional properties to an object.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="225" valign="top">
                                            <p>
                                                <b>Object.isExtensible</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Test whether new properties may be added to an object.
                                            </p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <p>
                                <b>Other Computational Methods and Functions</b>. In addition to the new Array and Object methods, ES5 adds or enhances several additional methods that perform useful computational operations.
                            </p>
                            <table>
                                <tbody>
                                    <tr>
                                        <td width="156" valign="top">
                                            <p>
                                                <b>Method or Function</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                <b>Description</b>
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="156" valign="top">
                                            <p>
                                                <b>String trim</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Removes “white space” from the beginning and end of a string.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="156" valign="top">
                                            <p>
                                                <b>Date toISOString</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Convert a Date to a string format that all ES5 implementations must support.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="156" valign="top">
                                            <p>
                                                <b>Date.parse</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Existing function enhance to recognize the format create by toISOString.
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="156" valign="top">
                                            <p>
                                                <b>Date.now</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Return a numeric timestamp
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="156" valign="top">
                                            <p>
                                                <b>Array.isArray</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Reliably test whether an object is an Array
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="156" valign="top">
                                            <p>
                                                <b>Function bind</b>
                                            </p>
                                        </td>
                                        <td width="483" valign="top">
                                            <p>
                                                Preset some of the arguments of a function to fixed values.
                                            </p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <p>
                                ES5 also includes a number of other minor changes and technical corrections to the language. Many have no impact on most JavaScript programmers because they simply standardize minor features that have always been supported by browsers. An example of such a feature is line continuations within string literals. One minor change is of more interest. Reserved names such as <code>if</code>, <code>super</code>, and <code>public</code> can now be used as property names within object literals and for property access following a dot. With this change, programmers no longer need to worry about a long and arbitrary list of words that they can’t easily use as property names.
                            </p>
                            <p>
                                <b>“Same Script, Same Markup”</b>
                            </p>
                            <p>
                                Updating IE9’s JavaScript implementation isn’t just about supporting new ES5 features. It’s also about ensuring that web developers can use the same markup and script within IE9 that they use in other browsers. Earlier this year we <a href="http://blogs.msdn.com/ie/archive/2010/03/26/standards-documentation-for-ie7-and-ie8.aspx">released documents</a> that describe in detail how JavaScript as implemented in IE8 differs from the ECMAScript, Third Edition Specification. In IE9 standards mode, we looked closely at these differences and made changes to ensure that IE9 can execute the same script as other browsers.
                            </p>
                            <p>
                                 
                            </p>
                            <table>
                                <tbody>
                                    <tr>
                                        <td width="504" valign="top">
                                            <p>
                                                <b>Corrected Issue</b>
                                            </p>
                                        </td>
                                        <td width="744" valign="top">
                                            <p>
                                                <b>Example</b>
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="666" valign="top">
                                            <p>
                                                Function expressions were processed as if they were function declarations.
                                            </p>
                                        </td>
                                        <td width="870" valign="top">
                                            <p>
                                                <code>function f() {alert("declaration")};<br>
                                                obj.callback=function f() {alert("expression")};<br>
                                                f(); // IE8 incorrectly alerts "expression"</code>
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="715" valign="top">
                                            <p>
                                                Function names in function expressions were not locally defined within the function body.
                                            </p>
                                        </td>
                                        <td width="905" valign="top">
                                            <p>
                                                <code>var fact="the web is big";<br>
                                                Math.factorial=function fact(n)<br>
                                                    {return n&lt;=1?1:fact(n-1)};<br>
                                                alert(Math.factorial(9)); // IE8 throws an exception</code>
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="728" valign="top">
                                            <p>
                                                Catch clause parameters were visible in enclosing scope.
                                            </p>
                                        </td>
                                        <td width="914" valign="top">
                                            <p>
                                                <code>var e = "outer";<br>
                                                try {throw "inner"} catch(e) {};<br>
                                                alert(e); // IE8 incorrectly alerts "inner"</code>
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="731" valign="top">
                                            <p>
                                                In many cases the runtime exception thrown was different from what is specified in the standard
                                            </p>
                                        </td>
                                        <td width="916" valign="top">
                                            <p>
                                                <code>var obj; //obj has value undefined<br>
                                                try {alert(obj.prop)}<br>
                                                catch (e) {<br>
                                                    if (e instanceof ReferenceError) alert("correct")<br>
                                                    else if (e instanceof TypeError) alert("IE8 wrong")<br>
                                                    }</code>
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="732" valign="top">
                                            <p>
                                                Trailing commas in array literals added to the array’s length
                                            </p>
                                        </td>
                                        <td width="917" valign="top">
                                            <p>
                                                <code>var len = [1,2,3,].length;<br>
                                                alert(len); //should be 3, IE8 says 4</code>
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="732" valign="top">
                                            <p>
                                                Empty elements in array literals didn’t result in a sparse array
                                            </p>
                                        </td>
                                        <td width="917" valign="top">
                                            <p>
                                                <code>var a=[0,,2,,4];<br>
                                                alert(a.hasOwnProperty(1));//IE8 incorrectly says true</code>
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="732" valign="top">
                                            <p>
                                                The dontenum attribute was inherited by own properties
                                            </p>
                                        </td>
                                        <td width="917" valign="top">
                                            <p>
                                                <code>var obj={valueOf:0, toString:1,foo:2};<br>
                                                var n=0;<br>
                                                for (var p in obj) n++;<br>
                                                alert(n); // IE8 displays 1, should be 3</code>
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="732" valign="top">
                                            <p>
                                                \v was not recognized as an escape sequence for the vertical tab control characters
                                            </p>
                                        </td>
                                        <td width="917" valign="top">
                                            <p>
                                                <code>alert("\v"==="v");//IE8 said true, should be false<br>
                                                alert("\v"==="\u000b");<br>
                                                    //IE8 said false, should be true</code>
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="732" valign="top">
                                            <p>
                                                The global object didn’t inherit from Object.prototype
                                            </p>
                                        </td>
                                        <td width="917" valign="top">
                                            <p>
                                                <code>alert(hasOwnProperty===undefined);<br>
                                                    // IE8 incorrectly alerts true, should be false</code>
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="732" valign="top">
                                            <p>
                                                Unsatisfied capturing parentheses in regular expressions produce the empty string instead of undefined.
                                            </p>
                                        </td>
                                        <td width="917" valign="top">
                                            <p>
                                                <code>var x=/((a)|(ab))((c)|(bc))/.exec("abc");<br>
                                                // x should be:<br>
                                                //    ["abc","a","a",undefined, "bc",undefined, "bc"]<br>
                                                // IE8 produces: ["abc","a","a","","bc","","bc"]</code>
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="732" valign="top">
                                            <p>
                                                toFixed incorrectly rounds for certain ranges of values
                                            </p>
                                        </td>
                                        <td width="917" valign="top">
                                            <p>
                                                <code>alert((0.09).toFixed(1));<br>
                                                // Should display 0.1<br>
                                                // IE8 displays 0.0</code>
                                            </p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <p>
                                “Running the same script” isn’t just about what Internet Explorer can run. It’s also about making sure that the scripts you develop and test using IE will also run in any other standards conforming browser your users might be running. One type of issue that can interfere with this goal is unnecessary features that exist only on IE and no other browser. If a feature doesn’t provide any essential browser-specific functionality or unique value, is only implemented by a single browser, and is unlikely to ever become part of a Web standard then the existence of that feature becomes an interoperability hazard. If you inadvertently use such a feature in your script your users won’t be able to run it on any other browser.
                            </p>
                            <p>
                                Internet Explorer’s JavaScript implementation has historically had several features that fall into this category and we have eliminated them within IE9 Standards Mode. Generally, these are features that were conceived as usability enhancements in the earliest days of IE development. However, they were not adopted by other browsers and it is now clear that they will never be incorporated into the ECMAScript standard.
                            </p>
                            <p>
                                The first feature in this category is the elimination of the option to place a semi-colon after any code block. For example, IE has traditionally allowed an if statement to be coded like this:
                            </p>
                            <blockquote>
                                <p>
                                    <code>if (conditionMet) {performTrueAlternative()};<br>
                                    else {performFalseAlternative()};</code>
                                </p>
                            </blockquote>
                            <p>
                                Note the semi-colon at the end of the first line. The ECMAScript standard has never allowed a semi-colon to occur at that position. If you try to load a script containing these lines on any browser other than IE, a syntax error will be detected and the entire script will fail to load. The original motivation for this feature was to be liberal in what IE accepts for execution – to handle some syntax errors transparently. Unfortunately, being liberal in these situations causes interoperability issues when the script runs on other browsers. In situations like this, it is better to report the error so it can be corrected by the script developer.
                            </p>
                            <p>
                                IE has included several extensions to function declaration syntax. One extension allows function declarations to directly define method properties of objects. For example:
                            </p>
                            <p>
                                 
                            </p>
                            <blockquote>
                                <p>
                                    <code>function String.prototype.firstChar() {return this.substring(0,1)};</code>
                                </p>
                            </blockquote>
                            <p>
                                means the same thing as
                            </p>
                            <blockquote>
                                <p>
                                    <code>String.prototype.firstChar = function (){return this.substring(0,1)};</code>
                                </p>
                            </blockquote>
                            <p>
                                Another extension allowed a function declaration to define multiple names for a function. Such as:
                            </p>
                            <blockquote>
                                <p>
                                    <code>function declaration,dcl() {return processDeclaration)()};</code>
                                </p>
                            </blockquote>
                            <p>
                                which defines both a short name and a long name for the same function. Neither of these extensions adds any functionality that can’t already be expressed using standard features of the language, they are not part of the standard, and no other browser implements them so we are eliminating them in IE9 standards mode.
                            </p>
                            <p>
                                Note that this doesn’t mean we are removing all functionality that is unique to IE’s JavaScript implementation. Some features are essential for situations where a developer really does need to access some unique capability of Internet Explorer or Microsoft Windows. For example, the JavaScript features that support access to ActiveX objects fall into this category.
                            </p>
                            <p>
                                <b>Testing Our Progress</b>
                            </p>
                            <p>
                                A primary goal for IE9 is that the same markup can be used across browsers, which of course includes JavaScript code. So how do we know how we are progressing towards that goal? In another <a href="http://blogs.msdn.com/b/ie/archive/2010/06/25/javascript-same-code-and-a-standardized-test-suite.aspx">IEBlog post</a> we discussed Microsoft’s position regarding standardizing JavaScript test suites. We believe the organizations responsible for web standards should also publish a definitive test suite that ensures the same script and markup works in all browsers.  There is not yet a standard test suite for JavaScript. However, the ECMAScript standards committee has agreed to develop such a suite and we are working together with the other browser vendors who are <a href="http://www.ecma-international.org/memento/members.htm">Ecma members</a>.  That test suite is not yet complete or publically available.  In the interim, more than 1300 ES5 related tests that we use and will contribute to Ecma are available on the <a href="http://go.microsoft.com/?linkid=9721785">Internet Explorer Testing Center</a>. As a result of the support we added for ES5, IE9 now passes all sixteen of the <a href="http://ie.microsoft.com/testdrive/benchmarks/Acid3/Default.html">Acid3</a> tests in bucket 6 (JavaScript).
                            </p>
                            <p>
                                <b>Take It Out for a Test Drive</b>
                            </p>
                            <p>
                                We want your feedback. Let us know when you find JavaScript bugs. We are especially interested in interoperability issues. If you are using a standard JavaScript feature and it works differently on this Platform Preview in IE9 Standards Mode than in other browsers, you may have found a bug – report it on <a href="http://connect.microsoft.com/ie">Connect</a>. Because these changes only apply to IE9 Standards Mode documents, web sites running in IE9’s compatibility modes do not have these changes and continue to operate as they always have.
                            </p>
                            <p>
                                Finally, look very carefully at any existing code you have that does <a href="http://blogs.msdn.com/b/ie/archive/2010/06/10/same-markup-explaining-quot-jscript-version-quot-and-styling-new-html5-elements.aspx">browser detection</a> based upon known IE JavaScript differences or bugs, as these are likely to no longer work as expected in IE9 Standards Mode. This isn’t just the same old IE JavaScript.
                            </p>
                            <p>
                                Thanks
                            </p>
                            <p>
                                Allen Wirfs-Brock<br>
                                Microsoft JavaScript Language Architect
                            </p>
                            <div style="clear:both"></div><img src="http://blogs.msdn.com/aggbug.aspx?PostID=10029781" width="1" height="1">
                        </blockquote>
                    </div>
                    <p class="bookmark-source">
                        Source: <a href="http://blogs.msdn.com/b/ie/archive/2010/06/25/enhanced-scripting-in-ie9-ecmascript-5-support-and-more.aspx">http://blogs.msdn.com/b/ie/archive/2010/06/25/enhanced-scripting-in-ie9-ecmascript-5-support-and-more.aspx</a>
                    </p>
                </div>
            </article>

            <nav id="post-nav">


            </nav>

            <script id="discus-javascript">
                var disqus_shortname = 'improbable';

                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
                    document.getElementsByTagName('body')[0].appendChild(dsq);
                })();
            </script>

            <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            <div id="disqus_thread"></div>
        </section>

        <footer id="site-footer" class="nocontent">
            <p>
                This site is purely my personal work and does not reflect the views of my employer.
            </p>
            <p class="license">
                <a class="icon" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a>
                This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
            </p>
        </footer>

        <script async src="/static/js/common.js"></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js" integrity="sha256-hj+5FRlAuvAFANiefn0PpJYCkV1X4QT9EgiPd+6QnCw=" crossorigin="anonymous"></script>
    </body>
</html>
