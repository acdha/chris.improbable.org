<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>
            Exploiting remote timing attacks
        </title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="/static/css/main.min.css" type="text/css" media="all"><!--[if lte IE 8]>
            <link rel="stylesheet" href="/static/css/ie-fixes.css" type="text/css" media="all">
            <script src="/static/js/html5shiv.js"></script>
        <![endif]-->
        <meta http-equiv="last-modified" content="Mon, 19 Jul 2010 20:19:20 GMT">
        <link rel="alternate" type="application/atom+xml" title="All Posts (Atom)" href="/feeds/all.atom">
        <link rel="alternate" type="application/rss+xml" title="All Posts (RSS)" href="/feeds/all.rss">
        <link rel="icon" type="image/jpeg" sizes="287x287" href="/static/img/favicon-287x287.jpg">
        <link rel="icon" type="image/jpeg" sizes="128x128" href="/static/img/favicon-128x128.jpg">
        <script type="application/javascript">
var _prum={id:"5166be01e6e53d1007000001"};var PRUM_EPISODES=PRUM_EPISODES||{};PRUM_EPISODES.q=[];PRUM_EPISODES.mark=function(b,a){PRUM_EPISODES.q.push(["mark",b,a||new Date().getTime()])};PRUM_EPISODES.measure=function(b,a,b){PRUM_EPISODES.q.push(["measure",b,a,b||new Date().getTime()])};PRUM_EPISODES.done=function(a){PRUM_EPISODES.q.push(["done",a])};PRUM_EPISODES.mark("firstbyte");(function(){var b=document.getElementsByTagName("script")[0];var a=document.createElement("script");a.type="text/javascript";a.async=true;a.charset="UTF-8";a.src="//rum-static.pingdom.net/prum.min.js";b.parentNode.insertBefore(a,b)})();
        </script>
    </head>
    <body class="blog post_detail" itemscope itemtype="http://schema.org/BlogPosting">
        <nav id="site-nav">
            <header id="about">
                <h1>
                    <a href="/about/">Chris Adams</a>
                </h1>
                <h2>
                    Programmer, cyclist, photographer
                </h2>
            </header>
            <ul class="links">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li>
                    <a href="/feeds/all.atom" title="Site Feed">Site Feed</a>
                </li>
            </ul>
            <ul class="social-networks">
                <li>
                    <a href="https://github.com/acdha" rel="me">Github</a>
                </li>
                <li>
                    <a href="http://bitbucket.org/acdha" rel="me">Bitbucket</a>
                </li>
                <li>
                    <a href="http://delicious.com/acdha" rel="me">del.icio.us</a>
                </li>
                <li>
                    <a href="http://twitter.com/acdha" rel="me">Twitter</a>
                </li>
                <li>
                    <a href="https://plus.google.com/116562742092842686896?rel=author" rel="me">Google+</a>
                </li>
                <li>
                    <a href="http://www.flickr.com/photos/acdha" rel="me">Flickr</a>
                </li>
                <li>
                    <a href="http://www.linkedin.com/in/acdha" rel="me">LinkedIn</a>
                </li>
                <li>
                    <a href="http://connect.garmin.com/explore?owner=acdha" rel="me">Garmin Connect</a>
                </li>
            </ul>
            <div id="site-search"></div>
        </nav>
        <section id="main">
            <article class="post">
                <header>
                    <meta itemprop="dateCreated" content="2010-07-19T16:19:20-04:00">
                    <meta itemprop="dateModified" content="2010-07-19T16:19:20-04:00"><time class="date" itemprop="datePublished" datetime="2010-07-19T20:19:20+00:00">Jul 19</time>
                    <h2 itemprop="title">
                        Exploiting remote timing attacks
                    </h2>
                </header>
                <div class="body" itemprop="articleBody">
                    <div class="googlereader description" data-google-id="tag:google.com,2005:reader/item/a12d4c8fd489940a">
                        <blockquote>
                            <p>
                                We’ll be giving a <a href="https://www.blackhat.com/html/bh-us-10/bh-us-10-briefings.html#Lawson">Blackhat talk</a> on exploiting remote timing attacks. Our goal is to convince developers that this class of attack is exploitable and worth fixing. This <a href="http://www.computerworld.com/s/article/print/9179224/Researchers_Authentication_crack_could_affect_millions">article in Computer World</a> gives a decent background.
                            </p>
                            <p>
                                The attack is very simple. You repeatedly send guesses about a secret value to the server, which rejects them as incorrect. However, if your first byte of the guess is correct, it takes a very slightly longer time to return the error. With many measurements and some filtering, you can distinguish this difference.
                            </p>
                            <p>
                                While any comparison against a secret is a potential target, we chose HMAC comparison for a few reasons. An HMAC is a message authenticator, similar to a digital signature. The primary difference is that the the verifying party must keep the true HMAC secret since it gives the attacker the correct authenticator for their forged message. HMACs are used in many protocols, including most web authentication frameworks such as <a href="http://oauth.net/">OAuth</a> and <a href="http://openid.net/">OpenID</a> and HTTP session cookies.
                            </p>
                            <p>
                                Guessing the correct HMAC for an arbitrary message is game over for these authentication frameworks. The token grants access to resources or allows the attacker to assume a user’s identity on various websites.
                            </p>
                            <p>
                                This is not a new attack. <a href="http://crypto.stanford.edu/~dabo/abstracts/ssl-timing.html">Remote timing attacks on OpenSSL</a> were shown to be practical in 2003. Further <a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.65.9811">research in 2007</a> showed that differences as small as 20 microseconds over the Internet and 100 nanoseconds over the LAN could be distinguished with about 1000 samples.
                            </p>
                            <p>
                                We (and others) have been reporting these flaws for over a year and raising developer awareness. In 2009, we <a href="http://rdist.root.org/2009/05/28/timing-attack-in-google-keyczar-library/">found a timing leak in Google Keyczar</a>‘s HMAC verification that was quickly fixed. Coda Hale <a href="http://codahale.com/a-lesson-in-timing-attacks/">found a similar flaw</a> in Java’s MessageDigest implementation. The OAuth group <a href="http://groups.google.com/group/oauth/browse_thread/thread/a676f59fcbc9728b/37ba890b73bb8035">discussed his bug</a> back then and some maintainers decided to fix it in their code too. But many didn’t.
                            </p>
                            <p>
                                A quick review of OAuth and OpenID implementations showed many had timing leaks that were potentially exploitable. Either developers knew about the bug and gave it a low priority or they weren’t aware of it. Either way, we thought some concrete research was needed to show exactly how easy or hard it was to exploit these flaws in various environments.
                            </p>
                            <p>
                                Exploiting timing attacks depends on extracting a timing difference from many samples by filtering out the effect of noise. If there is too much noise (the difference is too small), this attack may take too long to be practical. But an attacker who can control the environment to decrease noise (say, by blocking competing users of the server), accurately model the noise and thus filter it better, or just wait longer because their target is so valuable might be successful.
                            </p>
                            <p>
                                Our talk builds most closely on the <a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.65.9811">Crosby 2007 paper</a> mentioned above. We have tested many configurations to find how different variables influence an attacker. The most obvious analysis is how small a time delta can be distinguished for a given number of samples. This was performed from various vantage points (guest-to-guest VM, LAN, Internet) and for various languages (C, Python, Ruby, Java, etc.)
                            </p>
                            <p>
                                We applied various filtering methods to the samples to see how much unfiltered jitter remained. This would determine how small a difference could be distinguished. We added in other variables such as competing load, power management, and other factors.
                            </p>
                            <p>
                                The talk will have the full results. Both the proponents and skeptics should be surprised in some way. We have found some configurations that are almost certainly not exploitable and others that certainly are. If you’re the maintainer of a software package, don’t count on your users being safe from timing attacks because of your assumptions. Cryptographic software, especially open-source, is deployed in everything from slow embedded servers on up to multi-Ghz clusters.
                            </p>
                            <p>
                                Likewise, attackers often have a better vantage point than you’d first assume. With shared hosting providers and cloud computing, you have to assume <a href="http://cseweb.ucsd.edu/~hovav/dist/cloudsec.pdf">attackers can locate themselves on the same host</a> as their target. Even in a shared datacenter, you may assume the attacker has a LAN-equivalent vantage point.
                            </p>
                            <p>
                                Given that it is difficult to rule out timing attacks and the fix is so simple, we think it’s best to fix them proactively. The approach that is easiest to gain assurance is to <a href="http://rdist.root.org/2010/01/07/timing-independent-array-comparison/">use a constant-time compare function</a>. (That post also gives reasons why other approaches don’t work or are too complicated to verify).
                            </p>
                            <p>
                                We hope our talk will give some concrete results so that more developers will take this flaw seriously. See you in Vegas!
                            </p><br>
                            <a rel="nofollow" href="http://feeds.wordpress.com/1.0/gocomments/rdist.wordpress.com/597/"><img alt="" border="0" src="http://feeds.wordpress.com/1.0/comments/rdist.wordpress.com/597/"></a> <a rel="nofollow" href="http://feeds.wordpress.com/1.0/godelicious/rdist.wordpress.com/597/"><img alt="" border="0" src="http://feeds.wordpress.com/1.0/delicious/rdist.wordpress.com/597/"></a> <a rel="nofollow" href="http://feeds.wordpress.com/1.0/gofacebook/rdist.wordpress.com/597/"><img alt="" border="0" src="http://feeds.wordpress.com/1.0/facebook/rdist.wordpress.com/597/"></a> <a rel="nofollow" href="http://feeds.wordpress.com/1.0/gotwitter/rdist.wordpress.com/597/"><img alt="" border="0" src="http://feeds.wordpress.com/1.0/twitter/rdist.wordpress.com/597/"></a> <a rel="nofollow" href="http://feeds.wordpress.com/1.0/gostumble/rdist.wordpress.com/597/"><img alt="" border="0" src="http://feeds.wordpress.com/1.0/stumble/rdist.wordpress.com/597/"></a> <a rel="nofollow" href="http://feeds.wordpress.com/1.0/godigg/rdist.wordpress.com/597/"><img alt="" border="0" src="http://feeds.wordpress.com/1.0/digg/rdist.wordpress.com/597/"></a> <a rel="nofollow" href="http://feeds.wordpress.com/1.0/goreddit/rdist.wordpress.com/597/"><img alt="" border="0" src="http://feeds.wordpress.com/1.0/reddit/rdist.wordpress.com/597/"></a> <img alt="" border="0" src="http://stats.wordpress.com/b.gif?host=rdist.root.org&amp;blog=893473&amp;post=597&amp;subd=rdist&amp;ref=&amp;feed=1" width="1" height="1">
                        </blockquote>
                    </div>
                    <p class="bookmark-source">
                        Source: <a href="http://rdist.root.org/2010/07/19/exploiting-remote-timing-attacks/">http://rdist.root.org/2010/07/19/exploiting-remote-timing-attacks/</a>
                    </p>
                </div>
            </article>
            <nav id="post-nav"></nav><script id="discus-javascript">
    var disqus_shortname = 'improbable';

                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    document.getElementsByTagName('body')[0].appendChild(dsq);
                })();
            </script><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            <div id="disqus_thread"></div>
        </section>
        <footer id="site-footer">
            <p>
                This site is purely my personal work and does not reflect the views of my employer.
            </p>
            <p class="license">
                <a class="icon" rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a> This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
            </p>
        </footer><script async="" defer src="/static/js/common.js">
</script><script id="google-analytics">
    var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-2097834-1']);
            _gaq.push(['_setDomainName', 'improbable.org']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
    </body>
</html>
