<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>
            PyvaScript - Pythonic syntax for your browser
        </title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="/static/css/main.min.css" type="text/css" media="all"><!--[if lte IE 8]>
            <link rel="stylesheet" href="/static/css/ie-fixes.css" type="text/css" media="all">
            <script src="/static/js/html5shiv.js"></script>
        <![endif]-->
        <meta http-equiv="last-modified" content="Fri, 30 Jul 2010 15:24:57 GMT">
        <link rel="alternate" type="application/atom+xml" title="All Posts (Atom)" href="/feeds/all.atom">
        <link rel="alternate" type="application/rss+xml" title="All Posts (RSS)" href="/feeds/all.rss">
        <link rel="icon" type="image/jpeg" sizes="287x287" href="/static/img/favicon-287x287.jpg">
        <link rel="icon" type="image/jpeg" sizes="128x128" href="/static/img/favicon-128x128.jpg">
        <script type="application/javascript">
var _prum={id:"5166be01e6e53d1007000001"};var PRUM_EPISODES=PRUM_EPISODES||{};PRUM_EPISODES.q=[];PRUM_EPISODES.mark=function(b,a){PRUM_EPISODES.q.push(["mark",b,a||new Date().getTime()])};PRUM_EPISODES.measure=function(b,a,b){PRUM_EPISODES.q.push(["measure",b,a,b||new Date().getTime()])};PRUM_EPISODES.done=function(a){PRUM_EPISODES.q.push(["done",a])};PRUM_EPISODES.mark("firstbyte");(function(){var b=document.getElementsByTagName("script")[0];var a=document.createElement("script");a.type="text/javascript";a.async=true;a.charset="UTF-8";a.src="//rum-static.pingdom.net/prum.min.js";b.parentNode.insertBefore(a,b)})();
        </script>
    </head>
    <body class="blog post_detail" itemscope itemtype="http://schema.org/BlogPosting">
        <nav id="site-nav">
            <header id="about">
                <h1>
                    <a href="/about/">Chris Adams</a>
                </h1>
                <h2>
                    Programmer, cyclist, photographer
                </h2>
            </header>
            <ul class="links">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li>
                    <a href="/feeds/all.atom" title="Site Feed">Site Feed</a>
                </li>
            </ul>
            <ul class="social-networks">
                <li>
                    <a href="https://github.com/acdha" rel="me">Github</a>
                </li>
                <li>
                    <a href="http://bitbucket.org/acdha" rel="me">Bitbucket</a>
                </li>
                <li>
                    <a href="http://delicious.com/acdha" rel="me">del.icio.us</a>
                </li>
                <li>
                    <a href="http://twitter.com/acdha" rel="me">Twitter</a>
                </li>
                <li>
                    <a href="https://plus.google.com/116562742092842686896?rel=author" rel="me">Google+</a>
                </li>
                <li>
                    <a href="http://www.flickr.com/photos/acdha" rel="me">Flickr</a>
                </li>
                <li>
                    <a href="http://www.linkedin.com/in/acdha" rel="me">LinkedIn</a>
                </li>
                <li>
                    <a href="http://connect.garmin.com/explore?owner=acdha" rel="me">Garmin Connect</a>
                </li>
            </ul>
            <div id="site-search"></div>
        </nav>
        <section id="main">
            <article class="post">
                <header>
                    <meta itemprop="dateCreated" content="2010-07-30T11:24:57-04:00">
                    <meta itemprop="dateModified" content="2010-07-30T11:24:57-04:00"><time class="date" itemprop="datePublished" datetime="2010-07-30T15:24:57+00:00">Jul 30</time>
                    <h2 itemprop="title">
                        PyvaScript - Pythonic syntax for your browser
                    </h2>
                </header>
                <div class="body" itemprop="articleBody">
                    <div class="googlereader description" data-google-id="tag:google.com,2005:reader/item/57439aaf3ea6f7ed">
                        <p class="annotation">
                            I'm more interested in approaches which would compile full Python to JavaScript but this is definitely interesting
                        </p>
                        <blockquote>
                            <a href="http://api.tweetmeme.com/share?url=http://www.allbuttonspressed.com/blog/django/2010/07/PyvaScript-Pythonic-syntax-for-your-browser" style="float:left;margin-right:10px"><img src="http://api.tweetmeme.com/imagebutton.gif?url=http://www.allbuttonspressed.com/blog/django/2010/07/PyvaScript-Pythonic-syntax-for-your-browser" height="61" width="51"></a>
                            <div>
                                <p>
                                    Hey, after a lot of work in the last few weeks I'm finally ready to introduce you to one of our latest projects called PyvaScript. It's a new scripting language for your client side code with a syntax inspired by our favorite language Python. :) So let's take a closer look at what Waldemar conjured up.
                                </p>
                                <div>
                                    <h2>
                                        Why?
                                    </h2>
                                    <p>
                                        We all know the pain resulting from switching between programming languages. Writing web projects using Django means to code in Python on the server side and (mostly) to code in JavaScript on the client side. Switching between both languages leads to many bugs and forces us to think differently in each language. This becomes even worse if we first write much of the code in one of both languages over a longer period of time and then switch over to the other one. In the end the result means unnecessary work.
                                    </p>
                                    <p>
                                        The goal of PyvaScript is to solve this problem by giving you the possibility to use a Python like syntax as well as common functions from Python wherever that is possible on the client side too. Thus PyvaScript addresses developers who love Python while still being able to write fast code and interface with JS.
                                    </p>
                                </div>
                                <div>
                                    <h2>
                                        Diving in
                                    </h2>
                                    <p>
                                        So let's see what PyvaScript looks like:
                                    </p>
                                    <div>
                                        <pre>
<span># demo.pyva</span>
<span>li_elements</span> <span>=</span> <span>{</span>
    <span>'First message'</span><span>:</span> <span>'&lt;li&gt; I want you to feel pain,&lt;/li&gt;'</span><span>,</span>
    <span>'Second message'</span><span>:</span> <span>'&lt;li&gt; to think about pain,&lt;/li&gt;'</span><span>,</span>
    <span>'Third message'</span><span>:</span> <span>'&lt;li&gt; to accept pain,&lt;/li&gt;'</span><span>,</span>
    <span>'Fourth message'</span><span>:</span> <span>'&lt;li&gt; to know pain. -- Tsunade&lt;/li&gt;'</span><span>,</span>
<span>}</span>

<span>$</span><span>(</span><span>document</span><span>)</span><span>.</span><span>ready</span><span>(</span>
    <span>def</span><span>():</span>
        <span>ul</span> <span>=</span> <span>$</span><span>(</span><span>"#ul"</span><span>)</span>
        <span>for</span> <span>key</span> <span>in</span> <span>li_elements</span><span>:</span>
            <span>ul</span><span>.</span><span>html</span><span>(</span><span>li_elements</span><span>[</span><span>key</span><span>])</span>
<span>)</span>
</pre>
                                    </div>
                                    <p>
                                        This simple example demonstrates some key features of PyvaScript. First you see that PyvaScript wipes out semicolons as well as curly braces used to form blocks. Second you can see how to use the for-in-loop we all know and love from Python. Third it demonstrates the ability to use multi-line lambda functions which we are used to from JavaScript thus combining clean syntax with JavaScript features. And fourth you see that PyvaScript allows to use forbidden characters in Python like "$" for variable names. This allows PyvaScript to use JavaScript libraries without having to write any wrapper. In this example it's jQuery.
                                    </p>
                                    <p>
                                        Now run
                                    </p>
                                    <div>
                                        <pre>
compile-pyva.py demo.pyva
</pre>
                                    </div>
                                    <p>
                                        from within the shell to compile the code to JavaScript. This creates a new file called "demo.js". (note that you have to install <a href="http://bitbucket.org/wkornewald/pymeta/get/tip.zip">pymeta</a> via <tt>setup.py</tt> install first)
                                    </p>
                                    <p>
                                        Now you can add "demo.js" to your html file. But before this you have to include PyvaScript's "stdlib.js" containing function definitions used by the compiled source file. So put the following line into the head section of your html files before any compiled PyvaScript file:
                                    </p>
                                    <div>
                                        <pre>
...
<span>&lt;script </span><span>src=</span><span>"stdlib.js"</span> <span>type=</span><span>"text/javascript"</span><span>&gt;&lt;/script&gt;</span>
<span>&lt;script </span><span>src=</span><span>"demo.js"</span> <span>type=</span><span>"text/javascript"</span><span>&gt;&lt;/script&gt;</span>
...
</pre>
                                    </div>
                                    <p>
                                        That's it. Your first PyvaScript can now run in your browser. :)
                                    </p>
                                </div>
                                <div>
                                    <h2>
                                        What's different to Javascript?
                                    </h2>
                                    <p>
                                        There are still some differences to JavaScript. These are:
                                    </p>
                                    <ul>
                                        <li>PyvaScript only supports the for-in-loop and optimizes it at compile time.
                                        </li>
                                        <li>You don't have to use the keyword <tt>var</tt> anymore to define local variables.
                                        </li>
                                        <li>Global variables can be defined using the keyword <tt>global</tt>. You still can use <tt>window.var_definition</tt> but it's cleaner to use <tt>global</tt>.
                                        </li>
                                        <li>You have to use <tt>isinstance</tt> instead of <tt>instanceof</tt>.
                                        </li>
                                        <li>Functions are defined via the keyword <tt>def</tt> instead of <tt>function</tt>.
                                        </li>
                                        <li>We started to add common functions from Python to PyvaScript. At the moment you can use <tt>join</tt> on strings as well as <tt>append</tt>, <tt>insert</tt> and <tt>extend</tt> on arrays while still being able to use <tt>push</tt> instead of <tt>append</tt> for example. Additionally you can use the <tt>range</tt> function in for-loops.
                                        </li>
                                    </ul>
                                    <p>
                                        Beside these points PyvaScript behaves just like JavaScript.
                                    </p>
                                </div>
                                <div>
                                    <h2>
                                        What's different to Python?
                                    </h2>
                                    <p>
                                        While trying to stay as close as possible to Python there are still some differences:
                                    </p>
                                    <ul>
                                        <li>tuple objects are just lists. This means that they are mutable.
                                        </li>
                                        <li>PyvaScript does neither support keyword arguments nor classes nor any other complex features from Python.
                                        </li>
                                        <li>You can use multi-line lambda functions.
                                        </li>
                                        <li>You can use characters like "$" as the first character for variable names. This allows you to interact with other JavaScript libraries like jQuery which otherwise would only be possible with additional wrapper code.
                                        </li>
                                    </ul>
                                </div>
                                <div>
                                    <h2>
                                        Potential pitfalls
                                    </h2>
                                    <p>
                                        In order to make PyvaScript work you have to keep two things in mind:
                                    </p>
                                    <ul>
                                        <li>You have to include PyvaScripts "stdlib.js" before any of your compiled PyvaScript files.
                                        </li>
                                        <li>Never call a function <tt>JS</tt>. PyvaScript defines a function called <tt>JS</tt> by itself to allow the use of native JavaScript code in PyvaScript so that you can write something like <tt><span>JS('for</span> (var i=0; i&lt; 5; <span>i++)</span> <span>alert(i);')</span></tt> which wouldn't be possible with PyvaScript.
                                        </li>
                                    </ul>
                                </div>
                                <div>
                                    <h2>
                                        What's next?
                                    </h2>
                                    <p>
                                        As this is the first version of PyvaScript we will try to extend it wherever possible so that switching between languages will be even less painful. In particular we will focus on the following steps
                                    </p>
                                    <ul>
                                        <li>Extending PyvaScript with standard methods for strings, lists, ...
                                        </li>
                                        <li>Combining PyvaScript with the PyJS compiler from <a href="http://pyjs.org/">PyJamas</a>
                                        </li>
                                    </ul>
                                    <p>
                                        The last point is especially interesting because PyJS emulates many features from Python. It even includes many modules from Python, <tt>sys</tt> is just one example. So why use PyvaScript? As it turns out, PyJS emulates many features, therefore being not able to produce high-performance code. Additionally there is no easy way to use native JavaScript libraries without having to write wrappers. PyvaScript is intended to focus on these issues while leaving the emulation of complex features in PyJS. Thus PyvaScript aims to close this gap and to allow flawless interaction with PyJS. So stay tuned to PyvaScript development. There is more to come.
                                    </p>
                                </div>
                            </div>
                            <div>
                                <a href="http://feeds.feedburner.com/~ff/AllButtonsPressed?a=tz4lpuR77Lc:-9LMkgrBGaA:yIl2AUoC8zA"><img src="http://feeds.feedburner.com/~ff/AllButtonsPressed?d=yIl2AUoC8zA" border="0"></a> <a href="http://feeds.feedburner.com/~ff/AllButtonsPressed?a=tz4lpuR77Lc:-9LMkgrBGaA:qj6IDK7rITs"><img src="http://feeds.feedburner.com/~ff/AllButtonsPressed?d=qj6IDK7rITs" border="0"></a> <a href="http://feeds.feedburner.com/~ff/AllButtonsPressed?a=tz4lpuR77Lc:-9LMkgrBGaA:V_sGLiPBpWU"><img src="http://feeds.feedburner.com/~ff/AllButtonsPressed?i=tz4lpuR77Lc:-9LMkgrBGaA:V_sGLiPBpWU" border="0"></a> <a href="http://feeds.feedburner.com/~ff/AllButtonsPressed?a=tz4lpuR77Lc:-9LMkgrBGaA:gIN9vFwOqvQ"><img src="http://feeds.feedburner.com/~ff/AllButtonsPressed?i=tz4lpuR77Lc:-9LMkgrBGaA:gIN9vFwOqvQ" border="0"></a> <a href="http://feeds.feedburner.com/~ff/AllButtonsPressed?a=tz4lpuR77Lc:-9LMkgrBGaA:F7zBnMyn0Lo"><img src="http://feeds.feedburner.com/~ff/AllButtonsPressed?i=tz4lpuR77Lc:-9LMkgrBGaA:F7zBnMyn0Lo" border="0"></a> <a href="http://feeds.feedburner.com/~ff/AllButtonsPressed?a=tz4lpuR77Lc:-9LMkgrBGaA:cGdyc7Q-1BI"><img src="http://feeds.feedburner.com/~ff/AllButtonsPressed?d=cGdyc7Q-1BI" border="0"></a> <a href="http://feeds.feedburner.com/~ff/AllButtonsPressed?a=tz4lpuR77Lc:-9LMkgrBGaA:I9og5sOYxJI"><img src="http://feeds.feedburner.com/~ff/AllButtonsPressed?d=I9og5sOYxJI" border="0"></a> <a href="http://feeds.feedburner.com/~ff/AllButtonsPressed?a=tz4lpuR77Lc:-9LMkgrBGaA:IYcBVfS31Nw"><img src="http://feeds.feedburner.com/~ff/AllButtonsPressed?i=tz4lpuR77Lc:-9LMkgrBGaA:IYcBVfS31Nw" border="0"></a>
                            </div><img src="http://feeds.feedburner.com/~r/AllButtonsPressed/~4/tz4lpuR77Lc" height="1" width="1">
                        </blockquote>
                    </div>
                    <p class="bookmark-source">
                        Source: <a href="http://www.allbuttonspressed.com/blog/django/2010/07/PyvaScript-Pythonic-syntax-for-your-browser">http://www.allbuttonspressed.com/blog/django/2010/07/PyvaScript-Pythonic-syntax-for-your-browser</a>
                    </p>
                </div>
            </article>
            <nav id="post-nav"></nav><script id="discus-javascript">
    var disqus_shortname = 'improbable';

                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    document.getElementsByTagName('body')[0].appendChild(dsq);
                })();
            </script><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            <div id="disqus_thread"></div>
        </section>
        <footer id="site-footer" class="nocontent">
            <p>
                This site is purely my personal work and does not reflect the views of my employer.
            </p>
            <p class="license">
                <a class="icon" rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a> This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
            </p>
        </footer><script async="" defer src="/static/js/common.js">
</script><script id="google-analytics">
    var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-2097834-1']);
            _gaq.push(['_setDomainName', 'improbable.org']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
    </body>
</html>
