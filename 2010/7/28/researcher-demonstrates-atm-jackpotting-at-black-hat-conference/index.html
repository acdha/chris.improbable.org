<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>
            Researcher Demonstrates ATM ‘Jackpotting’ at Black Hat Conference
        </title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="/static/css/main.min.css" type="text/css" media="all"><!--[if lte IE 8]>
            <link rel="stylesheet" href="/static/css/ie-fixes.css" type="text/css" media="all">
            <script src="/static/js/html5shiv.js"></script>
        <![endif]-->
        <meta http-equiv="last-modified" content="Thu, 29 Jul 2010 00:37:24 GMT">
        <link rel="alternate" type="application/atom+xml" title="All Posts (Atom)" href="/feeds/all.atom">
        <link rel="alternate" type="application/rss+xml" title="All Posts (RSS)" href="/feeds/all.rss">
        <link rel="icon" type="image/jpeg" sizes="287x287" href="/static/img/favicon-287x287.jpg">
        <link rel="icon" type="image/jpeg" sizes="128x128" href="/static/img/favicon-128x128.jpg">
        <script type="application/javascript">
var _prum={id:"5166be01e6e53d1007000001"};var PRUM_EPISODES=PRUM_EPISODES||{};PRUM_EPISODES.q=[];PRUM_EPISODES.mark=function(b,a){PRUM_EPISODES.q.push(["mark",b,a||new Date().getTime()])};PRUM_EPISODES.measure=function(b,a,b){PRUM_EPISODES.q.push(["measure",b,a,b||new Date().getTime()])};PRUM_EPISODES.done=function(a){PRUM_EPISODES.q.push(["done",a])};PRUM_EPISODES.mark("firstbyte");(function(){var b=document.getElementsByTagName("script")[0];var a=document.createElement("script");a.type="text/javascript";a.async=true;a.charset="UTF-8";a.src="//rum-static.pingdom.net/prum.min.js";b.parentNode.insertBefore(a,b)})();
        </script>
    </head>
    <body class="blog post_detail" itemscope itemtype="http://schema.org/BlogPosting">
        <nav id="site-nav">
            <header id="about">
                <h1>
                    <a href="/about/">Chris Adams</a>
                </h1>
                <h2>
                    Programmer, cyclist, photographer
                </h2>
            </header>
            <ul class="links">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li>
                    <a href="/feeds/all.atom" title="Site Feed">Site Feed</a>
                </li>
            </ul>
            <ul class="social-networks">
                <li>
                    <a href="https://github.com/acdha" rel="me">Github</a>
                </li>
                <li>
                    <a href="http://bitbucket.org/acdha" rel="me">Bitbucket</a>
                </li>
                <li>
                    <a href="http://delicious.com/acdha" rel="me">del.icio.us</a>
                </li>
                <li>
                    <a href="http://twitter.com/acdha" rel="me">Twitter</a>
                </li>
                <li>
                    <a href="https://plus.google.com/116562742092842686896?rel=author" rel="me">Google+</a>
                </li>
                <li>
                    <a href="http://www.flickr.com/photos/acdha" rel="me">Flickr</a>
                </li>
                <li>
                    <a href="http://www.linkedin.com/in/acdha" rel="me">LinkedIn</a>
                </li>
                <li>
                    <a href="http://connect.garmin.com/explore?owner=acdha" rel="me">Garmin Connect</a>
                </li>
            </ul>
            <div id="site-search"></div>
        </nav>
        <section id="main">
            <article class="post">
                <header>
                    <meta itemprop="dateCreated" content="2010-07-28T20:37:24-04:00">
                    <meta itemprop="dateModified" content="2010-07-28T20:37:24-04:00"><time class="date" itemprop="datePublished" datetime="2010-07-29T00:37:24+00:00">Jul 29</time>
                    <h2 itemprop="title">
                        Researcher Demonstrates ATM ‘Jackpotting’ at Black Hat Conference
                    </h2>
                </header>
                <div class="body" itemprop="articleBody">
                    <div class="googlereader description" data-google-id="tag:google.com,2005:reader/item/a5f21d1e594925f7">
                        <blockquote>
                            <p>
                                <a href="http://www.wired.com/images_blogs/threatlevel/2010/07/atm_cash.jpg"><img src="http://www.wired.com/images_blogs/threatlevel/2010/07/atm_cash.jpg" alt="" title="atm_cash" width="660" height="444"></a>
                            </p>
                            <p>
                                LAS VEGAS — In a city filled with slot machines spilling jackpots, it was a “jackpotted” ATM that got the most attention Wednesday at the Black Hat security conference, when researcher Barnaby Jack demonstrated two suave hacks against automated teller machines that made them spew out dozens of crisp bills.
                            </p>
                            <p>
                                The audience greeted the demonstration with hoots and applause.
                            </p>
                            <p>
                                In one of the attacks, Jack&nbsp;reprogrammed&nbsp;the ATM remotely over a network, without touching the machine; the second attack required he open the front panel and plug in a USB stick loaded with malware.
                            </p>
                            <p>
                                Jack, director of security research at IOActive Labs, focused his hack research on standalone and hole-in-the-wall ATMs — the kind installed in retail outlets and restaurants. He did not rule out that bank ATMs could have similar vulnerabilities, but he hasn’t yet examined them.
                            </p>
                            <p>
                                The two systems he hacked onstage were made by Triton and Tranax. The Tranax hack was conducted using an authentication bypass vulnerability that Jack found in the system’s remote monitoring feature, which can be accessed over the internet or dial-up, depending on how the owner configured the machine.
                            </p>
                            <p>
                                Tranax’s remote monitoring system is turned on by default, but Jack said the company has since begun advising customers to protect themselves from the attack by disabling the remote system.
                            </p>
                            <p>
                                To conduct the remote hack, an attacker would need to know an ATM’s IP address or phone number.&nbsp;Jack said he believes about 95 percent of retail ATMs are on dial-up; a hacker could war dial for ATMs connected to telephone modems, and identify them by the cash machine’s proprietary protocol.
                            </p>
                            <p>
                                The Triton attack was made possible by a security flaw that allowed unauthorized programs to execute on the system. The company distributed a patch last November so that only digitally signed code can run on them.
                            </p>
                            <p>
                                Both the Triton and Tranax ATMs run on Windows CE.
                            </p>
                            <p>
                                Using a remote attack tool, dubbed Dillinger, Jack was able to exploit the authentication-bypass vulnerability in Tranax’s remote monitoring feature and upload software or overwrite the entire firmware on the system. With that capability, he installed a malicious program he wrote, called Scrooge.
                            </p>
                            <p>
                                Scrooge lurks on the ATM quietly in the background until someone wakes it up in person. It can be initiated in two ways — either through a touch-sequence entered on the ATM’s keypad or by inserting a special control card. Both methods activate a hidden menu an attacker can use to make the machine spew out money or print receipts. Scrooge will also capture magstripe data embedded in bank cards other users insert into the ATM.
                            </p>
                            <p>
                                To demonstrate, Jack punched keys on the keypad to call up the menu, then instructed the machine to spit out 50 bills from one of four cassettes. The screen lit up with the word “Jackpot!” as the bills came flying out the front.
                            </p>
                            <p>
                                To hack the Triton, he used a key to open the machine’s front panel, then connected a USB stick containing his malware. The ATM uses a uniform lock on all of its systems — the kind used on filing cabinets — that can be opened with a $10 key available on the web. The same key opens every Triton ATM.
                            </p>
                            <p>
                                Two Triton representatives said at a press conference after the presentation that its customers preferred a single lock on systems so they could easily manage fleets of machines without requiring numerous keys. But they said Triton offers a lock upgrade kit to customers who request it — the upgraded lock is a Medeco pick-resistant, high-security lock.
                            </p>
                            <p>
                                Similar malware attacks were discovered on bank ATMs in Eastern Europe last year. Security researchers at Trustwave, based in Chicago, <a href="http://www.wired.com/threatlevel/2009/06/new-atm-malware-captures-pins-and-cash">found the malware on 20 machines in Russia and Ukraine</a> that were all running Microsoft’s Windows XP operating system. They said they found signs that hackers were planning on bringing their attacks to machines in the United States. The malware was designed to attack ATMs made by Diebold and NCR.
                            </p>
                            <p>
                                Those attacks required an insider, such as an ATM technician or anyone else with a key to the machine, to place malware on the ATM. Once that was done, attackers could insert a control card into the machine’s card reader to trigger the malware and give them control of the machine through a custom interface and the ATM’s keypad.
                            </p>
                            <p>
                                The malware captured account numbers and PINs from the machine’s transaction application and then delivered it to the thief on a receipt printed from the machine in an encrypted format, or to a storage device inserted in the card reader. A thief could also instruct the machine to eject whatever cash was inside the machine. A fully loaded bank ATM can hold up to $600,000.
                            </p>
                            <p>
                                Earlier this year, in a separate incident, a Bank of America employee was charged with installing malware on his employer’s ATMs that allowed him to <a href="http://www.wired.com/threatlevel/2010/04/bank-of-america-hack/">withdraw thousands of dollars without leaving a transaction record</a>.
                            </p>
                            <p>
                                Jack was slated to give the same ATM vulnerability talk at Black Hat last year, but his then-employer Juniper Networks canceled the talk weeks before the conference after an <a href="http://www.wired.com/threatlevel/2009/06/atm-vendor-halts-talk/">unnamed ATM vendor expressed concern</a>. He said on Wednesday that the earlier talk was withdrawn to allow Triton time to implement a patch to address the code-execution vulnerability targeted in his demonstration. The company <a href="http://www.tritonatm.com/news/current/black_hat.htm">released the patch eight months ago</a>.
                            </p>
                            <p>
                                Jack said that so far he’s examined ATMs made by four manufacturers and all of them have vulnerabilities. “Every ATM I’ve looked at allows that ‘game over.’ I’m four for four,” he said at the press conference. He wouldn’t discuss the vulnerabilities in the two ATMs not attacked on Wednesday because he said his previous employer, Juniper Networks, owns that research.
                            </p>
                            <p>
                                Jack said his aim in demonstrating the hacks is to get people to look more closely at the security of systems that are presumed to be locked down and impenetrable.
                            </p>
                            <p>
                                <em>Photo: Isaac Brekken/Associated Press</em>
                            </p>
                            <p>
                                <strong>See also</strong>
                            </p>
                            <ul>
                                <li>
                                    <a href="http://www.wired.com/threatlevel/2010/05/thor/">Former Con Man Helps Feds Thwart Alleged ATM Hacking Spree</a>
                                </li>
                                <li>
                                    <a href="http://www.wired.com/threatlevel/2009/06/atm-vendor-halts-talk/">ATM Vendor Halts Researcher’s Talk on Vulnerability</a>
                                </li>
                                <li>
                                    <a href="http://www.wired.com/threatlevel/2009/06/new-atm-malware-captures-pins-and-cash">New ATM Malware Captures PINs and Cash</a>
                                </li>
                                <li>
                                    <a href="http://www.wired.com/threatlevel/2010/04/bank-of-america-hack/">Bank of America Employee Charged With Planting Malware on ATMs</a>
                                </li>
                            </ul>
                            <div>
                                <a href="http://feeds.wired.com/~ff/wired27b?a=ZCRjLaUUK7s:LbecYsXFJRU:cGdyc7Q-1BI"><img src="http://feeds.feedburner.com/~ff/wired27b?d=cGdyc7Q-1BI" border="0"></a> <a href="http://feeds.wired.com/~ff/wired27b?a=ZCRjLaUUK7s:LbecYsXFJRU:V_sGLiPBpWU"><img src="http://feeds.feedburner.com/~ff/wired27b?i=ZCRjLaUUK7s:LbecYsXFJRU:V_sGLiPBpWU" border="0"></a> <a href="http://feeds.wired.com/~ff/wired27b?a=ZCRjLaUUK7s:LbecYsXFJRU:gIN9vFwOqvQ"><img src="http://feeds.feedburner.com/~ff/wired27b?i=ZCRjLaUUK7s:LbecYsXFJRU:gIN9vFwOqvQ" border="0"></a> <a href="http://feeds.wired.com/~ff/wired27b?a=ZCRjLaUUK7s:LbecYsXFJRU:yIl2AUoC8zA"><img src="http://feeds.feedburner.com/~ff/wired27b?d=yIl2AUoC8zA" border="0"></a>
                            </div><img src="http://feeds.feedburner.com/~r/wired27b/~4/ZCRjLaUUK7s" height="1" width="1">
                        </blockquote>
                    </div>
                    <p class="bookmark-source">
                        Source: <a href="http://feeds.wired.com/~r/wired27b/~3/ZCRjLaUUK7s/">http://feeds.wired.com/~r/wired27b/~3/ZCRjLaUUK7s/</a>
                    </p>
                </div>
            </article>
            <nav id="post-nav"></nav><script id="discus-javascript">
    var disqus_shortname = 'improbable';

                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    document.getElementsByTagName('body')[0].appendChild(dsq);
                })();
            </script><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            <div id="disqus_thread"></div>
        </section>
        <footer id="site-footer" class="nocontent">
            <p>
                This site is purely my personal work and does not reflect the views of my employer.
            </p>
            <p class="license">
                <a class="icon" rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a> This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
            </p>
        </footer><script async="" defer src="/static/js/common.js">
</script><script id="google-analytics">
    var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-2097834-1']);
            _gaq.push(['_setDomainName', 'improbable.org']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
    </body>
</html>
