<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Introduction to W3C Widgets</title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="/static/css/main.min.css" type="text/css" media="all">
        <!--[if lte IE 8]>
            <link
                rel="stylesheet"
                href="/static/css/ie-fixes.css"
                type="text/css"
                media="all"
            />
            <script src="/static/js/html5shiv.js"></script>
        <![endif]-->

        <meta http-equiv="last-modified" content="Sun, 24 May 2009 17:46:31 GMT">
        <link rel="alternate" type="application/atom+xml" title="All Posts (Atom)" href="/feeds/all.atom">
        <link rel="alternate" type="application/rss+xml" title="All Posts (RSS)" href="/feeds/all.rss">
        <link rel="icon" type="image/jpeg" sizes="287x287" href="/static/img/favicon-287x287.jpg">
        <link rel="icon" type="image/jpeg" sizes="128x128" href="/static/img/favicon-128x128.jpg">
    </head>
    <body class="blog post_detail" itemscope itemtype="http://schema.org/BlogPosting">
        <nav id="site-nav">
            <header id="about">
                <h1><a href="/about/">Chris Adams</a></h1>
                <h2>Programmer, cyclist, photographer</h2>
            </header>
            <ul class="links">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li>
                    <a href="/feeds/all.atom" title="Site Feed">Site Feed</a>
                </li>
            </ul>
            <ul class="social-networks">
                <li>
                    <a rel="me" href="https://code4lib.social/@acdha">Mastodon</a>
                </li>
                <li>
                    <a href="https://github.com/acdha" rel="me">Github</a>
                </li>
                <li>
                    <a href="https://bitbucket.org/acdha" rel="me">Bitbucket</a>
                </li>
                <li>
                    <a href="https://pinboard.in/u:acdha/" rel="me">Pinboard</a>
                </li>
                <li>
                    <a href="https://www.flickr.com/photos/acdha" rel="me">Flickr</a>
                </li>
                <li>
                    <a href="https://www.linkedin.com/in/acdha" rel="me">LinkedIn</a>
                </li>
            </ul>
            <div id="site-search"></div>
        </nav>
        <section id="main">
            <article class="post">
                <header>
                    <meta itemprop="dateCreated" content="2009-04-20T05:51:02-04:00">
                    <meta itemprop="dateModified" content="2009-04-20T05:51:02-04:00">
                    <time class="date" itemprop="datePublished" datetime="2009-04-20T09:51:02+00:00">Apr 20</time>
                    <h2 class="" itemprop="title">Introduction to W3C Widgets</h2>
                </header>

                <div class="body" itemprop="articleBody"><div class="googlereader description" data-google-id="tag:google.com,2005:reader/item/c6ad13ed3ff0e7b3">
                        <blockquote>
                            <p>
                                As I said <a href="http://www.quirksmode.org/blog/archives/2009/03/testing_mobile.html">before</a>, I’m currently working for Vodafone on mobile browser compatibility and W3C Widgets. I’ve <a href="http://www.quirksmode.org/blog/archives/2009/03/testing_mobile_1.html">discussed</a> some mobile browser problems, and you can <a href="http://www.quirksmode.org/m/">look over my shoulder</a> while I’m at work dissecting their odd behaviours. If you want the latest scoops on my mobile adventures, you can <a href="http://twitter.com/ppk">follow me on Twitter</a>.
                            </p>
                            <p>
                                The time has come to talk about the W3C Widgets part of my job. Exactly what is a widget, how do you create one, why would you want to, and which systems support them?
                            </p>
                            <p>
                                Personally I firmly believe that widgets are the future of the mobile web. They are easy to create, they’re based on open standards, they save the end user quite a bit of network traffic, and many people around the world already know how to create them.
                            </p>
                            <p>
                                In contrast to other recent publications about widgets, I’ll tell you the whole story — or rather, a condensed version thereof.
                            </p>
                            <h3>
                                What is a widget?
                            </h3>
                            <p>
                                Essentially, a widget is a local HTML/CSS/JavaScript web application. A mobile phone user downloads a widget once, and from that moment on he has a web application stored locally on his mobile phone.
                            </p>
                            <p>
                                Although currently widgets are mostly used for relatively limited functions such as clocks, RSS readers, or Twitter or Flickr clients, as well as for games, there’s no theoretical reason why they couldn’t contain a complete, complicated, JavaScript-heavy web application; for instance a mobile-optimised spreadsheet application.
                            </p>
                            <p>
                                The beauty of the widget model is that, even if this spreadsheet application needs 200K of custom JavaScript plus a few libraries, the end user has to download these scripts only once instead of every time he starts up the app, as in the traditional web application model. After the initial download the entire application is installed locally and can be fired up from the local files.
                            </p>
                            <p>
                                Many web applications will want to display fresh data, and therefore most widgets will fire an Ajax request as soon as they’re started up. For that they need a network connection and some data traffic.
                            </p>
                            <p>
                                Nonetheless, the fact that the application itself doesn’t have to be downloaded every time the user starts it up diminishes the network traffic by a lot; and that’s important on mobile phones with their unreliable and sometimes crawlingly slow connections.
                            </p>
                            <h4>
                                Unique selling point
                            </h4>
                            <p>
                                In itself the widget concept is no different from the countless application models currently being set up for the iPhone, Android, Blackberry, Windows Mobile, and many more systems. These, too, will put the core files on your phone and use the network connection only for data traffic.
                            </p>
                            <p>
                                All proprietary systems, however, require programmers to train themselves in new skills and techniques that are not interoperable. Widgets, on the other hand, use the open web technologies that hundreds of thousands of developers all over the world are already familiar with.
                            </p>
                            <p>
                                Better still, widgets will eventually conform to the “write once, run anywhere” principle; though right now that’s not yet the case.
                            </p>
                            <p>
                                Personally I firmly believe that widgets are the future of the mobile web. They are easy to create, they’re based on open standards, they save the end user quite a bit of network traffic, and many people around the world already know how to create them.
                            </p>
                            <h3>
                                Technical overview
                            </h3>
                            <p>
                                Widgets are nothing more than zipped websites. You create an HTML file, add as many CSS, JavaScript and image files as you need, zip the lot, change the extension to <code>.wgt</code> and it works. Just like that.
                            </p>
                            <p>
                                Well, almost just like that. The rest of this entry explains the “almost.”
                            </p>
                            <h4>
                                Specification
                            </h4>
                            <p>
                                Widgets are specified by the <a href="http://www.w3.org/TR/widgets-apis/">W3C Widgets specification</a>. Currently this spec is still a work in (slow) progress, as so many W3C specifications are, but the outline is pretty clear.
                            </p>
                            <p>
                                The widget environment I’m working with has been created by Vodafone in close cooperation with Opera. Because they wanted to work according to a standard but the specification was (and is) still in draft stage, at a certain point they decided to freeze the then-current version and implement it. Subsequently it was slightly modified to solve some urgent problems.
                            </p>
                            <p>
                                All technical details I’m going to give come from this Opera/Vodafone implementation, which does not quite match the current W3C draft. Everything works, though — I tested it personally.
                            </p>
                            <p>
                                (Once the specification stabilises Opera and Vodafone plan to implement it, and that will probably mean already created widgets will experience minor breakage. We’re planning to release a library that works around these issues for you.)
                            </p>
                            <h4>
                                Widget SDK
                            </h4>
                            <p>
                                Unfortunately there’s a zipping issue on Mac. I’m not sure of the details, but if you just use the default zip on Mac, your widget will not work.
                            </p>
                            <p>
                                In order to solve this problem and several others, Vodafone has released a <a href="http://www.betavine.net/bvportal/web/guest/widgetzone/research">Widget SDK</a>. Although the site doesn’t state so clearly, it’s in beta right now and a final release is expected later this year. You should take a look at it if you’re serious about creating widgets.
                            </p>
                            <p>
                                It contains a special version of the Vodafone Widget Manager that allows you to debug your widgets through a Bluetooth connection with Opera Dragonfly. The procedure is sometimes complicated; see <a href="http://blog.stefankolb.de/2009/04/13/debugging-mobile-widgets-with-opera-dragonfly/">Debugging Mobile Widgets with Opera Dragonfly</a> for the technical details.
                            </p>
                            <h4>
                                config.xml
                            </h4>
                            <p>
                                A widget requires a <code>config.xml</code> file that specifies some configuration information. Here’s a sample config file:
                            </p>
                            <pre>
&lt;widget id="http://quirksmode.org/widget" dockable="true"&gt;
  &lt;widgetname&gt;Test widget&lt;/widgetname&gt;
  &lt;icon&gt;pix/myIcon.gif&lt;/icon&gt;
  &lt;width&gt;200&lt;/width&gt;
  &lt;height&gt;200&lt;/height&gt;
  &lt;security&gt;
    &lt;access&gt;
      &lt;host&gt;quirksmode.org&lt;/host&gt;
    &lt;/access&gt;
  &lt;/security&gt;
&lt;/widget&gt;
</pre>
                            <p>
                                Most of this stuff is pretty simple. <code>&lt;width&gt;</code> and <code>&lt;height&gt;</code>, unsurprisingly, define the width and height of the widget in pixels.
                            </p>
                            <p>
                                These are start values; if you want you can later on change the widget size by the normal <code>resizeTo()</code> and <code>resizeBy()</code> methods. The widget cannot in any case become larger than the screen.
                            </p>The <code>&lt;icon&gt;</code> tag specifies the icon that the user sees when the widget is turned off; and this is of course a local file.
                            <p>
                                The <code>&lt;widgetname&gt;</code> tag contains the name that will be shown with the widget icon. It’s advisable to use short names, because there’s only about 60 pixels of space to show the name when the widget is docked. Some phones auto-scroll longer texts when the user focuses on the icon, but that’s not an optimal means of communication.
                            </p>
                            <p>
                                The <code>id</code> attribute is required if you want to be able to update your widget. I’ll get back to the updating process in a later post; for now it’s sufficient to say that an <code>id</code> <em>must</em> be a unique URI.
                            </p>
                            <p>
                                As to the <code>&lt;host&gt;</code> element, it specifies with which host(s) the widget is allowed to communicate via Ajax requests. Widgets don’t really have a same-source policy; they’d be worthless if they did because they must be able to download data from anywhere. However, the widget creator is required to specify which domains the widget may access.
                            </p>
                            <p>
                                (Unfortunately Opera unexpectedly changed the security policy in Opera 10 Desktop. You need the syntax shown above for Opera 9 and the Widget Manager, but a <a href="http://my.opera.com/WebApplications/blog/2009/01/14/new-security-model-for-widgets-opera-10-and-network-public">different one</a> for Opera 10.)
                            </p>
                            <h4>
                                Docked widgets
                            </h4>
                            <p>
                                Widgets have a docked state that’s pretty similar to minimised applications on your desktop computer, in that scripts may continue to run in a docked widget; for instance to silently update an RSS reader with new data.
                            </p>
                            <p>
                                However, you have to explicitly allow scripts to continue running by adding the <code>dockable="true"</code> attribute to the <code>&lt;widget&gt;</code> tag. If it’s not there, the widget assumes it may not run any scripts while docked.
                            </p>
                            <p>
                                While a widget is docked, it is still visible to the user as an icon, although the viewport now becomes about 60x60 pixels (and remains so until the user undocks the widget).
                            </p>
                            <p>
                                If you wish you can present the user with a special interface while the widget is docked; for instance a special icon. In order to do that you need to set a <code>widgetmodechange</code> event handler that checks if the current <code>widget.widgetMode</code> equals <code>docked</code> and if so hides the normal interface and shows a special, 60x60 optimised one.
                            </p>
                            <h4>
                                The <code>widget</code> object and external links
                            </h4>
                            <p>
                                In a widget environment an extra <code>widget</code> object is added to the JavaScript global object to contain these useful widget functionalities such as the <code>widgetmodechange</code> event and the <code>widgetMode</code> property. You can find a complete overview in the <a href="http://www.quirksmode.org/m/widgets.html">widget object compatibility table</a>.
                            </p>
                            <p>
                                Finally, normal hyperlinks open not in the widget itself, but in the default S60 WebKit browser (on mobile phones) or in the regular Opera (on desktop). I do not understand why this should be the case. A widget environment is capable of handling HTTP requests and interpreting HTML, CSS, and JavaScript, after all.
                            </p>
                            <h3>
                                Support
                            </h3>
                            <p>
                                Although I firmly believe support for W3C widgets will become better and better as time progresses, right now it’s still in its infancy.
                            </p>
                            <p>
                                Opera is a major defender of the widget concept, so it comes as no surprise that Opera Desktop supports it. If you’ve created a <code>.wgt</code> file on your computer, double-clicking it starts up Opera, which shows the widget in a special widget mode. That’s useful for testing.
                            </p>
                            <h4>
                                Vodafone Widget Manager
                            </h4>
                            <p>
                                On mobile phones the situation is murkier. The Vodafone Widget Manager, that runs only on Symbian S60 phones (basically Nokia), supports W3C widgets, but few other applications or phones do.
                            </p>
                            <p>
                                The Vodafone Widget Manager (surprise!) has been created by Vodafone in order to manage widgets. It contains a system for installing them, as well as a complete Opera Mobile runtime engine that is used to actually interpret the HTML, CSS, and JavaScript.
                            </p>
                            <p>
                                There are some slight differences between a regular Opera Mobile and the Opera Widget Runtime. In my <a href="http://www.quirksmode.org/m/table.html">tables</a> this special Opera is noted as “Opera VF WM” (for Vodafone Widget Manager).
                            </p>
                            <p>
                                Opera is a pretty good browser, so you can be pretty certain that your widgets will run pretty well as long as you use proper HTML, CSS, and JavaScript. On the other hand, this is a new, untested technology, so nasty surprises will definitely turn up at the worst possible moment in your development cycle.
                            </p>
                            <h4>
                                Opera/T-Mobile Widget Manager
                            </h4>
                            <p>
                                <a href="http://dev.opera.com/articles/view/creating-t-mobile-widgets/">Opera announced</a> just now that it has built a similar system for T-Mobile. Because all the screenshots feature Windows Mobile interfaces, we kind of assume it runs (only?) on that OS.
                            </p>
                            <p>
                                Confusingly, when I search for “widgets” on the T-Mobile site I get <a href="http://www.t-mobile.de/suche?qt=widgets&amp;vgn_form_encoding=ISO-8859-1">three pages about other widget systems</a> on the German site, whilt the <a href="http://www.t-mobile.co.uk/search/results/">UK</a> and <a href="http://search.t-mobile.com/inquiraapp/ui.jsp?ui_mode=question&amp;question_box=widgets">US</a> sites each have one unrelated match.
                            </p>
                            <p>
                                Interestingly, this widget manager seems to contain a device API. A device API is a JavaScript interface meant for accessing phone functionality such as the camera, the calendar, the contact list, and so on. It’s obvious that device APIs are going to be extremely important for creating widgets that tie in more closely with mobile phones.
                            </p>
                            <p>
                                As far as I can see now the Opera/T-Mobile device API is proprietary (and possibly restricted to Windows Mobile). That’s not entirely unexpected; currently the <a href="http://bondi.omtp.org/apis/">BONDI specification</a> is supposed to formulate a standard for device APIs, but it’s not ready yet and unreadable for non-Java programmers anyway.
                            </p>
                            <p>
                                Despite this touch of proprietariness I’m very happy with the Opera/T-Mobile initiative. The more companies support widgets, the sooner they’ll go mainstream.
                            </p>
                            <h4>
                                Nokia Web Runtime Widgets
                            </h4>
                            <p>
                                I think Vodafone widgets can be ported to <a href="http://www.forum.nokia.com/Resources_and_Information/Explore/Web_Technologies/Web_Runtime/">Web Runtime Widgets</a>, the native Nokia S60 widget environment. These, too, are HTML/CSS/JavaScript widgets, although they run in S60 WebKit and need an <code>info.plist</code> XML file instead of a <code>config.xml</code>.
                            </p>
                            <p>
                                As far as I can see, making your widget Nokia-compatible entails nothing more than adding this <code>info.plist</code> to it, and making sure your widget runs well in S60 WebKit. I haven’t tried this for myself, though, so there may be unforeseen circumstances that complicate the matter.
                            </p>
                            <p>
                                By the way, the “XML” in the <code>plist</code> is weird. Somebody tried (and failed) to port name/value pairs to XML. The schema is based on Apple’s Dashboard Widgets, so if you know those you’ve got the advantage over me here.
                            </p>
                            <h4>
                                Palm Pre?
                            </h4>
                            <p>
                                Maybe the Palm Pre, which <a href="http://developer.palm.com/webos_book/book1.html">has made Web technologies the very cornerstone of its webOS operating system</a>, will support them, but there’s so little data available that I can’t really tell, except that it would be a logical extension of their plans. The Palm Pre uses a WebKit branch as default browser, by the way.
                            </p>
                            <p>
                                Other than that I’m not sure where we can easily deploy our widgets right now. I do advise you, however, to test your widgets in a WebKit (Safari or Chrome being the most obvious candidates) in addition to Opera. It will save you some hassle later on.
                            </p>
                            <h3>
                                Our To Do list
                            </h3>
                            <p>
                                Ideally, in a few years, I, using an Android, would be able to transfer a widget to a friend’s S60 Nokia and another friend’s Windows Mobile HTC via Bluetooth (or whatever) and They’d Just Work without me or them having to worry about compatibility.
                            </p>
                            <p>
                                Wouldn’t that be wonderful? Wouldn’t that be absolutely astoundingly interoperable?
                            </p>
                            <p>
                                Besides, widgets will also work on desktop computers. As I said, Opera already supports them, and it’s only logical that other browsers will eventually do so, too.
                            </p>
                            <p>
                                Still, this brave new world won’t give birth to itself. We, as web developers embracing open standards, have our work cut out for us. We have to evangelise standard-compliant W3C Widgets. If you see me <a href="http://www.quirksmode.org/about/conferences.html">speak somewhere during this year</a>, chances are I’ll pontificate on exactly that subject.
                            </p>
                            <p>
                                However, we should be careful to stress that we want widgets not <em>instead of</em>, but <em>in addition to</em> the proprietary systems mobile phone vendors are setting up right now.
                            </p>
                            <p>
                                These systems have their place, and they might conceivably be a better environment for certain types of applications. Besides, everybody is allowed to innovate and try out new platforms and ideas, as long as they <em>also</em> support the standard.
                            </p>
                            <p>
                                It will not be easy. Neither will it be quick. But open technologies, and especially open web technologies, are in an upswing throughout the world, while closed systems will gain a hard core of enthousiastic developers, but not the tidal-wave effect their creators so desperately want.
                            </p>
                            <p>
                                If I were a Marxist I’d say our victory is unavoidable, but since I’m not quite that orthodox I’ll say that it’s likely we’ll succeed.
                            </p>
                            <p>
                                This article has been <a href="http://interpretor.ru/w3c_widgets/">translated into Russian</a>.
                            </p>
                        </blockquote>
                    </div>
                    <p class="bookmark-source">
                        Source: <a href="http://www.quirksmode.org/blog/archives/2009/04/introduction_to.html">http://www.quirksmode.org/blog/archives/2009/04/introduction_to.html</a>
                    </p>
                </div>
            </article>

            <nav id="post-nav">


            </nav>
        </section>

        <footer id="site-footer" class="nocontent">
            <p>
                This site is purely my personal work and does not reflect the
                views of my employer.
            </p>
            <p class="license">
                <a class="icon" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width: 0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a>
                This work is licensed under a
                <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported
                    License</a>.
            </p>
        </footer>

        <script async src="/static/js/common.js"></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js" integrity="sha256-hj+5FRlAuvAFANiefn0PpJYCkV1X4QT9EgiPd+6QnCw=" crossorigin="anonymous"></script>
    </body>
</html>
