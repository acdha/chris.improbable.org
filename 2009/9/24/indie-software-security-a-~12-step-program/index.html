<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Indie Software Security: A ~12 Step Program</title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="/static/css/main.min.css" type="text/css" media="all">
        <!--[if lte IE 8]>
            <link
                rel="stylesheet"
                href="/static/css/ie-fixes.css"
                type="text/css"
                media="all"
            />
            <script src="/static/js/html5shiv.js"></script>
        <![endif]-->

        <meta http-equiv="last-modified" content="Thu, 24 Sep 2009 20:02:26 GMT">
        <link rel="alternate" type="application/atom+xml" title="All Posts (Atom)" href="/feeds/all.atom">
        <link rel="alternate" type="application/rss+xml" title="All Posts (RSS)" href="/feeds/all.rss">
        <link rel="icon" type="image/jpeg" sizes="287x287" href="/static/img/favicon-287x287.jpg">
        <link rel="icon" type="image/jpeg" sizes="128x128" href="/static/img/favicon-128x128.jpg">
    </head>
    <body class="blog post_detail" itemscope itemtype="http://schema.org/BlogPosting">
        <nav id="site-nav">
            <header id="about">
                <h1><a href="/about/">Chris Adams</a></h1>
                <h2>Programmer, cyclist, photographer</h2>
            </header>
            <ul class="links">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li>
                    <a href="/feeds/all.atom" title="Site Feed">Site Feed</a>
                </li>
            </ul>
            <ul class="social-networks">
                <li>
                    <a rel="me" href="https://code4lib.social/@acdha">Mastodon</a>
                </li>
                <li>
                    <a href="https://github.com/acdha" rel="me">Github</a>
                </li>
                <li>
                    <a href="https://bitbucket.org/acdha" rel="me">Bitbucket</a>
                </li>
                <li>
                    <a href="https://pinboard.in/u:acdha/" rel="me">Pinboard</a>
                </li>
                <li>
                    <a href="https://www.flickr.com/photos/acdha" rel="me">Flickr</a>
                </li>
                <li>
                    <a href="https://www.linkedin.com/in/acdha" rel="me">LinkedIn</a>
                </li>
            </ul>
            <div id="site-search"></div>
        </nav>
        <section id="main">
            <article class="post">
                <header>
                    <meta itemprop="dateCreated" content="2009-09-24T16:02:26-04:00">
                    <meta itemprop="dateModified" content="2009-09-24T16:02:26-04:00">
                    <time class="date" itemprop="datePublished" datetime="2009-09-24T20:02:26+00:00">Sep 24</time>
                    <h2 class="" itemprop="title">Indie Software Security: A ~12 Step Program</h2>
                </header>

                <div class="body" itemprop="articleBody"><div class="googlereader description" data-google-id="tag:google.com,2005:reader/item/b3018dd667136c0d">
                        <blockquote>
                            <p>
                                Every autumn, John “Wolf” Rentzsch holds an indie software development conference for Apple developers in Chicago called C4. It’s really excellent. I’d recommend you attend, but it’s become one of those things that sells out the day he announces the tickets. We don’t get to go this year.
                            </p>
                            <p>
                                But last year, we did get to go. Because we’re local, Rentzsch asked us to get up on stage and give a talk. So we roped in Nate McFeters, another local, and put together a security talk for indie Mac developers with no budget for security. What does a security talk for Mac developers look like? As it turns out, it’s very much like the talk we think every indie developer, Mac or not, should see, and it’s very much unlike the talk the rest of the security industry is giving. And, without further ado:
                            </p>
                            <p>
                                <a href="http://www.viddler.com/explore/rentzsch/videos/31">Here’s our talk</a>. <a href="http://www.slideshare.net/tqbf/c42-software-security-presentation">Here’s the slides.</a>
                            </p>
                            <p>
                                (But see the bottom of this post for some caveats about this talk.)
                            </p>
                            <h3>
                                Indie Software Security: A ~12 Step Program
                            </h3>
                            <p>
                                You’re launching the first version of your web application. You’re pre-revenue. Your every waking moment is consumed with the backlog of product enhancements you believe will help your app break through. And you’re about to land on the top of Reddit because of a security flaw.
                            </p>
                            <p>
                                We’re software security people. Our industry is built around breaking software. People like us are the ones putting people like you on the top of Reddit. People like you are the weak, and people like us are the tyranny of evil men.
                            </p>
                            <p>
                                You’re listening to us because you’ve finally given up trying to control the security of your application. Everything else you’ve tried has failed. The advice the “security industry” has given you has had negligible business value, because you’re not a Fortune-500, and you aren’t shipping shrink-wrap to 1,000 enterprises. And the failure of that advice is partly our fault. This is our response.
                            </p>
                            <p>
                                Read the advice we’re giving here. See how you’re doing. Honestly, are you on top of these issues? Remember, there is no disgrace in facing up to the fact that you have a problem.
                            </p>
                            <h3>
                                Step 0: Are You Our Audience?
                            </h3>
                            <p>
                                Do you make lots of money? Do you have lots of money? Are you taking credit card numbers? Do you have a formal SDLC? Do you actually employ security researchers? Does anyone in your company have “security” in their title? Answer “yes” to any of these?
                            </p>
                            <p>
                                You’re not our audience. You have different problems. Some things we say you should do in this post, you should not do. Other things we say not to do, you can go ahead and do.
                            </p>
                            <p>
                                With that said, critique away.
                            </p>
                            <h3>
                                Step 1: Stop Caring So Much
                            </h3>
                            <p>
                                Here are five things that will kill your startup before software security does:
                            </p>
                            <ol>
                                <li>Slowness
                                </li>
                                <li>Poor graphic design
                                </li>
                                <li>XML
                                </li>
                                <li>The RIAA
                                </li>
                                <li>Product Marketing Managers
                                </li>
                            </ol>
                            <p>
                                The graveyards in this town are littered with the corpses of startups that pinned their hopes on advanced security. Better engineers than you have tried and failed. Theo de Raadt coordinated the first large-scale security codebase audit. His reward:
                            </p>
                            <p>
                                <strike>Three years without a</strike>Only two remote holes <em>in the default install</em>!
                            </p>
                            <p>
                                This is not a killer marketing message.
                            </p>
                            <p>
                                Or, try Daniel Bernstein. qmail shipped for <em>ten years</em> without an exploitable remote flaw. It has the best security track record of any piece of mainstream software, ever. But Bernstein <a href="http://www.guninski.com/where_do_you_want_billg_to_go_today_4.html">got integer signedness wrong in one place</a> —- resulting a bug that you can’t even exploit on any modern system —- and now every security blurb about qmail is up for debate.
                            </p>
                            <p>
                                We don’t want you to be the guy in the PG-13 movie, the one everyone’s really hoping makes it happen.
                            </p>
                            <p>
                                37signals is not bad about software security. They’re incredibly successful. They make millions of dollars on an online contact manager. 37signals has a genius for marketing. They’re so money! It’s like Jedi Mind Shit! They’re not bad about security; they’re just not awesome about it.
                            </p>
                            <p>
                                We want you to be like the guy in the rated R movie. You know, the one you’re not sure whether you like him yet. Okay? You’re a bad man. You’re a bad man.
                            </p>
                            <h3>
                                Step 2: First, Get Outreach Right
                            </h3>
                            <p>
                                Do this first. Don’t waste time with anything else.
                            </p>
                            <p>
                                There are a lot of ways to be good at security without being awesome at it. Most of them don’t matter. This one does: you need to be smart about how you interact with people finding and reporting vulnerabilities in your products
                            </p>
                            <p>
                                <a href="http://37signals.com/svn/posts/1907-on-communicating-better">Take, for instance, 37signals.</a> There’s been a pretty negative response to their handling of the disclosure of a cross-site scripting vulnerability in their software. Why did that happen? Because if your company doesn’t act as if it knows how to handle security reports, the world will assume the worst of you, no matter how hard you’re trying.
                            </p>
                            <p>
                                This is literally the simplest security challenge your shop shouldn’t be screwing up:
                            </p>
                            <ul>
                                <li>
                                    <p>
                                        Get your developers in a room, draw straws, and the short straw is now “security@mystartup.com”. She’s the “security contact”. You now have one.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Create a “security” page on your main site. It says, in a nutshell, “we’ve thought about security.” It does not talk about AES key sizes or RSA-OAEP.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Create a “security reports” page. Link to it from your “security” page. It says, in a nutshell, “here’s how to send us security reports, and we’re not going to be jerks about it.” <a href="http://37signals.com/security-response">The one 37signals set up</a> is, we think, an excellent example of the genre.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Your “security reports” page needs to link to a PGP key. This is code for “we’ve given a moment’s thought to the idea that we might have a security flaw in our app reported to us”.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Fixes for security flaws are not features or enhancements. Don’t call them that. In fact, don’t even call them bugs. Give them “security IDs”. This costs you nothing, and is another subtle signal you can send that you’ve done this before.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        For the love of god don’t argue about severities. You won’t win. Security researchers have more buzzwords to throw than you do. Even if you’re right, 50-75% of readers will assume that (a) you’re not right and (b) you’re being petulant.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Thank the people who submit security flaws to you, even if you don’t feel thankful.
                                    </p>
                                </li>
                            </ul>
                            <p>
                                If there’s one thing we want you to understand about vulnerability reporting, it’s this: however hard your startup has had to struggle to get press and attention, no practicing security researcher has had to work 1/100th as hard to get in the mainstream press. For a myriad of reasons, some good, many bad, everything security researchers do is newsworthy. They’ve drawn KK to your A7 suited. Don’t overplay it.
                            </p>
                            <h3>
                                Step 3: Everything You Need To Know About Vulnerabilities In Two Bullets
                            </h3>
                            <p>
                                There’s a sprawling literature about different kinds of security flaws. You can safely ignore it. If you try to stay up to speed, you’ll still lose, but you’ll miss the simple stuff. You only need to know two things, and here they are:
                            </p>
                            <p>
                                <strong>Bullet 1</strong>: Counting is scary. Many billions of dollars have been spilled dealing with one basic problem, which is that it’s hard to keep track of memory. If you understand this, you understand stack overflows, heap overflows, integer overflows, integer underflows, uninitialized variables, offset null-pointer attacks, and even that crazy pulseaudio Linux kernel flaw that depends on a compiler optimization.
                            </p>
                            <p>
                                <strong>Bullet 2</strong>: Content is scary. Many billions of dollars have been spilled dealing with one basic problem, which is that it’s hard to keep metacharacters out of user-controlled content that moves between different domains. If you understand this, you understand cross-site scripting, SQL injection, shell injection, xpath injection, and Nate McFeters GIFAR attack.
                            </p>
                            <p>
                                And so:
                            </p>
                            <ul>
                                <li>Initialize your variables to 0 or the empty string.
                                </li>
                                <li>Abort your program when malloc fails.
                                </li>
                                <li>Count, using unsigned integers, and don’t let them wrap.
                                </li>
                                <li>Whitelist content to alphanumeric.
                                </li>
                                <li>Swap punctuation for HTML entities.
                                </li>
                                <li>Go live your life.
                                </li>
                            </ul>
                            <p>
                                But, but, but! What about that Black Hat talk that Mark Dowd gave about the plug-in interfaces in all those browsers? What about that crazy Flash exploit he wrote? Those were cool. They made waves in the security industry. <em>But they weren’t about you</em>. His audience is security researchers, not indie startups.
                            </p>
                            <h3>
                                Step 4: Seven Deadly Features Of Indie Software
                            </h3>
                            <p>
                                Here are 7 features that you simply shouldn’t implement yourself.
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        Encryption, unless it’s GPG for data at rest, or SSL for data in motion.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Password storage, unless it’s bcrypt.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Writing anything directly into the DOM of a browser via a plugin or any third-party software.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Installers.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Things that listen on network ports when your code is running, or (just as likely) all the time. Even —- no, wait, especially —- if it’s a web server.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Content-controlled code. For instance, if you’re designing a web templating system for a PHP app, the templating language <em>cannot be PHP</em>.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        File download or, worse, upload.
                                    </p>
                                </li>
                            </ol>
                            <p>
                                People hear this list and they think we mean “be really careful when you implement these features”. We do not mean “be really careful”. We mean “don’t do it”. Change your app design so it doesn’t need the feature. If you can’t get dodge the feature, find its best-known, most-beloved implementation, and use that instead.
                            </p>
                            <h3>
                                Step 5: Deploy Rubber Chicken Security
                            </h3>
                            <p>
                                Here are some security features that don’t really do anything for your security, but that you should consider doing anyways:
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        Big long random URLs. Nothing says “security” like a big long random URL.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        SSL. Use it wherever you can, and then you get to put the little graf on your “security” page about how you use “the same kind of security that banks use”.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Little lock icons.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Encoded inputs and outputs. Don’t just stop at Base64; jumble the Base64 character set up, so when people decode it, it looks like it’s been encrypted.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Encryption. Wait, didn’t we just say not to use encryption? Yes. Don’t rely on encryption. Don’t care about the encryption. But do scramble things. And don’t just use AES; add or subtract a couple of rounds (a 1-line change in your AES code), so that a standard AES implementation won’t decrypt things properly.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Write things in a “safe” scripting language instead of C.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Buy “Hacker-Safe” certification, or get PCI certified, so you can put a little seal on your site.
                                    </p>
                                </li>
                            </ol>
                            <p>
                                None of these things really protect you. For every item on this list, there’s a domain-specific threat that’s far more important than what that feature is trying to address. Some of these features do nothing for you whatsoever.
                            </p>
                            <p>
                                But that doesn’t mean you shouldn’t take advantage of them. Some of them improve your marketing. Some of them raise the bar, very slightly, on finding flaws in your site, which may somewhat improve the quality of security researchers you deal with. Just don’t talk about this stuff in arguments with security people, and you’ll be fine.
                            </p>
                            <h3>
                                Step 6: Fuzz
                            </h3>
                            <p>
                                And now it’s time for Secrets of the Security Masters.
                            </p>
                            <p>
                                Every year, the security industry gets together at Caesar’s Palace in Vegas for Black Hat, the most important conference in software security. A huge chunk of the vulnerability research community submits talks. Most of these talks get significant press. And 50% of them follow a predictable pattern:
                            </p>
                            <ul>
                                <li>
                                    <p>
                                        Here is a new technology that is in the news or that secretly controls our lives.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Here is the fuzzer I wrote for this important technology.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Here are the horrible flaws I found when I ran that fuzzer.
                                    </p>
                                </li>
                            </ul>
                            <p>
                                (Hey, we’re guilty as charged here).
                            </p>
                            <p>
                                What’s a fuzzer? Very simple. A fuzzer is something that knows how to talk to something else, using a protocol or a file format or an SDK, and that systematically replaces parts of the input with progressively scarier inputs —- long strings, SQL metacharacters, long strings seperated by various forms of punctuation, long strings seperated by SQL metacharacters, the 4 numbers clustered around every bit position in 16, 32, and 64 bit numbers, and so on.
                            </p>
                            <p>
                                You’re a software developer. You can write this code. For instance, part of your application handles vCard contacts. Write the vCard contact fuzzer. Run it against your application. If you wrote your fuzzer the same way most consultants write theirs, it will take a day or so to run. Fix what it finds.
                            </p>
                            <p>
                                If you’re a web developer, you’re in luck. Somebody wrote a really good fuzzer you can just go buy for a couple hundred bucks. It’s called <a href="http://www.portswigger.net/suite/">Burp Suite</a>. You can about the “Proxy History”, “Repeater”, and “Intruder” tabs. Buy it, run your application through it, and figure out how to use those these Burp features. Cover every input in your application. That’s almost 90% of what every pro web-app pentester is going to do.
                            </p>
                            <p>
                                (You want the commercial version, not the free version.)
                            </p>
                            <h3>
                                Step 7: Your Code Isn’t A Secret
                            </h3>
                            <p>
                                This last point is easy, and you’re probably already on the same page as us.
                            </p>
                            <p>
                                A couple years back, Nate Lawson reverse-engineered the Bay Area FasTrak tolling system, which uses an RF protocol to tell tollbooths to debit your toll account. To pull this off, Nate got a FasTrak dongle and reversed the hardware, at one point going as far as decapping the chip to enable the JTAG debugging interface.
                            </p>
                            <p>
                                Nate Lawson is an extremely smart guy. But he has a bill rate. He’s part of this industry. Any company that wants to work with him can pay him, and he’ll do that same stuff to whatever app they sicc him on.
                            </p>
                            <p>
                                My point here, and I do have one, is that you are doomed. The state of the art in reverse engineering has advanced to the point where, on general-purpose computers, it’s mostly point-and-click.
                            </p>
                            <p>
                                Nothing in your software should depend on the security of your source code. Even more importantly, you can’t fetishize your source code. If you communicate to the world that your code is hard to reverse engineer, then it’s a “win” for a security researcher just to have reversed it, whether or not they find anything interesting from doing so.
                            </p>
                            <p>
                                If you’re shipping code written in anything other than C, you should understand that you have shipped your source code. Even if you ran it through an obfuscation product of some sort (another rubber chicken). An easy way to absolutely convince people who know security that you don’t know anything about security is to make an argument that involves how hard it would really be for an attacker to figure out how your software works.
                            </p>
                            <h3>
                                Step 8: And that’s it.
                            </h3>
                            <p>
                                We’re short some steps, and that’s because for an indie development shop, those steps don’t matter. So few people are getting this stuff right that it seems pointless to talk about the rest of it. And that’s sad, because what our program recommends costs almost nothing, doesn’t involve certification or third-party testing, and immediately improves outcomes in security incidents.
                            </p>
                            <p>
                                Stop freaking out about security. You’re worrying about the wrong things anyways. Get this simple stuff right, and then get on with your life.
                            </p>
                            <h3>
                                Some quick caveats about the talk itself:
                            </h3>
                            <ul>
                                <li>
                                    <p>
                                        We gave this talk a year ago.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        We went back and annotated the slides, which really don’t stand by themselves, and we know that too.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        YES I HAVE ARMS. It was the only clean button-up shirt I had that day.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Again, this is a talk aimed at indie Mac developers. If you’re a large ISV, a bank, a Fortune 500 company, we know: you do not want, you cannot use.
                                    </p>
                                </li>
                            </ul>
                        </blockquote>
                    </div>
                    <p class="bookmark-source">
                        Source: <a href="http://chargen.matasano.com/chargen/2009/9/24/indie-software-security-a-12-step-program.html">http://chargen.matasano.com/chargen/2009/9/24/indie-software-security-a-12-step-program.html</a>
                    </p>
                </div>
            </article>

            <nav id="post-nav">


            </nav>
        </section>

        <footer id="site-footer" class="nocontent">
            <p>
                This site is purely my personal work and does not reflect the
                views of my employer.
            </p>
            <p class="license">
                <a class="icon" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width: 0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a>
                This work is licensed under a
                <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported
                    License</a>.
            </p>
        </footer>

        <script async src="/static/js/common.js"></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js" integrity="sha256-hj+5FRlAuvAFANiefn0PpJYCkV1X4QT9EgiPd+6QnCw=" crossorigin="anonymous"></script>
    </body>
</html>
