<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>
            Released the Luggage
        </title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="/static/css/main.min.css" type="text/css" media="all"><!--[if lte IE 8]>
            <link rel="stylesheet" href="/static/css/ie-fixes.css" type="text/css" media="all">
            <script src="/static/js/html5shiv.js"></script>
        <![endif]-->
        <meta http-equiv="last-modified" content="Tue, 13 Oct 2009 05:37:47 GMT">
        <link rel="alternate" type="application/atom+xml" title="All Posts (Atom)" href="/feeds/all.atom">
        <link rel="alternate" type="application/rss+xml" title="All Posts (RSS)" href="/feeds/all.rss">
        <link rel="icon" type="image/jpeg" sizes="287x287" href="/static/img/favicon-287x287.jpg">
        <link rel="icon" type="image/jpeg" sizes="128x128" href="/static/img/favicon-128x128.jpg">
        <script type="application/javascript">
var _prum={id:"5166be01e6e53d1007000001"};var PRUM_EPISODES=PRUM_EPISODES||{};PRUM_EPISODES.q=[];PRUM_EPISODES.mark=function(b,a){PRUM_EPISODES.q.push(["mark",b,a||new Date().getTime()])};PRUM_EPISODES.measure=function(b,a,b){PRUM_EPISODES.q.push(["measure",b,a,b||new Date().getTime()])};PRUM_EPISODES.done=function(a){PRUM_EPISODES.q.push(["done",a])};PRUM_EPISODES.mark("firstbyte");(function(){var b=document.getElementsByTagName("script")[0];var a=document.createElement("script");a.type="text/javascript";a.async=true;a.charset="UTF-8";a.src="//rum-static.pingdom.net/prum.min.js";b.parentNode.insertBefore(a,b)})();
        </script>
    </head>
    <body class="blog post_detail" itemscope itemtype="http://schema.org/BlogPosting">
        <nav id="site-nav">
            <header id="about">
                <h1>
                    <a href="/about/">Chris Adams</a>
                </h1>
                <h2>
                    Programmer, cyclist, photographer
                </h2>
            </header>
            <ul class="links">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li>
                    <a href="/feeds/all.atom" title="Site Feed">Site Feed</a>
                </li>
            </ul>
            <ul class="social-networks">
                <li>
                    <a href="https://github.com/acdha" rel="me">Github</a>
                </li>
                <li>
                    <a href="http://bitbucket.org/acdha" rel="me">Bitbucket</a>
                </li>
                <li>
                    <a href="http://delicious.com/acdha" rel="me">del.icio.us</a>
                </li>
                <li>
                    <a href="http://twitter.com/acdha" rel="me">Twitter</a>
                </li>
                <li>
                    <a href="https://plus.google.com/116562742092842686896?rel=author" rel="me">Google+</a>
                </li>
                <li>
                    <a href="http://www.flickr.com/photos/acdha" rel="me">Flickr</a>
                </li>
                <li>
                    <a href="http://www.linkedin.com/in/acdha" rel="me">LinkedIn</a>
                </li>
                <li>
                    <a href="http://connect.garmin.com/explore?owner=acdha" rel="me">Garmin Connect</a>
                </li>
            </ul>
            <div id="site-search"></div>
        </nav>
        <section id="main">
            <article class="post">
                <header>
                    <meta itemprop="dateCreated" content="2009-10-13T01:37:00-04:00">
                    <meta itemprop="dateModified" content="2009-10-13T01:37:00-04:00"><time class="date" itemprop="datePublished" datetime="2009-10-13T05:37:00+00:00">Oct 13</time>
                    <h2 itemprop="title">
                        Released the Luggage
                    </h2>
                </header>
                <div class="body" itemprop="articleBody">
                    <div class="googlereader description" data-google-id="tag:google.com,2005:reader/item/8580cd31cfecddae">
                        <blockquote>
                            I've been rewriting a tool I originally wrote when I was at Google that allows you to generate an OS X pkg file using a Makefile without using PackageMaker.app's gui at all. At Google we used the internal tool to create most of the packages we used to create disk images with InstaDMG or with puppet. After I left, I missed it, so I'm releasing my rewrite, the Luggage, with the Apache 2.0 license. The source is at&nbsp;<a href="http://github.com/unixorn/luggage">http://github.com/unixorn/luggage</a><br>
                            <br>
                            <span style="color:#5064ae;font-family:'Trebuchet MS', arial, sans-serif;font-size:23px;letter-spacing:2px;line-height:19px">What the Luggage provides</span><br>
                            <br>
                            <div>
                                Easy repackaging of GUI apps that don't come with Apple pkg installers,&nbsp;custom scripts and configuration files,&nbsp;payload-less packages that do settings changes on target machines in their postflight/postupdate scripts. These packages are easily used in InstaDMG to create master disk images for deployment, or system management systems like puppet to distribute new software to managed Macintoshes.
                            </div>
                            <h2 style="color:#5064ae;font-family:'Trebuchet MS', arial, sans-serif;font-size:1.8em;font-weight:normal;letter-spacing:0.1em">
                                <a href="http://havegnuwilltravel.apesseekingknowledge.net/" name="TOC-How-it-works" style="color:#445aa9" id="TOC-How-it-works"></a>How it works
                            </h2>
                            <div>
                                You create a Makefile describing where you want each file in the package to end up on the target machines. luggage.make includes rules that will generate a package root with appropriate permissions, copy the files into place, create a package version-stamped with the date, then wrap the package in a disk image file.
                            </div>
                            <h2 style="color:#5064ae;font-family:'Trebuchet MS', arial, sans-serif;font-size:1.8em;font-weight:normal;letter-spacing:0.1em">
                                <a href="http://havegnuwilltravel.apesseekingknowledge.net/" name="TOC-So-how-do-I-use-it-" style="color:#445aa9" id="TOC-So-how-do-I-use-it-"></a>So how do I use it?
                            </h2>
                            <h3 style="border-bottom-color:rgb(201, 208, 230);border-bottom-style:dotted;border-bottom-width:1px;color:#777777;font-family:'Trebuchet MS', arial, sans-serif;font-size:1.4em;font-weight:normal">
                                <a href="http://havegnuwilltravel.apesseekingknowledge.net/" name="TOC-Requirements-for-all-Makefiles" style="color:#445aa9" id="TOC-Requirements-for-all-Makefiles"></a>Requirements for all Makefiles
                            </h3>
                            <div>
                                Every package makefile must include luggage.make, specify a title for the package, a base reversed domain for creating the package id, and the payload listing which files we want installed by the package. Include luggage.make before your variable declarations so your declarations override the internal ones in luggage.make. Please note that TITLE must not include spaces - it's going to be used as part of the package id. Also remember to include luggage.make before any of your definitions so your definitions override the defaults.
                            </div>
                            <div>
                                <br>
                            </div>
                            <div>
                                <pre style="font-family:'Bitstream Vera Sans Mono', Courier, monospace;font-size:12px;line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px">

</pre>
                                <div style="line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:1em;padding-right:0px;padding-top:0px">
                                    <span style="font-family:Monaco, 'Courier New', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', monospace;font-size:11px;line-height:14px"><code style="color:#006000">include /usr/local/share/luggage/luggage.make</code></span>
                                </div>
                                <div style="line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:1em;padding-right:0px;padding-top:0px">
                                    <span style="font-family:Monaco, 'Courier New', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', monospace;font-size:11px;line-height:14px"><code style="color:#006000">&nbsp;</code></span>
                                </div>
                                <div style="line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:1em;padding-right:0px;padding-top:0px">
                                    <span style="font-family:Monaco, 'Courier New', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', monospace;font-size:11px;line-height:14px"><code style="color:#006000">TITLE=install_foo</code></span>
                                </div>
                                <div style="line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:1em;padding-right:0px;padding-top:0px">
                                    <span style="font-family:Monaco, 'Courier New', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', monospace;font-size:11px;line-height:14px"><code style="color:#006000">REVERSE_DOMAIN=com.example.corp</code></span>
                                </div>
                                <div style="line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:1em;padding-right:0px;padding-top:0px">
                                    <span style="font-family:Monaco, 'Courier New', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', monospace;font-size:11px;line-height:14px"><code style="color:#006000">PAYLOAD=</code></span>
                                </div>
                            </div>
                            <h3 style="border-bottom-color:rgb(201, 208, 230);border-bottom-style:dotted;border-bottom-width:1px;color:#777777;font-family:'Trebuchet MS', arial, sans-serif;font-size:1.4em;font-weight:normal">
                                <a href="http://havegnuwilltravel.apesseekingknowledge.net/" name="TOC-Creating-a-package-for-a-GUI-Applic" style="color:#445aa9" id="TOC-Creating-a-package-for-a-GUI-Applic"></a>Creating a package for a GUI Application
                            </h3>
                            <div>
                                For our first example, we're going to repackage a GUI application that didn't come with a PKG installer. First, tar up the application (making sure to use Apple's tar so resource forks don't get mangled) with<code style="color:#006000">&nbsp;/usr/bin/tar cvj Foo.app.tar.bz Foo.app</code>, then update PAYLOAD with<br>
                            </div>
                            <div>
                                <pre style="font-family:'Bitstream Vera Sans Mono', Courier, monospace;font-size:12px;line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px">

</pre>
                                <div style="line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:1em;padding-right:0px;padding-top:0px">
                                    <span style="font-family:Monaco, 'Courier New', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', monospace;font-size:11px;line-height:14px"><span style="color:#006000;font-family:monospace, Courier, monospace"><br></span></span>
                                </div>
                                <div style="line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:1em;padding-right:0px;padding-top:0px">
                                    <code style="color:#006000">PAYLOAD=unbz2-applications-foo.app</code>
                                </div>
                                <pre>

</pre>
                                <pre style="font-family:'Bitstream Vera Sans Mono', Courier, monospace;font-size:12px;line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px">
<span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal;white-space:normal"><br></span></span></span>
</pre>
                                <pre>
This tells luggage.make that we want Foo.app.tar.bz2 untarred into /Applications. If we want it installed in /Applications/Utilities instead, we'd use<code style="color:#006000">unbz2-utilities-foo.app</code> instead, Now we can create a package with "<code style="color:#006000">make pkg</code>", or have it automatically wrapped in a disk image with "<code style="color:#006000">make dmg</code>". That's all it takes.
</pre>
                                <h3 style="border-bottom-color:rgb(201, 208, 230);border-bottom-style:dotted;border-bottom-width:1px;color:#777777;font-family:'Trebuchet MS', arial, sans-serif;font-size:1.4em;font-weight:normal">
                                    <span style="font-family:Arial, Verdana, sans-serif;font-size:small"><a href="http://havegnuwilltravel.apesseekingknowledge.net/" name="TOC-Packaging-scripts-and-configuration" style="color:#445aa9" id="TOC-Packaging-scripts-and-configuration"></a>Packaging scripts and configuration files</span>
                                </h3>
                            </div>
                            <div>
                                <span style="font-family:Monaco, 'Courier New', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', monospace;font-size:11px;line-height:14px"><span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal">Similarly, if you want to install bar as /usr/local/bin/bar, add pack-usr-local-bin-bar to PAYLOAD.&nbsp;</span></span><br></span>
                                <h3 style="border-bottom-color:rgb(201, 208, 230);border-bottom-style:dotted;border-bottom-width:1px;color:#777777;font-family:'Trebuchet MS', arial, sans-serif;font-size:1.4em;font-weight:normal">
                                    <span style="font-family:Arial, Verdana, sans-serif;font-size:small"><a href="http://havegnuwilltravel.apesseekingknowledge.net/" name="TOC-Available-PAYLOAD-additions" style="color:#445aa9" id="TOC-Available-PAYLOAD-additions"></a>Available PAYLOAD additions</span>
                                </h3>
                                <pre style="font-family:'Bitstream Vera Sans Mono', Courier, monospace;font-size:12px;line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px">

</pre>
                                <table border="1" cellspacing="0" style="border-bottom-color:rgb(136, 136, 136);border-bottom-width:1px;border-collapse:collapse;border-left-color:rgb(136, 136, 136);border-left-width:1px;border-right-color:rgb(136, 136, 136);border-right-width:1px;border-top-color:rgb(136, 136, 136);border-top-width:1px;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px">
                                    <tbody>
                                        <tr>
                                            <td>
                                                <br>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:256px">
                                                &nbsp;<b>Rule</b>
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:88px">
                                                <b>&nbsp;Ownership</b>
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:91px">
                                                <b>&nbsp;Permissions</b>
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:386px">
                                                <b>&nbsp;Destination</b>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <br>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:256px">
                                                &nbsp;pack-etc-foo
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:88px">
                                                &nbsp;root:wheel
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:91px">
                                                &nbsp;644
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:386px">
                                                &nbsp;/etc/foo
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <br>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:256px">
                                                &nbsp;pack-usr-bin-foo
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:88px">
                                                &nbsp;root:wheel
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:91px">
                                                &nbsp;755
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:386px">
                                                &nbsp;/usr/bin/foo
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <br>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:256px">
                                                &nbsp;pack-usr-sbin-foo
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:88px">
                                                &nbsp;root:wheel
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:91px">
                                                &nbsp;755
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:386px">
                                                &nbsp;/usr/sbin/foo
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <br>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="height:18px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:256px">
                                                &nbsp;pack-usr-local-bin-foo
                                            </td>
                                            <td style="height:18px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:88px">
                                                &nbsp;root:wheel
                                            </td>
                                            <td style="height:18px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:91px">
                                                &nbsp;755
                                            </td>
                                            <td style="height:18px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:386px">
                                                &nbsp;/usr/local/bin/foo
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <br>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:256px">
                                                &nbsp;pack-usr-local-sbin-foo
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:88px">
                                                &nbsp;root:wheel
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:91px">
                                                &nbsp;755
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:386px">
                                                &nbsp;/usr/local/sbin/foo
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <br>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:256px">
                                                &nbsp;pack-hookscript-foo
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:88px">
                                                &nbsp;root:wheel
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:91px">
                                                &nbsp;755
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:386px">
                                                &nbsp;/etc/hooks/foo
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <br>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="height:20px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:256px">
                                                &nbsp;pack-Library-LaunchAgents-foo
                                            </td>
                                            <td style="height:20px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:88px">
                                                &nbsp;root:wheel
                                            </td>
                                            <td style="height:20px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:91px">
                                                &nbsp;644
                                            </td>
                                            <td style="height:20px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:386px">
                                                &nbsp;/Library/LaunchAgents/foo
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <br>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:256px">
                                                &nbsp;pack-Library-LaunchDaemons-foo
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:88px">
                                                &nbsp;root:wheel
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:91px">
                                                &nbsp;644
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:386px">
                                                &nbsp;/Library/LaunchDaemons/foo
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <br>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:256px">
                                                &nbsp;pack-Library-Preferences-foo
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:88px">
                                                &nbsp;root:admin
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:91px">
                                                &nbsp;644
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:386px">
                                                &nbsp;/Library/Preferences/foo
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <br>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:256px">
                                                &nbsp;pack-ppd-foo
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:88px">
                                                &nbsp;root:admin
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:91px">
                                                &nbsp;644
                                            </td>
                                            <td style="height:14px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:386px">
                                                &nbsp;/Library/Printers/PPDs/Contents/Resources/foo
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <br>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="height:29px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:256px">
                                                &nbsp;pack-user-template-plist-foo
                                            </td>
                                            <td style="height:29px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:88px">
                                                &nbsp;root:wheel
                                            </td>
                                            <td style="height:29px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:91px">
                                                &nbsp;644
                                            </td>
                                            <td style="height:29px;padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top;width:386px">
                                                &nbsp;/System/Library/User\ Template/English.lproj/Library/Preferences/foo
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <br>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top">
                                                &nbsp;unbz2-applications-foo
                                            </td>
                                            <td style="padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top">
                                                &nbsp;root:admin
                                            </td>
                                            <td style="padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top">
                                                &nbsp;based on tarball contents
                                            </td>
                                            <td style="padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top">
                                                &nbsp;/Applications/Foo
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <br>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top">
                                                &nbsp;ungz-applications-foo
                                            </td>
                                            <td style="padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top">
                                                &nbsp;root:admin
                                            </td>
                                            <td style="padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top">
                                                &nbsp;based on tarball contents
                                            </td>
                                            <td style="padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top">
                                                &nbsp;/Applications/Foo
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <br>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top">
                                                &nbsp;unbz2-utilities-foo
                                            </td>
                                            <td style="padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top">
                                                &nbsp;root:admin
                                            </td>
                                            <td style="padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top">
                                                &nbsp;based on tarball contents
                                            </td>
                                            <td style="padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top">
                                                &nbsp;/Applications/Utilities/Foo
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <br>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top">
                                                &nbsp;ungz-utilities-foo
                                            </td>
                                            <td style="padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top">
                                                &nbsp;root:admin
                                            </td>
                                            <td style="padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top">
                                                &nbsp;based on tarball contents
                                            </td>
                                            <td style="padding-bottom:1px;padding-left:4px;padding-right:4px;padding-top:1px;vertical-align:top">
                                                &nbsp;/Applications/Utilities/Foo
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <br>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <h3 style="border-bottom-color:rgb(201, 208, 230);border-bottom-style:dotted;border-bottom-width:1px;color:#777777;font-family:'Trebuchet MS', arial, sans-serif;font-size:1.4em;font-weight:normal">
                                    <a href="http://havegnuwilltravel.apesseekingknowledge.net/" name="TOC-Adding-preflight-postflight-postins" style="color:#445aa9" id="TOC-Adding-preflight-postflight-postins"></a><span style="font-family:verdana, sans-serif">Adding preflight/postflight/postinstall/postupdate scripts</span>
                                </h3>
                                <pre style="font-family:'Bitstream Vera Sans Mono', Courier, monospace;font-size:12px;line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px">
<span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal;white-space:normal">Name the script preflight, postflight, postinstall, or postupdate, then add pack-script-XX to PAYLOAD and it will automatically be added to the final package.</span></span>
</pre>
                                <pre style="font-family:'Bitstream Vera Sans Mono', Courier, monospace;font-size:12px;line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px">

</pre>
                                <h2 style="color:#5064ae;font-family:'Trebuchet MS', arial, sans-serif;font-size:1.8em;font-weight:normal;letter-spacing:0.1em">
                                    <span style="font-family:Arial, Verdana, sans-serif;font-size:small"><a href="http://havegnuwilltravel.apesseekingknowledge.net/" name="TOC-Make-targets" style="color:#445aa9" id="TOC-Make-targets"></a>Make targets</span>
                                </h2>
                                <div>
                                    <ul>
                                        <li style="list-style-position:outside;list-style-type:square">
                                            <span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-family:Arial, Verdana, sans-serif;font-size:13px;line-height:normal">make dmg - create a package, then wrap it in a dmg. Result will be in the current directory.</span></span>
                                        </li>
                                        <li style="list-style: none">
                                            <br>
                                        </li>
                                        <li style="list-style-position:outside;list-style-type:square">
                                            <span style="font-family:Arial, Verdana, sans-serif;font-size:13px;line-height:normal">make pkg - create a package and copy it into the current directory</span>
                                        </li>
                                        <li style="list-style: none">
                                            <br>
                                        </li>
                                        <li style="list-style-position:outside;list-style-type:square">
                                            <span style="font-family:Arial, Verdana, sans-serif;font-size:13px;line-height:normal">make pkgls - create a package, then list the contents so you can confirm it's generating a package with a payload that matches what you're expecting.</span>
                                        </li>
                                        <li style="list-style: none">
                                            <br>
                                        </li>
                                    </ul>
                                </div>
                                <h2 style="color:#5064ae;font-family:'Trebuchet MS', arial, sans-serif;font-size:1.8em;font-weight:normal;letter-spacing:0.1em">
                                    <a href="http://havegnuwilltravel.apesseekingknowledge.net/" name="TOC-Customizing-your-packages" style="color:#445aa9" id="TOC-Customizing-your-packages"></a><span style="font-family:verdana, sans-serif">Customizing your packages</span>
                                </h2>
                                <h3 style="border-bottom-color:rgb(201, 208, 230);border-bottom-style:dotted;border-bottom-width:1px;color:#777777;font-family:'Trebuchet MS', arial, sans-serif;font-size:1.4em;font-weight:normal">
                                    <a href="http://havegnuwilltravel.apesseekingknowledge.net/" name="TOC-How-do-I-add-a-file-to-my-package-t" style="color:#445aa9" id="TOC-How-do-I-add-a-file-to-my-package-t"></a><span style="font-family:verdana, sans-serif">How do I add a file to my package that is installed somewhere luggage.make doesn't cover?</span>
                                </h3>
                                <div>
                                    <span style="font-size:13px"><span style="font-family:Arial, Verdana, sans-serif"><span style="line-height:normal">luggage.make defines several convenience targets that create various directory paths within the package root. You can use them to create the parent directory for your target location, then create your target location. Here's an example that creates /etc/cups so you can install a custom cupsd.conf</span></span></span>
                                </div>
                                <div>
                                    <span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal"><br></span></span>
                                </div>
                                <div style="background-color:#efefef;border-bottom-color:rgb(211, 211, 211);border-bottom-style:solid;border-bottom-width:1px;border-left-color:rgb(211, 211, 211);border-left-style:solid;border-left-width:1px;border-right-color:rgb(211, 211, 211);border-right-style:solid;border-right-width:1px;border-top-color:rgb(211, 211, 211);border-top-style:solid;border-top-width:1px;display:block;line-height:11px;padding-bottom:0.5em;padding-left:1em;padding-right:0px;padding-top:0.5em">
                                    <div>
                                        <span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal"><code style="color:#006000">l_cups: l_etc</code></span></span>
                                    </div>
                                    <div>
                                        <span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal"><span><code style="color:#006000">&nbsp;&nbsp; &nbsp;@sudo mkdir ${WORK_D}/etc/cups</code></span><br></span></span>
                                    </div>
                                    <div>
                                        <span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal"><span><code style="color:#006000">&nbsp;&nbsp; &nbsp;@sudo chown root:_lp ${WORK_D}/etc/cups</code></span><br></span></span>
                                    </div>
                                    <div>
                                        <span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal"><span><code style="color:#006000">&nbsp;&nbsp; &nbsp;@sudo chmod 755 ${WORK_D}/etc/cups</code></span><br></span></span>
                                    </div>
                                    <div>
                                        <span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal"><br></span></span>
                                    </div>
                                    <div>
                                        <span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal"><code style="color:#006000">pack-cupsd.conf: l_cups</code></span></span>
                                    </div>
                                    <div>
                                        <span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal"><span><code style="color:#006000">&nbsp;&nbsp; &nbsp;@sudo ${CP} cupsd.conf ${WORK_D}/etc/cups</code></span><br></span></span>
                                    </div>
                                    <div>
                                        <span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal"><span><code style="color:#006000">&nbsp;&nbsp; &nbsp;@sudo chown root:_lp ${WORK_D}/etc/cups/cupsd.conf</code></span><br></span></span>
                                    </div>
                                    <div>
                                        <span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal"><span><code style="color:#006000">&nbsp;&nbsp; &nbsp;@sudo chmod 644 ${WORK_D}/etc/cups/cupsd.conf</code></span><br></span></span>
                                    </div>
                                </div><span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal"><br></span></span>
                                <div>
                                    <span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal">Now all you need to do is add pack-cupsd.conf to your PAYLOAD variable, and make will create /etc/cups in your package root, change the permissions and ownership, then copy in your cupsd.conf.</span></span>
                                </div>
                                <h2 style="color:#5064ae;font-family:'Trebuchet MS', arial, sans-serif;font-size:1.8em;font-weight:normal;letter-spacing:0.1em">
                                    <a href="http://havegnuwilltravel.apesseekingknowledge.net/" name="TOC-I-need-to-install-foo-with-permissi" style="color:#445aa9" id="TOC-I-need-to-install-foo-with-permissi"></a><span style="color:#777777;font-size:18px;letter-spacing:normal;line-height:normal">I need to install foo with permissions different from the defaults luggage.make uses. How do I change the ownership/permissions for files installed using luggage.make?</span>
                                </h2>
                                <pre style="font-family:'Bitstream Vera Sans Mono', Courier, monospace;font-size:12px;line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px">
<span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal;white-space:normal">You could make your changes using a postflight script, but for convenience, luggage.make runs <code style="color:#006000">make modify_packageroot</code> after it has created the package root and copied the install files there, but before it invokes packagemaker's command line tool to create the package.</span></span>
</pre>
                                <pre style="font-family:'Bitstream Vera Sans Mono', Courier, monospace;font-size:12px;line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px">
<span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal;white-space:normal"><br></span></span>
</pre>
                                <pre style="font-family:'Bitstream Vera Sans Mono', Courier, monospace;font-size:12px;line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px">
<span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal;white-space:normal">If you add that target to your package's Makefile, it will override the dummy one in luggage.make and let you change the permissions of files in your package root. <code style="color:#006000">${WORK_D}</code> contains the path to your package root. For example, if your package installed a modified cupsd.conf to /etc/cups, and you needed it to have a group of _lp, you would add the following to your package Makefile:</span></span>
</pre>
                                <div style="background-color:#efefef;border-bottom-color:rgb(211, 211, 211);border-bottom-style:solid;border-bottom-width:1px;border-left-color:rgb(211, 211, 211);border-left-style:solid;border-left-width:1px;border-right-color:rgb(211, 211, 211);border-right-style:solid;border-right-width:1px;border-top-color:rgb(211, 211, 211);border-top-style:solid;border-top-width:1px;display:block;line-height:11px;padding-bottom:0.5em;padding-left:1em;padding-right:0px;padding-top:0.5em">
                                    <pre style="font-family:'Bitstream Vera Sans Mono', Courier, monospace;font-size:12px;line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px">
<span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal;white-space:normal"><code style="color:#006000">modify_packageroot:</code></span></span>
</pre>
                                    <pre style="font-family:'Bitstream Vera Sans Mono', Courier, monospace;font-size:12px;line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px">
<span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal;white-space:normal"><span><code style="color:#006000">    @sudo chgrp _lp ${WORK_D}/etc/cups/cupsd.conf</code></span></span></span>
</pre>
                                </div>
                                <h3 style="border-bottom-color:rgb(201, 208, 230);border-bottom-style:dotted;border-bottom-width:1px;color:#777777;font-family:'Trebuchet MS', arial, sans-serif;font-size:1.4em;font-weight:normal">
                                    <a href="http://havegnuwilltravel.apesseekingknowledge.net/" name="TOC-I-don-t-want-the-package-version-to" style="color:#445aa9" id="TOC-I-don-t-want-the-package-version-to"></a><span style="font-family:verdana, sans-serif">I don't want the package version to be based on the current date. How can I force it to something specific?</span>
                                </h3>
                                <pre style="font-family:'Bitstream Vera Sans Mono', Courier, monospace;font-size:12px;line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px">
<span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal;white-space:normal">By default, luggage.make sets the version number to YYYYMMDD. If you prefer to set it to something specific, set PACKAGE_VERSION=something_numeric.</span></span>
</pre>
                                <h2 style="color:#5064ae;font-family:'Trebuchet MS', arial, sans-serif;font-size:1.8em;font-weight:normal;letter-spacing:0.1em">
                                    <a href="http://havegnuwilltravel.apesseekingknowledge.net/" name="TOC-FAQ" style="color:#445aa9" id="TOC-FAQ"></a><span style="font-family:verdana, sans-serif">FAQ</span>
                                </h2>
                                <h3 style="border-bottom-color:rgb(201, 208, 230);border-bottom-style:dotted;border-bottom-width:1px;color:#777777;font-family:'Trebuchet MS', arial, sans-serif;font-size:1.4em;font-weight:normal">
                                    <a href="http://havegnuwilltravel.apesseekingknowledge.net/" name="TOC-My-makefile-looks-ok-but-I-get-an-e" style="color:#445aa9" id="TOC-My-makefile-looks-ok-but-I-get-an-e"></a><span style="font-family:verdana, sans-serif">My makefile looks ok, but I get an error about a missing separator</span>
                                </h3>
                                <pre style="font-family:'Bitstream Vera Sans Mono', Courier, monospace;font-size:12px;line-height:1.4em;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px">
<span style="font-family:Arial, Verdana, sans-serif;font-size:small"><span style="font-size:13px;line-height:normal;white-space:normal">You've probably indented your rules with spaces rather than a tab. Make requires the indentation be with tabs.</span></span>
</pre>
                            </div>
                            <div>
                                <hr>
                                <a href="http://HaveGNUWillTravel.ApesSeekingKnowledge.net">Have GNU, Will Travel.</a><img width="1" height="1" src="https://blogger.googleusercontent.com/tracker/10772591-3458651231341980531?l=havegnuwilltravel.apesseekingknowledge.net" alt="">
                            </div>
                        </blockquote>
                    </div>
                    <p class="bookmark-source">
                        Source: <a href="http://havegnuwilltravel.apesseekingknowledge.net/2009/10/released-luggage.html">http://havegnuwilltravel.apesseekingknowledge.net/2009/10/released-luggage.html</a>
                    </p>
                </div>
            </article>
            <nav id="post-nav"></nav><script id="discus-javascript">
    var disqus_shortname = 'improbable';

                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    document.getElementsByTagName('body')[0].appendChild(dsq);
                })();
            </script><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            <div id="disqus_thread"></div>
        </section>
        <footer id="site-footer">
            <p>
                This site is purely my personal work and does not reflect the views of my employer.
            </p>
            <p class="license">
                <a class="icon" rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a> This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
            </p>
        </footer><script async="" defer src="/static/js/common.js">
</script><script id="google-analytics">
    var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-2097834-1']);
            _gaq.push(['_setDomainName', 'improbable.org']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
    </body>
</html>
