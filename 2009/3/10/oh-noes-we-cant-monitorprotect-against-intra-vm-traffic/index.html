<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Oh Noes: We Can't Monitor/Protect Against Intra-VM Traffic!</title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="/static/css/main.min.css" type="text/css" media="all">
        <!--[if lte IE 8]>
            <link rel="stylesheet" href="/static/css/ie-fixes.css" type="text/css" media="all">
            <script src="/static/js/html5shiv.js"></script>
        <![endif]-->

        <meta http-equiv="last-modified" content="Tue, 10 Mar 2009 13:59:50 GMT">
        <link rel="alternate" type="application/atom+xml" title="All Posts (Atom)" href="/feeds/all.atom">
        <link rel="alternate" type="application/rss+xml" title="All Posts (RSS)" href="/feeds/all.rss">
        <link rel="icon" type="image/jpeg" sizes="287x287" href="/static/img/favicon-287x287.jpg">
        <link rel="icon" type="image/jpeg" sizes="128x128" href="/static/img/favicon-128x128.jpg">
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-2097834-1', 'auto');
            ga('send', 'pageview');
        </script>
    </head>
    <body class="blog post_detail" itemscope itemtype="http://schema.org/BlogPosting">
        <nav id="site-nav">
            <header id="about">
                <h1><a href="/about/">Chris Adams</a></h1>
                <h2>Programmer, cyclist, photographer</h2>
            </header>
            <ul class="links">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li>
                    <a href="/feeds/all.atom" title="Site Feed">Site Feed</a>
                </li>
            </ul>
            <ul class="social-networks">
                <li>
                    <a href="https://github.com/acdha" rel="me">Github</a>
                </li>
                <li>
                    <a href="https://bitbucket.org/acdha" rel="me">Bitbucket</a>
                </li>
                <li>
                    <a href="https://pinboard.in/u:acdha/" rel="me">Pinboard</a>
                </li>
                <li>
                    <a href="https://twitter.com/acdha" rel="me">Twitter</a>
                </li>
                <li>
                    <a href="https://www.flickr.com/photos/acdha" rel="me">Flickr</a>
                </li>
                <li>
                    <a href="https://www.linkedin.com/in/acdha" rel="me">LinkedIn</a>
                </li>
            </ul>
            <div id="site-search"></div>
        </nav>
        <section id="main">
            <article class="post">
                <header>
                    <meta itemprop="dateCreated" content="2009-03-10T09:39:32-04:00">
                    <meta itemprop="dateModified" content="2009-03-10T09:39:32-04:00">
                    <time class="date" itemprop="datePublished" datetime="2009-03-10T13:39:32+00:00">Mar 10</time>
                    <h2 class="" itemprop="title">Oh Noes: We Can't Monitor/Protect Against Intra-VM Traffic!</h2>
                </header>

                <div class="body" itemprop="articleBody"><div class="googlereader description" data-google-id="tag:google.com,2005:reader/item/0df06b295ae29125">
                        <blockquote>
                            <p>
                                <span style="font-size:13px;font-family:Arial"><span style="font-family:Times;font-size:16px"><a href="http://rationalsecurity.typepad.com/.a/6a00d83451be3669e201127945372028a4-pi" style="float:left"><img alt="Angryguy" src="http://rationalsecurity.typepad.com/.a/6a00d83451be3669e201127945372028a4-200wi" style="width:200px;margin:0px 5px 5px 0px"></a></span> I got a press release in my inbox this morning that made me cringe.  It came from a vendor who produces a "purpose-built virtual firewall."</span>
                            </p>
                            <div>
                                <span><span style="font-size:13px;font-family:'Trebuchet MS'">The press release details a customer case study that I found typical of how security solutions are being marketed in the virtualization space today, which again is really more about visibility than pure "security" and preys mostly on poor planning and fundamental issues stemming from treating "security" like a band-aid instead of an element of enterprise architecture.</span></span>
                            </div><span style="font-size:13px;font-family:'Trebuchet MS'"><br></span>
                            <div>
                                <span style="font-size:13px;font-family:'Trebuchet MS'">When we start to cross the streams as to the realities of virtualization, the security implications thereof and making promises to solve problems with products which may or may not be deserving of investment given an assessment of risk, especially in today's trying economic climate, it makes me cranky.</span>
                            </div><span style="font-size:13px;font-family:'Trebuchet MS'"><br></span>
                            <div>
                                <span style="font-size:13px;font-family:'Trebuchet MS'">I'm just tiring of the mixing of metaphors in the marketing of these "solutions."</span>
                            </div><span style="font-size:13px;font-family:'Trebuchet MS'"><br></span>
                            <div>
                                <span style="font-size:13px;font-family:'Trebuchet MS'">I was specifically annoyed by a couple of statements in the press release and since I haven't had my coffee, I thought I'd point out a few to further underscore what I present in my</span> <a href="http://rationalsecurity.typepad.com/blog/2008/08/complete-slides.html"><span style="font-size:13px;font-family:'Trebuchet MS'">Four Horsemen</span></a> <span style="font-size:13px;font-family:'Trebuchet MS'">presentation regarding where we are in the solution continuum today.</span>
                            </div><span style="font-size:13px;font-family:'Trebuchet MS'"><br></span>
                            <div>
                                <span style="font-size:13px;font-family:'Trebuchet MS'">To wit:<br></span>
                                <blockquote style="margin:0 0 0 40px;border:none;padding:0px">
                                    <p>
                                        <span style="font-size:14px;line-height:normal"><font size="2" style="font-size:11pt"><span style="font-size:13px"><span style="font-style:italic"><span style="font-weight:bold"><span style="font-family:Arial">[Customer]</span></span></span></span><span style="font-size:13px"><span style="font-style:italic"><span style="font-weight:bold"><span style="font-family:Arial"> </span></span></span></span><span style="font-size:13px"><span style="font-style:italic"><span style="font-weight:bold"><span style="font-family:Arial">has selected the [Vendor's] virtual firewall to secure its virtual environment and mitigate an attack before it could hit their network. </span></span></span></span></font></span>
                                    </p>
                                </blockquote><span style="font-size:15px;line-height:normal"><span style="font-size:13px;line-height:15px"><span style="line-height:15px;font-size:13px;font-family:'Trebuchet MS'">Given the fact that to get to a VM you generally have to (1) utilize the physical network and (2) transit the vSwitch in the VMM, the reality is that an attack has already "hit their network" long before it gets to the VM or the virtual firewall, at least given today's available offerings.  There is no magic security fairy dust that will mitigate an attack presciently.</span></span></span>
                            </div>
                            <div>
                                <span style="font-family:'Trebuchet MS';font-size:13px;line-height:15px"><br></span>
                            </div>
                            <div>
                                <span style="font-size:15px;line-height:normal"><span style="font-size:13px;line-height:15px"><span style="line-height:15px;font-size:13px;font-family:'Trebuchet MS'">If you put VM's into production that are already infected, you have other problems to solve...</span></span></span>
                            </div>
                            <blockquote style="margin:0 0 0 40px;border:none;padding:0px">
                                <p>
                                    <span style="font-size:14px;line-height:normal"><span style="line-height:normal;font-size:13px"><span style="font-style:italic"><span style="font-weight:bold"><span style="font-family:Arial">“</span></span></span></span><font size="2" style="font-size:11pt"><span style="font-size:13px"><span style="font-style:italic"><span style="font-weight:bold"><span style="font-family:Arial">After moving our production applications to a virtualized environment we realized that we lacked security; I had no visibility into what was going on between VMs and a virtual attack could take down our network,” said [Customer.]  “We sought the same level of security for our virtual environment that we had with our physical network.”</span></span></span></span></font></span>
                                </p>
                            </blockquote><span style="font-size:15px;line-height:normal"><span style="line-height:15px;font-size:13px;font-family:'Trebuchet MS'">This indicates a lack of proper risk management and planning on the part of the [Customer.]  Further, it underscores an example I use in the Four Horsemen which concerns which tools in a multi-server physical deployment did the [Customer] use to monitor/protect in-line traffic between these physical machines? </span></span>
                            <p>
                                <span><span style="font-size:15px;line-height:normal"><span style="line-height:15px;font-size:13px;font-family:'Trebuchet MS'">The {Customer] must have done this since the press release suggests they demand the "...same level of security for [their] virtual environment that [they] had with [their] physical network."</span></span><span style="font-size:13px;font-family:'Trebuchet MS'"><br></span></span>
                            </p>
                            <div>
                                <span style="font-family:'Trebuchet MS';font-size:13px;line-height:15px"><br></span>
                            </div>
                            <div>
                                <span style="font-size:15px;line-height:normal"><span style="line-height:15px;font-size:13px;font-family:'Trebuchet MS'">Did the [Customer] have each physical server on it's own VLAN/subnet, isolated with firewalls?  Did he SPAN every single port to an IDS/IPS?  If not, what's the difference here?  The Hypervisor?  What protection mechanisms has the fancy virtual firewall put in place to protect it?  None.</span></span>
                                <div>
                                    <blockquote style="margin:0 0 0 40px;border:none;padding:0px">
                                        <p>
                                            <span style="line-height:normal;font-size:13px"><span style="font-style:italic;font-size:14px"><span style="font-weight:bold;font-size:13px;font-family:Arial">[Customer] was increasingly concerned about the risks of virtual networks, which range from security policy violations such as mixing trusted and un-trusted systems to malware exploits that can propagate undetected within a virtual network. </span></span></span>
                                        </p>
                                    </blockquote><span style="font-size:15px;line-height:normal"><span style="line-height:15px;font-size:13px;font-family:'Trebuchet MS'">Based upon the second paragraph above where the [Customer] admitted they put their virtualized environment into production without visibility or security, they clearly weren't that concerned with the risks.</span></span>
                                </div>
                                <div>
                                    <blockquote style="margin:0 0 0 40px;border:none;padding:0px">
                                        <p>
                                            <span style="line-height:normal;font-size:13px"><span style="font-style:italic"><span style="font-family:Arial"><span style="font-weight:bold">A large amount of data center network traffic was moving between VMs and [Customer] had no visibility or control over the communication on the virtual network.</span></span></span></span>
                                        </p>
                                    </blockquote><span style="font-size:13px;font-family:'Trebuchet MS'">So if there were no security or visibility tools in place, how was it determined that traffic was moving between VM's?</span>
                                </div>
                                <div>
                                    <span style="font-family:'Trebuchet MS';font-size:13px"><br></span>
                                </div>
                                <div>
                                    <span style="font-size:13px;font-family:'Trebuchet MS'">Does this mean that all the customer's VM's were in a single VLAN and not segmented? If not and vSwitch configurations via port groups and VLANs were configured around VM criticality, role or function, then they certainly had some insight into what was moving between VM's and the "data center," right?</span>
                                </div><span style="font-size:13px;font-family:'Trebuchet MS'"><br></span>
                                <div>
                                    <span style="font-size:13px;font-family:'Trebuchet MS'">I must be confused. </span>
                                </div>
                            </div>
                            <blockquote style="margin:0 0 0 40px;border:none;padding:0px">
                                <p>
                                    <span style="line-height:normal;font-size:13px;font-family:'Trebuchet MS'"><span style="font-style:italic"><span style="font-family:Arial"><span style="font-weight:bold">[Customer's] traditional network security tools could not monitor, analyze or troubleshoot inter-VM traffic because communications between VMs on the same physical host never touch the traditional network</span></span>. </span></span>
                                </p>
                            </blockquote>
                            <div>
                                <div>
                                    <span><span style="font-size:15px;line-height:normal"><span style="line-height:15px;font-size:13px;font-family:'Trebuchet MS'">Assuming that the VM's weren't in a single VLAN/portgroup on a single vSwitch and instead were segmented via VLANs/subnets, then the only way to get traffic from VLAN/IP Subnet A to VLAN/IP Subnet B (and thus VM A to VM B in these VLAN's) is though a layer 3 routing process which generally means traffic exits the virtual network and hits the physical network...where said "traditional security tools" could see it.</span></span></span>
                                </div><span style="font-size:13px;font-family:'Trebuchet MS'"><br></span>
                                <div>
                                    <span style="font-size:13px;font-family:'Trebuchet MS'">Of course, this doesn't help intra-VM traffic on the same portgroup/VLAN/vSwitch, but that's not what they pointed to above, but assuming they don't look at inter-machine traffic in their physical network on the same VLAN, again I ask what's the difference?</span>
                                </div>
                            </div>
                            <blockquote style="margin:0 0 0 40px;border:none;padding:0px">
                                <p>
                                    <span style="line-height:normal;font-size:13px"><span style="font-style:italic"><span style="font-family:Arial"><span style="font-weight:bold">VMs were able to communicate with each other without observation or policy-based inspection and filtering, which left them highly vulnerable to malicious exploits. Additionally, worms and viruses could further spread among physical hosts via unintentional VMotion of an infected VM.</span></span></span></span>
                                </p>
                            </blockquote>
                            <p>
                                <span style="font-size:15px;line-height:normal"><span style="line-height:15px;font-size:13px;font-family:'Trebuchet MS'">Back to my point above about how the [Customer] monitored traffic between physical hosts...if you don't do it in physical environments, why the fret in the virtual?</span></span>
                            </p>
                            <div>
                                <span style="font-size:15px;line-height:normal"><span style="line-height:15px;font-size:13px;font-family:'Trebuchet MS'">Oh and "unintentional VMotion!?" ZOMG!  For a VM to be "infected," excluding direct physical access, wouldn't the threat vector be the network in the first place?  </span></span>
                            </div>
                            <blockquote style="margin:0 0 0 40px;border:none;padding:0px">
                                <p>
                                    <span style="line-height:normal;font-size:13px"><span style="font-style:italic"><span style="font-family:Arial"><span style="font-weight:bold">The [Vendor] virtual firewall was specifically created to mitigate the risks of virtual networks, while maintaining the ROI of virtualization.</span></span></span></span>
                                </p>
                            </blockquote>
                            <div>
                                <div>
                                    <div>
                                        <div>
                                            <div>
                                                <span><span style="font-size:15px"><span style="line-height:15px;font-size:13px;font-family:'Trebuchet MS'">What "risks of virtual networks" does this product mitigate in the absence of vulnerability or clearly defined threats that aren't faced in the physical realm?  Let me tell you.  It goes back to the very valid claim that you get better visibility given the integration with the virtualization platform configuration managers to call attention to when CHANGE occurs.</span><span style="font-size:13px;font-family:'Trebuchet MS'"><br></span></span></span>
                                            </div>
                                            <div>
                                                <span style="line-height:15px;font-size:13px;font-family:'Trebuchet MS'"><br></span>
                                            </div>
                                            <div>
                                                <span style="line-height:15px;font-size:13px;font-family:'Trebuchet MS'">This is the real value of products like this from [Vendor.]  In the long run, the big boys who make mature firewalls and IPS products will get to harness API's like VMsafe and combined with the compartmentalization and segmentation capabilities of vShield Zones leaves a very short runway for products like this.</span>
                                            </div>
                                            <div>
                                                <span style="line-height:15px;font-size:13px;font-family:'Trebuchet MS'"><br></span>
                                            </div>
                                            <div>
                                                <span style="line-height:15px;font-size:13px;font-family:'Trebuchet MS'">I'm not suggesting that products like this from [Vendor] don't offer value and solve an immediate pain point. I'd even consider deploying them to solve very specific problems I might have, but then again, I know what problem I'd be trying to solve. ROI?  Oy.</span>
                                            </div>
                                            <div>
                                                <span style="line-height:15px;font-size:13px;font-family:'Trebuchet MS'"><br></span>
                                            </div>
                                            <div>
                                                <span style="line-height:15px;font-size:13px;font-family:'Trebuchet MS'">However, unlike the picture painted of the [Customer] above, I plan a little better and understand the impact virtualization has on my security posture and how that factors into my assessment and management of risk BEFORE I put it into production.  You should too.</span>
                                            </div><span style="line-height:normal;font-size:13px;font-family:'Trebuchet MS'"><br></span>
                                            <div>
                                                <span style="font-size:13px;font-family:'Trebuchet MS'">&lt;/rant&gt;</span>
                                            </div><span style="line-height:normal;font-size:13px;font-family:'Trebuchet MS'"><br></span>
                                            <div>
                                                <span style="font-size:13px;font-family:Arial"><span style="font-style:italic">{Ed: I use 'intra-' instead of 'inter-' to reflect the "internal" passing of traffic between VM's using the vSwitch. Should traffic exit the vSwitch/host and hit the network as part of interchange between two VM's, I'd count this as 'inter-" VM traffic.}</span></span>
                                            </div>
                                            <div>
                                                <span style="font-size:15px"><br></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <a href="http://feeds2.feedburner.com/~ff/typepad/beaker/blog?a=c24MCQcKp9E:hwZ_03KMSVw:yIl2AUoC8zA"><img src="http://feeds2.feedburner.com/~ff/typepad/beaker/blog?d=yIl2AUoC8zA" border="0"></a> <a href="http://feeds2.feedburner.com/~ff/typepad/beaker/blog?a=c24MCQcKp9E:hwZ_03KMSVw:F7zBnMyn0Lo"><img src="http://feeds2.feedburner.com/~ff/typepad/beaker/blog?i=c24MCQcKp9E:hwZ_03KMSVw:F7zBnMyn0Lo" border="0"></a> <a href="http://feeds2.feedburner.com/~ff/typepad/beaker/blog?a=c24MCQcKp9E:hwZ_03KMSVw:V_sGLiPBpWU"><img src="http://feeds2.feedburner.com/~ff/typepad/beaker/blog?i=c24MCQcKp9E:hwZ_03KMSVw:V_sGLiPBpWU" border="0"></a> <a href="http://feeds2.feedburner.com/~ff/typepad/beaker/blog?a=c24MCQcKp9E:hwZ_03KMSVw:qj6IDK7rITs"><img src="http://feeds2.feedburner.com/~ff/typepad/beaker/blog?d=qj6IDK7rITs" border="0"></a> <a href="http://feeds2.feedburner.com/~ff/typepad/beaker/blog?a=c24MCQcKp9E:hwZ_03KMSVw:gIN9vFwOqvQ"><img src="http://feeds2.feedburner.com/~ff/typepad/beaker/blog?i=c24MCQcKp9E:hwZ_03KMSVw:gIN9vFwOqvQ" border="0"></a>
                            </div><img src="http://feeds2.feedburner.com/~r/typepad/beaker/blog/~4/c24MCQcKp9E" height="1" width="1">
                        </blockquote>
                    </div>
                    <p class="bookmark-source">
                        Source: <a href="http://feedproxy.google.com/%7Er/typepad/beaker/blog/%7E3/c24MCQcKp9E/oh-noes-we-cant-monitorprotect-against-intra-vm-traffic.html">http://feedproxy.google.com/%7Er/typepad/beaker/blog/%7E3/c24MCQcKp9E/oh-noes-we-cant-monitorprotect-against-intra-vm-traffic.html</a>
                    </p>
                </div>
            </article>

            <nav id="post-nav">


            </nav>

            <script id="discus-javascript">
                var disqus_shortname = 'improbable';

                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
                    document.getElementsByTagName('body')[0].appendChild(dsq);
                })();
            </script>

            <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            <div id="disqus_thread"></div>
        </section>

        <footer id="site-footer" class="nocontent">
            <p>
                This site is purely my personal work and does not reflect the views of my employer.
            </p>
            <p class="license">
                <a class="icon" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a>
                This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
            </p>
        </footer>

        <script async src="/static/js/common.js"></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js" integrity="sha256-hj+5FRlAuvAFANiefn0PpJYCkV1X4QT9EgiPd+6QnCw=" crossorigin="anonymous"></script>
    </body>
</html>
