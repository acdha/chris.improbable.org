<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Rogue Wireless Gets Sneakier</title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="stylesheet" href="/static/css/main.min.css" type="text/css" media="all">
        <!--[if lte IE 8]>
            <link
                rel="stylesheet"
                href="/static/css/ie-fixes.css"
                type="text/css"
                media="all"
            />
            <script src="/static/js/html5shiv.js"></script>
        <![endif]-->

        <meta http-equiv="last-modified" content="Mon, 09 Mar 2009 07:41:26 GMT">
        <link rel="alternate" type="application/atom+xml" title="All Posts (Atom)" href="/feeds/all.atom">
        <link rel="alternate" type="application/rss+xml" title="All Posts (RSS)" href="/feeds/all.rss">
        <link rel="icon" type="image/jpeg" sizes="287x287" href="/static/img/favicon-287x287.jpg">
        <link rel="icon" type="image/jpeg" sizes="128x128" href="/static/img/favicon-128x128.jpg">
    </head>
    <body class="blog post_detail" itemscope itemtype="http://schema.org/BlogPosting">
        <nav id="site-nav">
            <header id="about">
                <h1><a href="/about/">Chris Adams</a></h1>
                <h2>Programmer, cyclist, photographer</h2>
            </header>
            <ul class="links">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/about/">About</a>
                </li>
                <li>
                    <a href="/feeds/all.atom" title="Site Feed">Site Feed</a>
                </li>
            </ul>
            <ul class="social-networks">
                <li>
                    <a rel="me" href="https://code4lib.social/@acdha">Mastodon</a>
                </li>
                <li>
                    <a href="https://github.com/acdha" rel="me">Github</a>
                </li>
                <li>
                    <a href="https://bitbucket.org/acdha" rel="me">Bitbucket</a>
                </li>
                <li>
                    <a href="https://pinboard.in/u:acdha/" rel="me">Pinboard</a>
                </li>
                <li>
                    <a href="https://www.flickr.com/photos/acdha" rel="me">Flickr</a>
                </li>
                <li>
                    <a href="https://www.linkedin.com/in/acdha" rel="me">LinkedIn</a>
                </li>
            </ul>
            <div id="site-search"></div>
        </nav>
        <section id="main">
            <article class="post">
                <header>
                    <meta itemprop="dateCreated" content="2009-03-09T03:41:26-04:00">
                    <meta itemprop="dateModified" content="2009-03-09T03:41:26-04:00">
                    <time class="date" itemprop="datePublished" datetime="2009-03-09T07:41:26+00:00">Mar 09</time>
                    <h2 class="" itemprop="title">Rogue Wireless Gets Sneakier</h2>
                </header>

                <div class="body" itemprop="articleBody"><div class="googlereader description" data-google-id="tag:google.com,2005:reader/item/cf133389cfd1f318">
                        <blockquote>
                            <p>
                                <a href="http://philosecurity.org/wp-content/uploads/2009/03/rogue_vol_3.jpg"><img src="http://philosecurity.org/wp-content/uploads/2009/03/rogue_vol_3-213x300.jpg" alt="Rogue: X-Men" title="Rogue: X-Men" width="213" height="300"></a>For $40, anyone can purchase a cheap wireless AP and plug it into the company network. Often, employees do this simply for the sake of convenience, not realizing that it opens the company to attack. Criminals also deliberately plant wireless access points, which allow them to bypass the pesky firewall and remotely access the network later on. These days, disgruntled employees can easily hide an AP behind the file cabinet before cleaning out their desks, and then access the company network months later from the parking lot.
                            </p>
                            <p>
                                Many companies conduct regular “war-walking” scans to detect rogue access points (ie. using Kismet or Netstumbler), or invest in commercial Wireless Intrusion Detection Systems (WIDS). However, there are sneaky ways to bypass traditional war-walking and WIDS systems. Recently, I took <a href="http://www.sans.org/training/description.php?tid=2397">Josh Wright’s excellent “Wireless Ethical Hacking” SANS class</a>, and he touched on a number of tricks that attackers can use to foil your company’s rogue WAP detection efforts. Here are a few:
                            </p>
                            <h2>
                                1) Channel 14
                            </h2>
                            <p>
                                In the United States, the FCC has licensed 11 channels for 802.11b/g, which have center frequencies between 2.412 GHz to 2.462 GHz. However, most of Europe allows 13 channels (up to 2.472 GHz), and Japan allows 802.11b <a href="http://en.wikipedia.org/wiki/List_of_WLAN_channels">all the way up to channel 14, or 2.484 GHz.</a>
                            </p>
                            <p>
                                Cards manufactured for the United States often don’t support channel 14, since it’s illegal to transmit on that frequency. There’s overlap between the channels, but at 2.484 GHz, channel 14 is far enough away from channel 11 that network cards are unlikely to pick up much signal on channel 11. If an attacker were to configure an AP to illegally transmit on Channel 14 and export data at 2.484 GHz, security teams monitoring US channels would probably never detect it.
                            </p>
                            <h2>
                                2) 802.11n Green Field mode
                            </h2>
                            <p>
                                The IEEE has been hard at work on the 802.11n (<a href="http://en.wikipedia.org/wiki/Multiple-input_multiple-output">“MIMO”</a>-based) specification, which allows much greater throughput than 802.11a/b/g (100Mbps or more). The draft 802.11n standard specifies two modes:
                            </p>
                            <ul>
                                <li>“Mixed-mode,” which allows it to work with legacy 802.11a/b/g networks;
                                </li>
                                <li>“Green Field” or “high-throughput only” mode, which takes full advantage of the enhanced throughput but is not visible to 802.11a/b/g devices. Older devices will see GF-mode traffic only as noise.
                                </li>
                            </ul>
                            <p>
                                Not visible to 802.11a/b/g devices? That means if you’re war-walking with an 802.11a/b/g card, you can’t see 802.11n devices operating in Green Field (GF) mode. The specification hasn’t even been finalized, but 802.11n devices are already available for as little as $50– easy to buy, easy to plug into your company’s network. However, most companies have not yet purchased 802.11n-compatible equipment and hence can’t detect GF-mode 802.11n rogue APs.
                            </p>
                            <p>
                                Josh published a <a href="http://www.wirelessve.org/entries/show/WVE-2008-0005">vulnerability report explaining this</a>, in which he wrote: “With the inability to decode GF mode traffic, an attacker can position a malicious rogue AP on a victim network using the GF mode preamble. This would allow an attacker to evade wireless intrusion detection systems (WIDS) based on non-HT devices. This includes all WIDS devices based on 802.11a/b/g wireless cards.”
                            </p>
                            <h2>
                                3) Bluetooth Access Point
                            </h2>
                            <p>
                                If you’re like me, when you think about Bluetooth you envision your tiny little headset which crackles and hisses every time you walk too far away from your phone. That’s because your Bluetooth headset is designed for a Class 2 Bluetooth network, which is fairly low-power and has a maximum range of ~10M.
                            </p>
                            <p>
                                However, there’s more to Bluetooth than your rinky-dink headset. Bluetooth Class 1 devices are much more powerful, with ranges similar to 802.11b wireless APs. A Bluetooth Class 1 device can transmit up to 100mW, with a typical range of ~100M (or miles, if the receiver has a directional antenna).You can buy a Class 1 Bluetooth AP for $100-200.
                            </p>
                            <p>
                                Can you discover Bluetooth APs while war-walking? Not if you’re just using an 802.11 card. Even if you’re using a spectrum analyzer like <a href="http://www.metageek.net/">WiSpy</a>, you may not notice it. Bluetooth uses <a href="http://philosecurity.org/2008/07/28/off-the-grid">Frequency Hopping Spread Spectrum</a>, and hops 1600 times a second throughout the 2.402-2.480GHz band. Because it’s spread out across the spectrum, it can be hard to notice and easily mistaken for noise by the untrained eye. Most Wireless IDS systems and security teams simply don’t look for it (yet).
                            </p>
                            <h2>
                                4) Wireless Knocking
                            </h2>
                            <p>
                                This is my favorite. Remember port knocking? Instead of installing a backdoor to listen on a particular port (where it might be noticed), l33t h4×0rs installed rootkits that would wait for a particular sequence of ports to be scanned, at which point the knocker’s IP address would be granted access. “A three-knock simple TCP sequence (e.g. port 1000, 2000, 3000) would require an attacker without prior knowledge of the sequence to test every combination of three ports in the range 1-65535, and then to scan each port in between to see if anything had opened… That equates to approximately 65535<sup>4</sup> packets in order to obtain and detect a single successful opening. That’s approximately 18,445,618,199,572,250,625 or <a href="http://en.wikipedia.org/wiki/Port_knocking">18 quintillion packets</a>.” <em>(Wikipedia)</em>
                            </p>
                            <p>
                                With wireless knocking, a rogue AP sits on the network in monitor mode, listening for probe requests. When the rogue AP receives a packet (or sequence of packets) with the preconfigured SSID, it awakens and switches to master mode. The program “WKnock” is designed for this purpose, and it can be installed on any AP supported by the OpenWRT framework. During times when the rogue AP isn’t active, it is silent and can’t be detected using common wireless scanning tools.
                            </p>
                            <p>
                                Sneaky!
                            </p>
                            <p>
                                <em>If you want to learn more about wireless attacks and defense, I definitely recommend Josh Wright’s class – <a href="http://www.sans.org/training/description.php?tid=2397">SANS 617</a>.</em>
                            </p>
                            <table style="float:right">
                                <tr>
                                    <td align="right">
                                        <em>Sherri Davidoff</em>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <a href="http://philosecurity.org/wp-content/uploads/pgp-archives/rogue-wireless-gets-sneakier-2009-03-09.asc">PGP-signed text: 2009-03-09 (current)</a>
                                    </td>
                                </tr>
                            </table>Did you like this article? Share it! <a rel="nofollow" href="http://digg.com/submit?phase=2&amp;url=http%3A%2F%2Fphilosecurity.org%2F2009%2F03%2F09%2Frogue-wireless-gets-sneakier&amp;title=Rogue%20Wireless%20Gets%20Sneakier" title="Digg"><img src="http://philosecurity.org/wp-content/plugins/sociable/images/digg.png" title="Digg" alt="Digg"></a> <a rel="nofollow" href="http://del.icio.us/post?url=http%3A%2F%2Fphilosecurity.org%2F2009%2F03%2F09%2Frogue-wireless-gets-sneakier&amp;title=Rogue%20Wireless%20Gets%20Sneakier" title="del.icio.us"><img src="http://philosecurity.org/wp-content/plugins/sociable/images/delicious.png" title="del.icio.us" alt="del.icio.us"></a> <a rel="nofollow" href="http://www.stumbleupon.com/submit?url=http%3A%2F%2Fphilosecurity.org%2F2009%2F03%2F09%2Frogue-wireless-gets-sneakier&amp;title=Rogue%20Wireless%20Gets%20Sneakier" title="StumbleUpon"><img src="http://philosecurity.org/wp-content/plugins/sociable/images/stumbleupon.png" title="StumbleUpon" alt="StumbleUpon"></a> <a rel="nofollow" href="http://reddit.com/submit?url=http%3A%2F%2Fphilosecurity.org%2F2009%2F03%2F09%2Frogue-wireless-gets-sneakier&amp;title=Rogue%20Wireless%20Gets%20Sneakier" title="Reddit"><img src="http://philosecurity.org/wp-content/plugins/sociable/images/reddit.png" title="Reddit" alt="Reddit"></a> <a rel="nofollow" href="http://slashdot.org/bookmark.pl?title=Rogue%20Wireless%20Gets%20Sneakier&amp;url=http%3A%2F%2Fphilosecurity.org%2F2009%2F03%2F09%2Frogue-wireless-gets-sneakier" title="Slashdot"><img src="http://philosecurity.org/wp-content/plugins/sociable/images/slashdot.png" title="Slashdot" alt="Slashdot"></a><br>
                            <br>
                        </blockquote>
                    </div>
                    <p class="bookmark-source">
                        Source: <a href="http://philosecurity.org/2009/03/09/rogue-wireless-gets-sneakier">http://philosecurity.org/2009/03/09/rogue-wireless-gets-sneakier</a>
                    </p>
                </div>
            </article>

            <nav id="post-nav">


            </nav>
        </section>

        <footer id="site-footer" class="nocontent">
            <p>
                This site is purely my personal work and does not reflect the
                views of my employer.
            </p>
            <p class="license">
                <a class="icon" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width: 0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a>
                This work is licensed under a
                <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported
                    License</a>.
            </p>
        </footer>

        <script async src="/static/js/common.js"></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js" integrity="sha256-hj+5FRlAuvAFANiefn0PpJYCkV1X4QT9EgiPd+6QnCw=" crossorigin="anonymous"></script>
    </body>
</html>
